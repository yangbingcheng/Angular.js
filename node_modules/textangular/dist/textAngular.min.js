!function(z,G){"function"==typeof define&&define.amd?define("textAngular",["rangy","rangy/lib/rangy-selectionsaverestore"],function(A,T){return z["textAngular.name"]=G(A,T)}):"object"==typeof exports?module.exports=G(require("rangy"),require("rangy/lib/rangy-selectionsaverestore")):z.textAngular=G(rangy)}(this,function(z){var G={};angular.module("textAngularSetup",[]).constant("taRegisterTool",function(f,d){if(!f||""===f||G.hasOwnProperty(f))throw"textAngular Error: A unique name is required for a Tool Definition";
var k;if((k=d.display)&&!(k=""===d.display)){var m;try{m=0!==angular.element(d.display).length}catch(n){m=!1}k=!m}if(k||!d.display&&!d.buttontext&&!d.iconclass)throw'textAngular Error: Tool Definition for "'+f+'" does not have a valid display/iconclass/buttontext value';G[f]=d}).value("taTools",G).value("taOptions",{forceTextAngularSanitize:!0,keyMappings:[],toolbar:["h1 h2 h3 h4 h5 h6 p pre quote".split(" "),"bold italics underline strikeThrough ul ol redo undo clear".split(" "),"justifyLeft justifyCenter justifyRight justifyFull indent outdent".split(" "),
"html insertImage insertLink insertVideo wordcount charcount".split(" ")],classes:{focussed:"focussed",toolbar:"btn-toolbar",toolbarGroup:"btn-group",toolbarButton:"btn btn-default",toolbarButtonActive:"active",disabled:"disabled",textEditor:"form-control",htmlEditor:"form-control"},defaultTagAttributes:{a:{target:""}},setup:{textEditorSetup:function(f){},htmlEditorSetup:function(f){}},defaultFileDropHandler:function(f,d){var k=new FileReader;return"image"===f.type.substring(0,5)&&(k.onload=function(){""!==
k.result&&d("insertImage",k.result,!0)},k.readAsDataURL(f),!0)}}).value("taSelectableElements",["a","img"]).value("taCustomRenderers",[{selector:"img",customAttribute:"ta-insert-video",renderLogic:function(f){var d=angular.element("<iframe></iframe>"),k=f.prop("attributes");angular.forEach(k,function(f){d.attr(f.name,f.value)});d.attr("src",d.attr("ta-insert-video"));f.replaceWith(d)}}]).value("taTranslations",{html:{tooltip:"Toggle html / Rich Text"},heading:{tooltip:"Heading "},p:{tooltip:"Paragraph"},
pre:{tooltip:"Preformatted text"},ul:{tooltip:"Unordered List"},ol:{tooltip:"Ordered List"},quote:{tooltip:"Quote/unquote selection or paragraph"},undo:{tooltip:"Undo"},redo:{tooltip:"Redo"},bold:{tooltip:"Bold"},italic:{tooltip:"Italic"},underline:{tooltip:"Underline"},strikeThrough:{tooltip:"Strikethrough"},justifyLeft:{tooltip:"Align text left"},justifyRight:{tooltip:"Align text right"},justifyFull:{tooltip:"Justify text"},justifyCenter:{tooltip:"Center"},indent:{tooltip:"Increase indent"},outdent:{tooltip:"Decrease indent"},
clear:{tooltip:"Clear formatting"},insertImage:{dialogPrompt:"Please enter an image URL to insert",tooltip:"Insert image",hotkey:"the - possibly language dependent hotkey ... for some future implementation"},insertVideo:{tooltip:"Insert video",dialogPrompt:"Please enter a youtube URL to embed"},insertLink:{tooltip:"Insert / edit link",dialogPrompt:"Please enter a URL to insert"},editLink:{reLinkButton:{tooltip:"Relink"},unLinkButton:{tooltip:"Unlink"},targetToggle:{buttontext:"Open in New Window"}},
wordcount:{tooltip:"Display words Count"},charcount:{tooltip:"Display characters Count"}}).factory("taToolFunctions",["$window","taTranslations",function(f,d){return{imgOnSelectAction:function(f,d,n){var k=function(){n.updateTaBindtaTextElement();n.hidePopover()};f.preventDefault();n.displayElements.popover.css("width","375px");f=n.displayElements.popoverContainer;f.empty();var g=angular.element('<div class="btn-group" style="padding-right: 6px;">'),l=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">100% </button>');
l.on("click",function(a){a.preventDefault();d.css({width:"100%",height:""});k()});var e=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">50% </button>');e.on("click",function(a){a.preventDefault();d.css({width:"50%",height:""});k()});var m=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">25% </button>');m.on("click",function(a){a.preventDefault();d.css({width:"25%",height:""});
k()});var r=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">Reset</button>');r.on("click",function(a){a.preventDefault();d.css({width:"",height:""});k()});g.append(l);g.append(e);g.append(m);g.append(r);f.append(g);g=angular.element('<div class="btn-group" style="padding-right: 6px;">');l=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-left"></i></button>');
l.on("click",function(a){a.preventDefault();d.css("float","left");d.css("cssFloat","left");d.css("styleFloat","left");k()});e=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-right"></i></button>');e.on("click",function(a){a.preventDefault();d.css("float","right");d.css("cssFloat","right");d.css("styleFloat","right");k()});m=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-justify"></i></button>');
m.on("click",function(a){a.preventDefault();d.css("float","");d.css("cssFloat","");d.css("styleFloat","");k()});g.append(l);g.append(m);g.append(e);f.append(g);g=angular.element('<div class="btn-group">');l=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-trash-o"></i></button>');l.on("click",function(a){a.preventDefault();d.remove();k()});g.append(l);f.append(g);n.showPopover(d);n.showResizeOverlay(d)},aOnSelectAction:function(k,
m,n){k.preventDefault();n.displayElements.popover.css("width","436px");k=n.displayElements.popoverContainer;k.empty();k.css("line-height","28px");var u=angular.element('<a href="'+m.attr("href")+'" target="_blank">'+m.attr("href")+"</a>");u.css({display:"inline-block","max-width":"200px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","vertical-align":"middle"});k.append(u);var u=angular.element('<div class="btn-group pull-right">'),g=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on" title="'+
d.editLink.reLinkButton.tooltip+'"><i class="fa fa-edit icon-edit"></i></button>');g.on("click",function(e){e.preventDefault();(e=f.prompt(d.insertLink.dialogPrompt,m.attr("href")))&&""!==e&&"http://"!==e&&(m.attr("href",e),n.updateTaBindtaTextElement());n.hidePopover()});u.append(g);g=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on" title="'+d.editLink.unLinkButton.tooltip+'"><i class="fa fa-unlink icon-unlink"></i></button>');g.on("click",
function(d){d.preventDefault();m.replaceWith(m.contents());n.updateTaBindtaTextElement();n.hidePopover()});u.append(g);var l=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on">'+d.editLink.targetToggle.buttontext+"</button>");"_blank"===m.attr("target")&&l.addClass("active");l.on("click",function(d){d.preventDefault();m.attr("target","_blank"===m.attr("target")?"":"_blank");l.toggleClass("active");n.updateTaBindtaTextElement()});u.append(l);
k.append(u);n.showPopover(m)},extractYoutubeVideoId:function(d){return(d=d.match(/(?:youtube(?:-nocookie)?\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/i))&&d[1]||null}}}]).run(["taRegisterTool","$window","taTranslations","taSelection","taToolFunctions","$sanitize","taOptions","$log",function(f,d,k,m,n,u,g,l){l={};if(u("",l),!0===g.forceTextAngularSanitize&&"taSanitize"!==l.version)throw angular.$$minErr("textAngular")("textAngularSetup","The textAngular-sanitize provider has been replaced by another -- have you included angular-sanitize by mistake?");
f("html",{iconclass:"fa fa-code",tooltiptext:k.html.tooltip,action:function(){this.$editor().switchView()},activeState:function(){return this.$editor().showHtml}});var e=function(a){return function(){return this.$editor().queryFormatBlockState(a)}},y=function(){return this.$editor().wrapSelection("formatBlock","<"+this.name.toUpperCase()+">")};angular.forEach("h1 h2 h3 h4 h5 h6".split(" "),function(a){f(a.toLowerCase(),{buttontext:a.toUpperCase(),tooltiptext:k.heading.tooltip+a.charAt(1),action:y,
activeState:e(a.toLowerCase())})});f("p",{buttontext:"P",tooltiptext:k.p.tooltip,action:function(){return this.$editor().wrapSelection("formatBlock","<P>")},activeState:function(){return this.$editor().queryFormatBlockState("p")}});f("pre",{buttontext:"pre",tooltiptext:k.pre.tooltip,action:function(){return this.$editor().wrapSelection("formatBlock","<PRE>")},activeState:function(){return this.$editor().queryFormatBlockState("pre")}});f("ul",{iconclass:"fa fa-list-ul",tooltiptext:k.ul.tooltip,action:function(){return this.$editor().wrapSelection("insertUnorderedList",
null)},activeState:function(){return this.$editor().queryCommandState("insertUnorderedList")}});f("ol",{iconclass:"fa fa-list-ol",tooltiptext:k.ol.tooltip,action:function(){return this.$editor().wrapSelection("insertOrderedList",null)},activeState:function(){return this.$editor().queryCommandState("insertOrderedList")}});f("quote",{iconclass:"fa fa-quote-right",tooltiptext:k.quote.tooltip,action:function(){return this.$editor().wrapSelection("formatBlock","<BLOCKQUOTE>")},activeState:function(){return this.$editor().queryFormatBlockState("blockquote")}});
f("undo",{iconclass:"fa fa-undo",tooltiptext:k.undo.tooltip,action:function(){return this.$editor().wrapSelection("undo",null)}});f("redo",{iconclass:"fa fa-repeat",tooltiptext:k.redo.tooltip,action:function(){return this.$editor().wrapSelection("redo",null)}});f("bold",{iconclass:"fa fa-bold",tooltiptext:k.bold.tooltip,action:function(){return this.$editor().wrapSelection("bold",null)},activeState:function(){return this.$editor().queryCommandState("bold")},commandKeyCode:98});f("justifyLeft",{iconclass:"fa fa-align-left",
tooltiptext:k.justifyLeft.tooltip,action:function(){return this.$editor().wrapSelection("justifyLeft",null)},activeState:function(a){if(a&&"#document"===a.nodeName)return!1;var b=!1;return a&&(b="left"===a.css("text-align")||"left"===a.attr("align")||"right"!==a.css("text-align")&&"center"!==a.css("text-align")&&"justify"!==a.css("text-align")&&!this.$editor().queryCommandState("justifyRight")&&!this.$editor().queryCommandState("justifyCenter")&&!this.$editor().queryCommandState("justifyFull")),b||
this.$editor().queryCommandState("justifyLeft")}});f("justifyRight",{iconclass:"fa fa-align-right",tooltiptext:k.justifyRight.tooltip,action:function(){return this.$editor().wrapSelection("justifyRight",null)},activeState:function(a){if(a&&"#document"===a.nodeName)return!1;var b=!1;return a&&(b="right"===a.css("text-align")),b||this.$editor().queryCommandState("justifyRight")}});f("justifyFull",{iconclass:"fa fa-align-justify",tooltiptext:k.justifyFull.tooltip,action:function(){return this.$editor().wrapSelection("justifyFull",
null)},activeState:function(a){var b=!1;return a&&(b="justify"===a.css("text-align")),b||this.$editor().queryCommandState("justifyFull")}});f("justifyCenter",{iconclass:"fa fa-align-center",tooltiptext:k.justifyCenter.tooltip,action:function(){return this.$editor().wrapSelection("justifyCenter",null)},activeState:function(a){if(a&&"#document"===a.nodeName)return!1;var b=!1;return a&&(b="center"===a.css("text-align")),b||this.$editor().queryCommandState("justifyCenter")}});f("indent",{iconclass:"fa fa-indent",
tooltiptext:k.indent.tooltip,action:function(){return this.$editor().wrapSelection("indent",null)},activeState:function(){return this.$editor().queryFormatBlockState("blockquote")},commandKeyCode:"TabKey"});f("outdent",{iconclass:"fa fa-outdent",tooltiptext:k.outdent.tooltip,action:function(){return this.$editor().wrapSelection("outdent",null)},activeState:function(){return!1},commandKeyCode:"ShiftTabKey"});f("italics",{iconclass:"fa fa-italic",tooltiptext:k.italic.tooltip,action:function(){return this.$editor().wrapSelection("italic",
null)},activeState:function(){return this.$editor().queryCommandState("italic")},commandKeyCode:105});f("underline",{iconclass:"fa fa-underline",tooltiptext:k.underline.tooltip,action:function(){return this.$editor().wrapSelection("underline",null)},activeState:function(){return this.$editor().queryCommandState("underline")},commandKeyCode:117});f("strikeThrough",{iconclass:"fa fa-strikethrough",tooltiptext:k.strikeThrough.tooltip,action:function(){return this.$editor().wrapSelection("strikeThrough",
null)},activeState:function(){return document.queryCommandState("strikeThrough")}});f("clear",{iconclass:"fa fa-ban",tooltiptext:k.clear.tooltip,action:function(a,b){this.$editor().wrapSelection("removeFormat",null);var c=angular.element(m.getSelectionElement());a=m.getAllSelectedElements();var h=function(a,c){a=angular.element(a);var b=c;return c||(b=a),angular.forEach(a.children(),function(a){if("ul"===a.tagName.toLowerCase()||"ol"===a.tagName.toLowerCase())b=h(a,b);else{var c=angular.element("<p></p>");
c.html(angular.element(a).html());b.after(c);b=c}}),a.remove(),b};angular.forEach(a,function(a){"ul"!==a.nodeName.toLowerCase()&&"ol"!==a.nodeName.toLowerCase()||h(a)});angular.forEach(c.find("ul"),h);angular.forEach(c.find("ol"),h);var d=this.$editor(),e=function(a){a=angular.element(a);a[0]!==d.displayElements.text[0]&&a.removeAttr("class");angular.forEach(a.children(),e)};angular.forEach(c,e);c[0]&&"li"!==c[0].tagName.toLowerCase()&&"ol"!==c[0].tagName.toLowerCase()&&"ul"!==c[0].tagName.toLowerCase()&&
this.$editor().wrapSelection("formatBlock","default");b()}});var r=function(a){return a?-1!==a.toLowerCase().indexOf("javascript"):!1};f("insertImage",{iconclass:"fa fa-picture-o",tooltiptext:k.insertImage.tooltip,action:function(){var a;if(a=d.prompt(k.insertImage.dialogPrompt,"http://"),a&&""!==a&&"http://"!==a&&!r(a))return m.getSelectionElement().tagName&&"a"===m.getSelectionElement().tagName.toLowerCase()&&m.setSelectionAfterElement(m.getSelectionElement()),a='<img src="'+a+'">',this.$editor().wrapSelection("insertHTML",
a,!0)},onElementSelect:{element:"img",action:n.imgOnSelectAction}});f("insertVideo",{iconclass:"fa fa-youtube-play",tooltiptext:k.insertVideo.tooltip,action:function(){var a;if(a=d.prompt(k.insertVideo.dialogPrompt,"https://"),!r(a)&&a&&""!==a&&"https://"!==a&&(videoId=n.extractYoutubeVideoId(a),videoId))return a='<img class="ta-insert-video" src="https://img.youtube.com/vi/'+videoId+'/hqdefault.jpg" ta-insert-video="'+("https://www.youtube.com/embed/"+videoId)+'" contenteditable="false" allowfullscreen="true" frameborder="0" />',
m.getSelectionElement().tagName&&"a"===m.getSelectionElement().tagName.toLowerCase()&&m.setSelectionAfterElement(m.getSelectionElement()),this.$editor().wrapSelection("insertHTML",a,!0)},onElementSelect:{element:"img",onlyWithAttrs:["ta-insert-video"],action:n.imgOnSelectAction}});f("insertLink",{tooltiptext:k.insertLink.tooltip,iconclass:"fa fa-link",action:function(){var a;if(a=m.getSelectionElement().tagName&&"a"===m.getSelectionElement().tagName.toLowerCase()?d.prompt(k.insertLink.dialogPrompt,
m.getSelectionElement().href):d.prompt(k.insertLink.dialogPrompt,"http://"),a&&""!==a&&"http://"!==a&&!r(a))return this.$editor().wrapSelection("createLink",a,!0)},activeState:function(a){return!!a&&"A"===a[0].tagName},onElementSelect:{element:"a",action:n.aOnSelectAction}});f("wordcount",{display:'<div id="toolbarWC" style="display:block; min-width:100px;">Words: <span ng-bind="wordcount"></span></div>',disabled:!0,wordcount:0,activeState:function(){var a=this.$editor().displayElements.text[0].innerHTML||
"",b=0;return""!==a.replace(/\s*<[^>]*?>\s*/g,"")&&""!==a.trim()&&(b=a.replace(/<\/?(b|i|em|strong|span|u|strikethrough|a|img|small|sub|sup|label)( [^>*?])?>/gi,"").replace(/(<[^>]*?>\s*<[^>]*?>)/gi," ").replace(/(<[^>]*?>)/gi,"").replace(/\s+/gi," ").match(/\S+/g).length),this.wordcount=b,this.$editor().wordcount=b,!1}});f("charcount",{display:'<div id="toolbarCC" style="display:block; min-width:120px;">Characters: <span ng-bind="charcount"></span></div>',disabled:!0,charcount:0,activeState:function(){var a=
this.$editor().displayElements.text,a=(a[0].innerText||a[0].textContent).replace(/(\r\n|\n|\r)/gm,"").replace(/^\s+/g," ").replace(/\s+$/g," ").length;return this.charcount=a,this.$editor().charcount=a,!1}})}]);var A=function(){for(var f=3,d=document.createElement("div"),k=d.getElementsByTagName("i");d.innerHTML="\x3c!--[if gt IE "+ ++f+"]><i></i><![endif]--\x3e",k[0];);return 4<f?f:void 0}(),T=/AppleWebKit\/([\d.]+)/i.test(navigator.userAgent);navigator.userAgent.toLowerCase().indexOf("firefox");
var K=K||{};K.now=function(){return K.now||K.mozNow||K.msNow||K.oNow||K.webkitNow||function(){return(new Date).getTime()}}();var H=/^(address|article|aside|audio|blockquote|canvas|center|dd|div|dl|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|noscript|ol|output|p|pre|section|table|tfoot|ul|video)$/i,qa=/^(ul|li|ol)$/i,ga=/^(#text|span|address|article|aside|audio|blockquote|canvas|center|dd|div|dl|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|noscript|ol|output|p|pre|section|table|tfoot|ul|video|li)$/i;
String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var B,na,oa,W,X,Y;if(8<A||void 0===A){for(var C=document.styleSheets,L=0;L<C.length;L++)if((0===C[L].media.length||C[L].media.mediaText.match(/(all|screen)/gi))&&C[L].href&&C[L].href.match(/textangular\.(min\.|)css/gi)){B=C[L];break}B||(B=function(){var f=document.createElement("style");return T&&f.appendChild(document.createTextNode("")),document.getElementsByTagName("head")[0].appendChild(f),f.sheet}());
na=function(f,d){return W(B,f,d)};W=function(f,d,k){var m,n;return f.cssRules?m=Math.max(f.cssRules.length-1,0):f.rules&&(m=Math.max(f.rules.length-1,0)),f.insertRule?f.insertRule(d+"{"+k+"}",m):f.addRule(d,k,m),B.rules?n=B.rules[m]:B.cssRules&&(n=B.cssRules[m]),n};Y=function(f,d){var k,m;for(k=0;k<d.length;k++)if(d[k].cssText===f.cssText){m=k;break}return m};oa=function(f){X(B,f)};X=function(f,d){var k=f.cssRules||f.rules;k&&0!==k.length&&(d=Y(d,k),f.removeRule?f.removeRule(d):f.deleteRule(d))}}angular.module("textAngular.factories",
[]).factory("taBrowserTag",[function(){return function(f){return f?""===f?void 0===A?"div":8>=A?"P":"p":8>=A?f.toUpperCase():f:8>=A?"P":"p"}}]).factory("taApplyCustomRenderers",["taCustomRenderers","taDOM",function(f,d){return function(k){var m=angular.element("<div></div>");return m[0].innerHTML=k,angular.forEach(f,function(f){var k=[];f.selector&&""!==f.selector?k=m.find(f.selector):f.customAttribute&&""!==f.customAttribute&&(k=d.getByAttribute(m,f.customAttribute));angular.forEach(k,function(d){d=
angular.element(d);f.selector&&""!==f.selector&&f.customAttribute&&""!==f.customAttribute?void 0!==d.attr(f.customAttribute)&&f.renderLogic(d):f.renderLogic(d)})}),m[0].innerHTML}}]).factory("taFixChrome",function(){return function(f){if(!f||!angular.isString(f)||0>=f.length)return f;for(var d,k,m,n=/<([^>\/]+?)style=("([^\"]+)"|'([^']+)')([^>]*)>/gi,u=/<span class="Apple-converted-space">([^<]+)<\/span>/gi,g="",l=0;d=u.exec(f);)k=d[1],k=k.replace(/&nbsp;/gi," "),g+=f.substring(l,d.index)+k,l=d.index+
d[0].length;for(l&&(g+=f.substring(l),f=g,g="",l=0);d=n.exec(f);)(k=d[3]||d[4])&&k.match(/line-height: 1.[0-9]{3,12};|color: inherit; line-height: 1.1;|color: rgb\(\d{1,3}, \d{1,3}, \d{1,3}\);|background-color: rgb\(\d{1,3}, \d{1,3}, \d{1,3}\);/i)&&(k=k.replace(/( |)font-family: inherit;|( |)line-height: 1.[0-9]{3,12};|( |)color: inherit;|( |)color: rgb\(\d{1,3}, \d{1,3}, \d{1,3}\);|( |)background-color: rgb\(\d{1,3}, \d{1,3}, \d{1,3}\);/gi,""),m="<"+d[1].trim(),0<k.trim().length&&(m+=" style="+d[2].substring(0,
1)+k+d[2].substring(0,1)),m+=d[5].trim()+">",g+=f.substring(l,d.index)+m,l=d.index+d[0].length);return g+=f.substring(l),0<l?g.replace(/<span\s?>(.*?)<\/span>(<br(\/|)>|)/gi,"$1"):f}}).factory("taSanitize",["$sanitize",function(f){function d(a,c){for(var b,d=0,f=0,e=/<[^>]*>/gi;b=e.exec(a);)if(f=b.index,"/"===b[0].substr(1,1)){if(0===d)break;d--}else d++;return c+a.substring(0,f)+angular.element(c)[0].outerHTML.substring(c.length)+a.substring(f)}function k(a){if(!a||!angular.isString(a)||0>=a.length)return a;
var c,b,f,l,q,g,r=/<([^>\/]+?)style=("([^"]+)"|'([^']+)')([^>]*)>/gi,y="",p="";for(g=0;b=r.exec(a);)if(l=b[3]||b[4],q=new RegExp(e,"i"),angular.isString(l)&&q.test(l)){q="";for(var n=new RegExp(e,"ig");f=n.exec(l);)for(c=0;c<m.length;c++)f[2*c+2]&&(q+="<"+m[c].tag+">");g=k(a.substring(g,b.index));p+=0<y.length?d(g,y):g;l=l.replace(new RegExp(e,"ig"),"");p+="<"+b[1].trim();0<l.length&&(p+=' style="'+l+'"');p+=b[5]+">";g=b.index+b[0].length;y=q}return p+(0<y.length?d(a.substring(g),y):a.substring(g))}
for(var m=[{property:"font-weight",values:["bold"],tag:"b"},{property:"font-style",values:["italic"],tag:"i"}],n=[],u=0;u<m.length;u++){for(var g="("+m[u].property+":\\s*(",l=0;l<m[u].values.length;l++)0<l&&(g+="|"),g+=m[u].values[l];g+=");)";n.push(g)}var e="("+n.join("|")+")",y=new RegExp(/<span id="selectionBoundary_\d+_\d+" class="rangySelectionBoundary">[^<>]+?<\/span>/gi),r=new RegExp(/<span class="rangySelectionBoundary" id="selectionBoundary_\d+_\d+">[^<>]+?<\/span>/gi),a=new RegExp(/<span id="selectionBoundary_\d+_\d+" class="rangySelectionBoundary">[^<>]+?<\/span>/gi);
return function(b,c,h){if(!h)try{b=k(b)}catch(p){}if(b&&angular.isString(b)&&!(0>=b.length)){for(var d,e=/<([^>\/]+?)align=("([^"]+)"|'([^']+)')([^>]*)>/gi,l="",g=0;d=e.exec(b);){var l=l+b.substring(g,d.index),g=d.index+d[0].length,m="<"+d[1]+d[5];/style=("([^"]+)"|'([^']+)')/gi.test(m)?m=m.replace(/style=("([^"]+)"|'([^']+)')/i,'style="$2$3 text-align:'+(d[3]||d[4])+';"'):m+=' style="text-align:'+(d[3]||d[4])+';"';m+=">";l+=m}b=l+b.substring(g)}if(b)try{b=b.replace(y,""),b=b.replace(r,""),b=b.replace(y,
""),b=b.replace(a,"")}catch(p){}var n;try{n=f(b),h&&(n=b)}catch(p){n=c||""}h=n.match(/(<pre[^>]*>.*?<\/pre[^>]*>)/gi);b=n.replace(/(&#(9|10);)*/gi,"");d=/<pre[^>]*>.*?<\/pre[^>]*>/gi;l=e=0;for(n="";null!==(c=d.exec(b))&&e<h.length;)n+=b.substring(l,c.index)+h[e],l=c.index+c[0].length,e++;return n+b.substring(l)}}]).factory("taToolExecuteAction",["$q","$log",function(f,d){return function(k){void 0!==k&&(this.$editor=function(){return k});var m,n=f.defer(),u=n.promise,g=this.$editor();try{m=this.action(n,
g.startAction()),u.finally(function(){g.endAction.call(g)})}catch(l){d.error(l)}(m||void 0===m)&&n.resolve()}}]);angular.module("textAngular.DOM",["textAngular.factories"]).factory("taExecCommand",["taSelection","taBrowserTag","$document",function(f,d,k){var m=function(d,a){var b,c,h=d.find("li");for(c=h.length-1;0<=c;c--)b=angular.element("<"+a+">"+h[c].innerHTML+"</"+a+">"),d.after(b);d.remove();f.setSelectionToElementEnd(b[0])},n=function(e,a,b,c,h){var l,g,k,m,r=e.find("li");for(l=0;l<r.length;l++)if(r[l].outerHTML===
a[0].outerHTML){m=l;0<l&&(g=r[l-1]);l+1<r.length&&(k=r[l+1]);break}l="";if(c?l+="<"+h+">"+a[0].innerHTML+"</"+h+">":(l+="<"+d(b)+">",l+="<li>"+a[0].innerHTML+"</li>",l+="</"+d(b)+">"),b=angular.element(l),!g)return a.remove(),e.after(angular.element(e[0].outerHTML)),e.after(b),e.remove(),void f.setSelectionToElementEnd(b[0]);if(k){a=(e.parent(),"");g=e[0].nodeName.toLowerCase();a+="<"+g+">";for(l=0;l<m;l++)a+="<li>"+r[l].innerHTML+"</li>";a+="</"+g+">";k=""+("<"+g+">");for(l=m+1;l<r.length;l++)k+=
"<li>"+r[l].innerHTML+"</li>";e.after(angular.element(k+("</"+g+">")));e.after(b);e.after(angular.element(a));e.remove()}else a.remove(),e.after(b);f.setSelectionToElementEnd(b[0])},u=function(l,a,b,c,h){var e,g,k,m,r=l.find("li"),n=[];for(e=0;e<r.length;e++)for(g=0;g<a.length;g++)r[e].isEqualNode(a[g])&&(n[g]=e);0<n[0]&&(k=r[n[0]-1]);n[a.length-1]+1<r.length&&(m=r[n[a.length-1]+1]);e="";if(c)for(g=0;g<a.length;g++)e+="<"+h+">"+a[g].innerHTML+"</"+h+">",a[g].remove();else{e+="<"+d(b)+">";for(g=0;g<
a.length;g++)e+=a[g].outerHTML,a[g].remove();e+="</"+d(b)+">"}if(b=angular.element(e),!k)return l.after(angular.element(l[0].outerHTML)),l.after(b),l.remove(),void f.setSelectionToElementEnd(b[0]);if(!m)return l.after(b),void f.setSelectionToElementEnd(b[0]);k="";m=l[0].nodeName.toLowerCase();k+="<"+m+">";for(e=0;e<n[0];e++)k+="<li>"+r[e].innerHTML+"</li>";k+="</"+m+">";c=""+("<"+m+">");for(e=n[a.length-1]+1;e<r.length;e++)c+="<li>"+r[e].innerHTML+"</li>";l.after(angular.element(c+("</"+m+">")));
l.after(b);l.after(angular.element(k));l.remove();f.setSelectionToElementEnd(b[0])},g=function(e){/(<br(|\/)>)$/i.test(e.innerHTML.trim())?f.setSelectionBeforeElement(angular.element(e).find("br")[0]):f.setSelectionToElementEnd(e)},l=function(e,a){a=angular.element("<"+a+">"+e[0].innerHTML+"</"+a+">");e.after(a);e.remove();g(a.find("li")[0])},e=function(e,a,b){for(var c="",h=0;h<e.length;h++)c+="<"+d("li")+">"+e[h].innerHTML+"</"+d("li")+">";e=angular.element("<"+b+">"+c+"</"+b+">");a.after(e);a.remove();
g(e.find("li")[0])},y=function(e,a){for(var b=0;b<e.childNodes.length;b++){var c=e.childNodes[b];c.tagName&&c.tagName.match(H)&&y(c,a)}if(null===e.parentNode)return e;a=angular.element(a);return a[0].innerHTML=e.innerHTML,e.parentNode.insertBefore(a[0],e),e.parentNode.removeChild(e),a};return function(g,a){return g=d(g),function(b,c,h,t){var x,q,v,w,r=angular.element("<"+g+">");try{f.getSelection&&(w=f.getSelection());v=f.getSelectionElement();var p,A;void 0!==v.tagName&&("div"===v.tagName.toLowerCase()&&
/taTextElement.+/.test(v.id)&&w&&w.start&&1===w.start.offset&&1===w.end.offset?(p=v.innerHTML,/<br>/i.test(p)&&(p=p.replace(/<br>/i,"&#8203;")),/<br\/>/i.test(p)&&(p=p.replace(/<br\/>/i,"&#8203;")),/<span>(<span>)+/i.test(p)&&(p=__.replace(/<span>(<span>)+/i,"<span>")),/<\/span>(<\/span>)+/i.test(p)&&(p=__.replace(/<\/span>(<\/span>)+/i,"</span>")),/<span><\/span>/i.test(p)&&(p=p.replace(/<span><\/span>/i,"")),A="<div>"+p+"</div>",v.innerHTML=A,f.setSelectionToElementEnd(v.childNodes[0]),v=f.getSelectionElement()):
"span"===v.tagName.toLowerCase()&&w&&w.start&&1===w.start.offset&&1===w.end.offset?(p=v.innerHTML,/<br>/i.test(p)&&(p=p.replace(/<br>/i,"&#8203;")),/<br\/>/i.test(p)&&(p=p.replace(/<br\/>/i,"&#8203;")),/<span>(<span>)+/i.test(p)&&(p=__.replace(/<span>(<span>)+/i,"<span>")),/<\/span>(<\/span>)+/i.test(p)&&(p=__.replace(/<\/span>(<\/span>)+/i,"</span>")),/<span><\/span>/i.test(p)&&(p=p.replace(/<span><\/span>/i,"")),A="<div>"+p+"</div>",v.innerHTML=A,f.setSelectionToElementEnd(v.childNodes[0]),v=f.getSelectionElement()):
"p"===v.tagName.toLowerCase()&&w&&w.start&&1===w.start.offset&&1===w.end.offset?(p=v.innerHTML,/<br>/i.test(p)&&(p=p.replace(/<br>/i,"&#8203;"),v.innerHTML=p,f.setSelectionToElementEnd(v.childNodes[0]),v=f.getSelectionElement())):"li"===v.tagName.toLowerCase()&&w&&w.start&&w.start.offset===w.end.offset&&(p=v.innerHTML,/<br>/i.test(p)&&(p=p.replace(/<br>/i,""),v.innerHTML=p,f.setSelectionToElementEnd(v.childNodes[0]),v=f.getSelectionElement())))}catch(E){}w=angular.element(v);p=v.tagName&&v.tagName.toLowerCase()||
"";if("insertorderedlist"===b.toLowerCase()||"insertunorderedlist"===b.toLowerCase()){r=d("insertorderedlist"===b.toLowerCase()?"ol":"ul");x=f.getOnlySelectedElements();if(1<x.length&&("ol"===p||"ul"===p))return u(w,x,r,r===p,g);if(p===r)return w[0].childNodes.length!==x.length&&1===x.length?(w=angular.element(x[0]),n(w.parent(),w,r,!0,g)):m(w,g);if("li"===p&&w.parent()[0].tagName.toLowerCase()===r&&1===w.parent().children().length)return m(w.parent(),g);if("li"===p&&w.parent()[0].tagName.toLowerCase()!==
r&&1===w.parent().children().length)return l(w.parent(),r);if(p.match(H)&&!w.hasClass("ta-bind")){if(x.length&&w[0].childNodes.length!==x.length&&1===x.length)return w=angular.element(x[0]),n(w.parent(),w,r,r===p,g);if("ol"===p||"ul"===p)return l(w,r);var F=!1;return angular.forEach(w.children(),function(a){a.tagName.match(H)&&(F=!0)}),F?e(w.children(),w,r):e([angular.element("<div>"+v.innerHTML+"</div>")[0]],w,r)}if(p.match(H)){if(q=f.getOnlySelectedElements(),0===q.length)c=angular.element("<"+
r+"><li>"+v.innerHTML+"</li></"+r+">"),w.html(""),w.append(c);else{if(1===q.length&&("ol"===q[0].tagName.toLowerCase()||"ul"===q[0].tagName.toLowerCase()))return q[0].tagName.toLowerCase()===r?m(angular.element(q[0]),g):l(angular.element(q[0]),r);x="";h=[];for(b=0;b<q.length;b++)3!==q[b].nodeType&&(c=angular.element(q[b]),"li"!==q[b].tagName.toLowerCase()&&(x+="ol"===q[b].tagName.toLowerCase()||"ul"===q[b].tagName.toLowerCase()?c[0].innerHTML:"span"!==q[b].tagName.toLowerCase()||"ol"!==q[b].childNodes[0].tagName.toLowerCase()&&
"ul"!==q[b].childNodes[0].tagName.toLowerCase()?"<"+d("li")+">"+c[0].innerHTML+"</"+d("li")+">":c[0].childNodes[0].innerHTML,h.unshift(c)));c=angular.element("<"+r+">"+x+"</"+r+">");h.pop().replaceWith(c);angular.forEach(h,function(a){a.remove()})}return void f.setSelectionToElementEnd(c[0])}}else{if("formatblock"===b.toLowerCase()){v=h.toLowerCase().replace(/[<>]/gi,"");"default"===v.trim()&&(v=g,h="<"+g+">");for(c="li"===p?w.parent():w;!c[0].tagName||!c[0].tagName.match(H)&&!c.parent().attr("contenteditable");)c=
c.parent(),p=(c[0].tagName||"").toLowerCase();if(p===v){q=c.children();h=!1;for(b=0;b<q.length;b++)h=h||q[b].tagName.match(H);h?(c.after(q),x=c.next(),c.remove(),c=x):(r.append(c[0].childNodes),c.after(r),c.remove(),c=r)}else if(c.parent()[0].tagName.toLowerCase()!==v||c.parent().hasClass("ta-bind"))if(p.match(qa))c.wrap(h);else{q=f.getOnlySelectedElements();0===q.length&&(q=[c[0]]);for(b=0;b<q.length;b++)if(3===q[b].nodeType||!q[b].tagName.match(H))for(;3===q[b].nodeType||!q[b].tagName||!q[b].tagName.match(H);)q[b]=
q[b].parentNode;if(q=q.filter(function(a,c,b){return b.indexOf(a)===c}),1<q.length&&(q=q.filter(function(a,c,b){return!("div"===a.nodeName.toLowerCase()&&/^taTextElement/.test(a.id))})),angular.element(q[0]).hasClass("ta-bind"))c=angular.element(h),c[0].innerHTML=q[0].innerHTML,q[0].innerHTML=c[0].outerHTML;else if("blockquote"===v){x="";for(b=0;b<q.length;b++)x+=q[b].outerHTML;c=angular.element(h);c[0].innerHTML=x;q[0].parentNode.insertBefore(c[0],q[0]);for(b=q.length-1;0<=b;b--)q[b].parentNode&&
q[b].parentNode.removeChild(q[b])}else if("pre"===v&&f.getStateShiftKey()){x="";for(b=0;b<q.length;b++)x+=q[b].outerHTML;c=angular.element(h);c[0].innerHTML=x;q[0].parentNode.insertBefore(c[0],q[0]);for(b=q.length-1;0<=b;b--)q[b].parentNode&&q[b].parentNode.removeChild(q[b])}else for(b=0;b<q.length;b++)r=y(q[b],h),q[b]===c[0]&&(c=angular.element(r))}else{q=c.parent();h=q.contents();for(b=0;b<h.length;b++)q.parent().hasClass("ta-bind")&&3===h[b].nodeType&&(r=angular.element("<"+g+">"),r[0].innerHTML=
h[b].outerHTML,h[b]=r[0]),q.parent()[0].insertBefore(h[b],q[0]);q.remove()}return f.setSelectionToElementEnd(c[0]),void c[0].focus()}if("createlink"===b.toLowerCase()){if("a"===p)return void(f.getSelectionElement().href=h);q='<a href="'+h+'" target="'+(t.a.target?t.a.target:"")+'">';f.getSelection().collapsed?f.insertHtml(q+h+"</a>",a):z.getSelection().getRangeAt(0).canSurroundContents()&&(q=angular.element(q+"</a>")[0],z.getSelection().getRangeAt(0).surroundContents(q));return}if("inserthtml"===
b.toLowerCase())return void f.insertHtml(h,a)}try{k[0].execCommand(b,c,h)}catch(E){}}}}]).service("taSelection",["$document","taDOM","$log",function(f,d,k){var m,n=f[0],u=function(d,e){return d.tagName&&d.tagName.match(/^br$/i)&&0===e&&!d.previousSibling?{element:d.parentNode,offset:0}:{element:d,offset:e}},g={getSelection:function(){var d;try{d=z.getSelection().getRangeAt(0)}catch(y){return}var e=d.commonAncestorContainer;d={start:u(d.startContainer,d.startOffset),end:u(d.endContainer,d.endOffset),
collapsed:d.collapsed};return 3===e.nodeType&&("div"===e.parentNode.nodeName.toLowerCase()&&/^taTextElement/.test(e.parentNode.id)||(e=e.parentNode)),"div"===e.nodeName.toLowerCase()&&/^taTextElement/.test(e.id)?(d.start.element=e.childNodes[d.start.offset],d.end.element=e.childNodes[d.end.offset],d.container=e):e.parentNode===d.start.element||e.parentNode===d.end.element?d.container=e.parentNode:d.container=e,d},updateLeftArrowKey:function(d){if((d=z.getSelection().getRangeAt(0))&&d.collapsed){var e=
g.getFlattenedDom(d);if(e.findIndex){var f,l=d.startContainer,a=e.findIndex(function(a,b){return a.node===l?!0:-1!==a.parents.indexOf(l)});if(!(e.forEach(function(a,b){a.parents.forEach(function(a,c){})}),a+1<e.length&&(f=e[a+1].node),f&&f.textContent&&/^\ufeff([^\ufeff]*)$/.exec(f.textContent))){var b;if(0<a&&(b=e[a-1].node),0===d.startOffset&&b&&/^\ufeff([^\ufeff]*)$/.exec(b.textContent))return void g.setSelectionToElementEnd(b)}}}},updateRightArrowKey:function(d){},getFlattenedDom:function(d){function e(a){a.node.childNodes.length?
Array.prototype.slice.call(a.node.childNodes).forEach(function(b){var c=a.parents.slice();c.slice(-1)[0]!==a.node&&c.push(a.node);e({parents:c,node:b})}):g.push({parents:a.parents,node:a.node})}var f=d.commonAncestorContainer.parentNode;if(!f)return d.commonAncestorContainer.childNodes;var g=Array.prototype.slice.call(f.childNodes);d=g.indexOf(d.startContainer);return d+1<g.length&&0<d||f.parentNode&&(f=f.parentNode),g=[],e({parents:[f],node:f}),g},getOnlySelectedElements:function(){var d=z.getSelection().getRangeAt(0),
e=d.commonAncestorContainer;return e=3===e.nodeType?e.parentNode:e,d.getNodes([1],function(d){return d.parentNode===e})},getAllSelectedElements:function(){var d=z.getSelection().getRangeAt(0),e=d.commonAncestorContainer,e=3===e.nodeType?e.parentNode:e,f=d.getNodes([1],function(a){return a.parentNode===e}),g=e.innerHTML;if(g=g.replace(/<span id=.selectionBoundary[^>]+>\ufeff?<\/span>/gi,""),g===d.toHtml()&&("div"!==e.nodeName.toLowerCase()||!/^taTextElement/.test(e.id))){d=[];for(g=f.length;g--;d.unshift(f[g]));
f=d;f.push(e)}return f},getSelectionElement:function(){return g.getSelection()?g.getSelection().container:void 0},setSelection:function(d,e,f,g){var a=z.createRange();a.setStart(d,f);a.setEnd(e,g);z.getSelection().setSingleRange(a)},setSelectionBeforeElement:function(d){var e=z.createRange();e.selectNode(d);e.collapse(!0);z.getSelection().setSingleRange(e)},setSelectionAfterElement:function(d){var e=z.createRange();e.selectNode(d);e.collapse(!1);z.getSelection().setSingleRange(e)},setSelectionToElementStart:function(d){var e=
z.createRange();e.selectNodeContents(d);e.collapse(!0);z.getSelection().setSingleRange(e)},setSelectionToElementEnd:function(d){var e=z.createRange();e.selectNodeContents(d);e.collapse(!1);d.childNodes&&d.childNodes[d.childNodes.length-1]&&"br"===d.childNodes[d.childNodes.length-1].nodeName&&(e.startOffset=e.endOffset=e.startOffset-1);z.getSelection().setSingleRange(e)},setStateShiftKey:function(d){m=d},getStateShiftKey:function(){return m},insertHtml:function(f,e){var k,m,a;k=angular.element("<div>"+
f+"</div>");var b=z.getSelection().getRangeAt(0),c=n.createDocumentFragment(),h=k[0].childNodes;k=!0;if(0<h.length){f=[];for(m=0;m<h.length;m++){var l=h[m];"p"===l.nodeName.toLowerCase()&&""===l.innerHTML.trim()||(k=k&&!H.test(l.nodeName),f.push(l))}for(h=0;h<f.length;h++)a=c.appendChild(f[h]);!k&&b.collapsed&&/^(|<br(|\/)>)$/i.test(b.startContainer.innerHTML)&&b.selectNode(b.startContainer)}else k=!0,a=c=n.createTextNode(f);if(k)b.deleteContents();else if(b.collapsed&&b.startContainer!==e)if(b.startContainer.innerHTML&&
b.startContainer.innerHTML.match(/^<[^>]*>$/i))e=b.startContainer,1===b.startOffset?(b.setStartAfter(e),b.setEndAfter(e)):(b.setStartBefore(e),b.setEndBefore(e));else{if(3===b.startContainer.nodeType&&b.startContainer.parentNode!==e)for(e=b.startContainer.parentNode,k=e.cloneNode(),d.splitNodes(e.childNodes,e,k,b.startContainer,b.startOffset);!ga.test(e.nodeName);)angular.element(e).after(k),e=e.parentNode,f=k,k=e.cloneNode(),d.splitNodes(e.childNodes,e,k,f);else e=b.startContainer,k=e.cloneNode(),
d.splitNodes(e.childNodes,e,k,void 0,void 0,b.startOffset);if(angular.element(e).after(k),b.setStartAfter(e),b.setEndAfter(e),/^(|<br(|\/)>)$/i.test(e.innerHTML.trim())&&(b.setStartBefore(e),b.setEndBefore(e),angular.element(e).remove()),/^(|<br(|\/)>)$/i.test(k.innerHTML.trim())&&angular.element(k).remove(),"li"===e.nodeName.toLowerCase()){f=n.createDocumentFragment();for(e=0;e<c.childNodes.length;e++)k=angular.element("<li>"),d.transferChildNodes(c.childNodes[e],k[0]),d.transferNodeAttributes(c.childNodes[e],
k[0]),f.appendChild(k[0]);c=f;a&&(a=c.childNodes[c.childNodes.length-1],a=a.childNodes[a.childNodes.length-1])}}else b.deleteContents();b.insertNode(c);a&&g.setSelectionToElementEnd(a)}};return g}]).service("taDOM",function(){var f={getByAttribute:function(d,k){var m=[],n=d.children();return n.length&&angular.forEach(n,function(d){m=m.concat(f.getByAttribute(angular.element(d),k))}),void 0!==d.attr(k)&&m.push(d),m},transferChildNodes:function(d,f){for(f.innerHTML="";0<d.childNodes.length;)f.appendChild(d.childNodes[0]);
return f},splitNodes:function(d,k,m,n,u,g){if(!n&&isNaN(g))throw Error("taDOM.splitNodes requires a splitNode or splitIndex");for(var l=document.createDocumentFragment(),e=document.createDocumentFragment(),y=0;0<d.length&&(isNaN(g)||g!==y)&&d[0]!==n;)l.appendChild(d[0]),y++;for(!isNaN(u)&&0<=u&&d[0]&&(l.appendChild(document.createTextNode(d[0].nodeValue.substring(0,u))),d[0].nodeValue=d[0].nodeValue.substring(u));0<d.length;)e.appendChild(d[0]);f.transferChildNodes(l,k);f.transferChildNodes(e,m)},
transferNodeAttributes:function(d,f){for(var k=0;k<d.attributes.length;k++)f.setAttribute(d.attributes[k].name,d.attributes[k].value);return f}};return f});angular.module("textAngular.validators",[]).directive("taMaxText",function(){return{restrict:"A",require:"ngModel",link:function(f,d,k,m){var n=parseInt(f.$eval(k.taMaxText));if(isNaN(n))throw"Max text must be an integer";k.$observe("taMaxText",function(d){if(n=parseInt(d),isNaN(n))throw"Max text must be an integer";m.$dirty&&m.$validate()});m.$validators.taMaxText=
function(d){var f=angular.element("<div/>");return f.html(d),f.text().length<=n}}}}).directive("taMinText",function(){return{restrict:"A",require:"ngModel",link:function(f,d,k,m){var n=parseInt(f.$eval(k.taMinText));if(isNaN(n))throw"Min text must be an integer";k.$observe("taMinText",function(d){if(n=parseInt(d),isNaN(n))throw"Min text must be an integer";m.$dirty&&m.$validate()});m.$validators.taMinText=function(d){var f=angular.element("<div/>");return f.html(d),!f.text().length||f.text().length>=
n}}}});angular.module("textAngular.taBind",["textAngular.factories","textAngular.DOM"]).service("_taBlankTest",[function(){return function(f){if(!f)return!0;var d=document.createElement("DIV");d.innerHTML=f;d=d.textContent||d.innerText||"";return""===(d.replace("\u200b",""),d.trim())&&!/<img[^>]+>/.test(f)}}]).directive("taButton",[function(){return{link:function(f,d,k){d.attr("unselectable","on");d.on("mousedown",function(d,f){return f&&angular.extend(d,f),d.preventDefault(),!1})}}}]).directive("taBind",
["taSanitize","$timeout","$document","taFixChrome","taBrowserTag","taSelection","taSelectableElements","taApplyCustomRenderers","taOptions","_taBlankTest","$parse","taDOM","textAngularManager",function(f,d,k,m,n,u,g,l,e,y,r,a,b){return{priority:2,require:["ngModel","?ngModelOptions"],link:function(c,h,t,n){function q(a){var c;return G.forEach(function(d){if(d.keyCode===a.keyCode){var b=(a.metaKey?U:0)+(a.ctrlKey?M:0)+(a.shiftKey?N:0)+(a.altKey?V:0);d.forbiddenModifiers&b||d.mustHaveModifiers.every(function(a){return b&
a})&&(c=d.specialKey)}}),c}var x,w,J,p=n[0],C=n[1]||{},F=void 0!==h.attr("contenteditable")&&h.attr("contenteditable"),E=F||"textarea"===h[0].tagName.toLowerCase()||"input"===h[0].tagName.toLowerCase(),D=!1,Z=!1,I=!1,aa=t.taUnsafeSanitizer||e.disableSanitizer,O=/^(9|19|20|27|33|34|35|36|37|38|39|40|45|112|113|114|115|116|117|118|119|120|121|122|123|144|145)$/i,P=/^(8|13|32|46|59|61|107|109|173|186|187|188|189|190|191|192|219|220|221|222)$/i,M=1,U=2,V=4,N=8,G=[{specialKey:"UndoKey",forbiddenModifiers:V+
N,mustHaveModifiers:[U+M],keyCode:90},{specialKey:"RedoKey",forbiddenModifiers:V,mustHaveModifiers:[U+M,N],keyCode:90},{specialKey:"RedoKey",forbiddenModifiers:V+N,mustHaveModifiers:[U+M],keyCode:89},{specialKey:"TabKey",forbiddenModifiers:U+N+V+M,mustHaveModifiers:[],keyCode:9},{specialKey:"ShiftTabKey",forbiddenModifiers:U+V+M,mustHaveModifiers:[N],keyCode:9}];void 0===t.taDefaultWrap&&(t.taDefaultWrap="p");""===t.taDefaultWrap?J="":(J=void 0===A||11<=A?"br"===t.taDefaultWrap.toLowerCase()?"<BR><BR>":
"<"+t.taDefaultWrap+"><br></"+t.taDefaultWrap+">":8>=A?"<"+t.taDefaultWrap.toUpperCase()+"></"+t.taDefaultWrap.toUpperCase()+">":"<"+t.taDefaultWrap+"></"+t.taDefaultWrap+">",void 0===A||11<=A?t.taDefaultWrap.toLowerCase():8>=A&&(t.taDefaultWrap.toUpperCase(),t.taDefaultWrap.toUpperCase()));C.$options||(C.$options={});n=function(a){if(y(a))return a;var c=angular.element("<div>"+a+"</div>");if(0===c.children().length)a="<"+t.taDefaultWrap+">"+a+"</"+t.taDefaultWrap+">";else{for(var d=c[0].childNodes,
b=!1,c=0;c<d.length&&!(b=d[c].nodeName.toLowerCase().match(H));c++);if(b)for(a="",c=0;c<d.length;c++){var b=d[c],e=b.nodeName.toLowerCase();"#comment"===e?a+="\x3c!--"+b.nodeValue+"--\x3e":"#text"===e?(b=b.textContent,a+=b.trim()?"<"+t.taDefaultWrap+">"+b+"</"+t.taDefaultWrap+">":b):e.match(H)?a+=b.outerHTML:(b=b.outerHTML||b.nodeValue,a+=""!==b.trim()?"<"+t.taDefaultWrap+">"+b+"</"+t.taDefaultWrap+">":b)}else a="<"+t.taDefaultWrap+">"+a+"</"+t.taDefaultWrap+">"}return a};t.taPaste&&(w=r(t.taPaste));
h.addClass("ta-bind");var ba;c["$undoManager"+(t.id||"")]=p.$undoManager={_stack:[],_index:0,_max:1E3,push:function(a){return"undefined"==typeof a||null===a||"undefined"!=typeof this.current()&&null!==this.current()&&a===this.current()?a:(this._index<this._stack.length-1&&(this._stack=this._stack.slice(0,this._index+1)),this._stack.push(a),ba&&d.cancel(ba),this._stack.length>this._max&&this._stack.shift(),this._index=this._stack.length-1,a)},undo:function(){return this.setToIndex(this._index-1)},
redo:function(){return this.setToIndex(this._index+1)},setToIndex:function(a){if(!(0>a||a>this._stack.length-1))return this._index=a,this.current()},current:function(){return this._stack[this._index]}};var B,R=function(){if(F)return h[0].innerHTML;if(E)return h.val();throw"textAngular Error: attempting to update non-editable taBind";},ca=function(a){return c.$emit("ta-element-select",this),a.preventDefault(),!1},ha=c["reApplyOnSelectorHandlers"+(t.id||"")]=function(){D||angular.forEach(g,function(a){h.find(a).off("click",
ca).on("click",ca)})},S=function(a,c,d){I=d||!1;"undefined"!=typeof c&&null!==c||(c=F);"undefined"!=typeof a&&null!==a||(a=R());y(a)?(""!==p.$viewValue&&p.$setViewValue(""),c&&""!==p.$undoManager.current()&&p.$undoManager.push("")):(ha(),p.$viewValue!==a&&(p.$setViewValue(a),c&&p.$undoManager.push(a)));p.$render()},K=c["$undoTaBind"+(t.id||"")]=function(){if(!D&&F){var a=p.$undoManager.undo();"undefined"!=typeof a&&null!==a&&(h[0].innerHTML=a,S(a,!1),B&&d.cancel(B),B=d(function(){h[0].focus();u.setSelectionToElementEnd(h[0])},
1))}},L=c["$redoTaBind"+(t.id||"")]=function(){if(!D&&F){var a=p.$undoManager.redo();"undefined"!=typeof a&&null!==a&&(h[0].innerHTML=a,S(a,!1),B&&d.cancel(B),B=d(function(){h[0].focus();u.setSelectionToElementEnd(h[0])},1))}};c["updateTaBind"+(t.id||"")]=function(){D||S(void 0,void 0,!0)};var T=function(a){return p.$oldViewValue=f(m(a),p.$oldViewValue,aa)};if(h.attr("required")&&(p.$validators.required=function(a,c){return!y(a||c)}),p.$parsers.push(T),p.$parsers.unshift(n),p.$formatters.push(T),
p.$formatters.unshift(n),p.$formatters.unshift(function(a){return p.$undoManager.push(a||"")}),E)if(c.events={},F){var ea=!1,W=function(b){var e=void 0!==b&&b.match(/content=["']*OneNote.File/i);if(b&&b.trim().length){if(b.match(/class=["']*Mso(Normal|List)/i)||b.match(/content=["']*Word.Document/i)||b.match(/content=["']*OneNote.File/i)){var g=b.match(/\x3c!--StartFragment--\x3e([\s\S]*?)\x3c!--EndFragment--\x3e/i),g=g?g[1]:b,g=g.replace(/<o:p>[\s\S]*?<\/o:p>/gi,"").replace(/class=(["']|)MsoNormal(["']|)/gi,
""),g=angular.element("<div>"+g+"</div>"),k=angular.element("<div></div>"),l=null,m=[];b=null;var q=!1,O;m.peek=function(){var a=this.length;if(0<a)return this[a-1]};for(var Q=function(a){q=a;l=angular.element(a?"<ul>":"<ol>");m=[];m.peek=function(){var a=this.length;if(0<a)return this[a-1]};O=null},t=0;t<=g[0].childNodes.length;t++)if(g[0].childNodes[t]&&"#text"!==g[0].childNodes[t].nodeName){var n=g[0].childNodes[t].tagName.toLowerCase();if("p"===n||"h1"===n||"h2"===n||"h3"===n||"h4"===n||"h5"===
n||"h6"===n){var n=angular.element(g[0].childNodes[t]),x=(n.attr("class")||"").match(/MsoList(Bullet|Number|Paragraph)(CxSp(First|Middle|Last)|)/i);if(x){if(!(2>n[0].childNodes.length||1>n[0].childNodes[1].childNodes.length)){var r="bullet"===x[1].toLowerCase()||"number"!==x[1].toLowerCase()&&!(/^[^0-9a-z<]*[0-9a-z]+[^0-9a-z<>]</i.test(n[0].childNodes[1].innerHTML)||/^[^0-9a-z<]*[0-9a-z]+[^0-9a-z<>]</i.test(n[0].childNodes[1].childNodes[0].innerHTML)),v=(n.attr("style")||"").match(/margin-left:([\-\.0-9]*)/i),
v=parseFloat(v?v[1]:0),P=(n.attr("style")||"").match(/mso-list:l([0-9]+) level([0-9]+) lfo[0-9+]($|;)/i);if(P&&P[2]&&(v=parseInt(P[2])),P&&(!O||P[1]!==O[1])||!x[3]||"first"===x[3].toLowerCase()||null===m.peek()||q!==r&&m.peek()===v)Q(r),k.append(l);else if(null!=m.peek()&&m.peek()<v)l=angular.element(r?"<ul>":"<ol>"),b.append(l);else if(null!=m.peek()&&m.peek()>v){for(;null!=m.peek()&&m.peek()>v;)if("li"!==l.parent()[0].tagName.toLowerCase()){if(!/[uo]l/i.test(l.parent()[0].tagName.toLowerCase()))break;
l=l.parent();m.pop()}else l=l.parent();q="ul"===l[0].tagName.toLowerCase();r!==q&&(Q(r),k.append(l))}O=P;v!==m.peek()&&m.push(v);b=angular.element("<li>");l.append(b);b.html(n.html().replace(/<!(--|)\[if !supportLists\](--|)>[\s\S]*?<!(--|)\[endif\](--|)>/gi,""));n.remove()}}else Q(!1),k.append(n)}}var M=function(a){a=angular.element(a);for(var c=a[0].childNodes.length-1;0<=c;c--)a.after(a[0].childNodes[c]);a.remove()};angular.forEach(k.find("span"),function(a){a.removeAttribute("lang");0>=a.attributes.length&&
M(a)});angular.forEach(k.find("font"),M);b=k.html();e&&(b=k.html()||g.html());b=b.replace(/\n/g," ")}else{if(b=b.replace(/<(|\/)meta[^>]*?>/gi,""),b.match(/<[^>]*?(ta-bind)[^>]*?>/)){if(b.match(/<[^>]*?(text-angular)[^>]*?>/)){e=angular.element("<div>"+b+"</div>");e.find("textarea").remove();g=a.getByAttribute(e,"ta-bind");for(k=0;k<g.length;k++){b=g[k][0].parentNode.parentNode;for(Q=0;Q<g[k][0].childNodes.length;Q++)b.parentNode.insertBefore(g[k][0].childNodes[Q],b);b.parentNode.removeChild(b)}b=
e.html().replace('<br class="Apple-interchange-newline">',"")}}else b.match(/^<span/)&&(b.match(/<span class=(\"Apple-converted-space\"|\'Apple-converted-space\')>.<\/span>/gi)||(b=b.replace(/<(|\/)span[^>]*?>/gi,"")));b=b.replace(/<br class="Apple-interchange-newline"[^>]*?>/gi,"").replace(/<span class="Apple-converted-space">( |&nbsp;)<\/span>/gi,"&nbsp;")}/<li(\s.*)?>/i.test(b)&&!1===/(<ul(\s.*)?>|<ol(\s.*)?>).*<li(\s.*)?>/i.test(b)&&(b=b.replace(/<li(\s.*)?>.*<\/li(\s.*)?>/i,"<ul>$&</ul>"));b=
b.replace(/^[ |\u00A0]+/gm,function(a){for(var c="",b=0;b<a.length;b++)c+="&nbsp;";return c}).replace(/\n|\r\n|\r/g,"<br />").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;");w&&(b=w(c,{$html:b})||b);b=f(b,"",aa);u.insertHtml(b,h[0]);d(function(){p.$setViewValue(R());ea=!1;h.removeClass("processing-paste")},0)}else ea=!1,h.removeClass("processing-paste")};h.on("paste",c.events.paste=function(a,c){if(c&&angular.extend(a,c),D||ea)return a.stopPropagation(),a.preventDefault(),!1;ea=!0;h.addClass("processing-paste");
var b;if((c=(a.originalEvent||a).clipboardData)&&c.getData&&0<c.types.length){for(var e="",f=0;f<c.types.length;f++)e+=" "+c.types[f];return/text\/html/i.test(e)?b=c.getData("text/html"):/text\/plain/i.test(e)&&(b=c.getData("text/plain")),W(b),a.stopPropagation(),a.preventDefault(),!1}var g=z.saveSelection(),l=angular.element('<div class="ta-hidden-input" contenteditable="true"></div>');k.find("body").append(l);l[0].focus();d(function(){z.restoreSelection(g);W(l[0].innerHTML);h[0].focus();l.remove()},
0)});h.on("cut",c.events.cut=function(a){D?a.preventDefault():d(function(){p.$setViewValue(R())},0)});h.on("keydown",c.events.keydown=function(a,d){d&&angular.extend(a,d);16===a.keyCode?u.setStateShiftKey(!0):u.setStateShiftKey(!1);a.specialKey=q(a);var f;if(e.keyMappings.forEach(function(c){a.specialKey===c.commandKeyCode&&(a.specialKey=void 0);c.testForKey(a)&&(f=c.commandKeyCode);"UndoKey"!==c.commandKeyCode&&"RedoKey"!==c.commandKeyCode||c.enablePropagation||a.preventDefault()}),"undefined"!=
typeof f&&(a.specialKey=f),"undefined"==typeof a.specialKey||"UndoKey"===a.specialKey&&"RedoKey"===a.specialKey||(a.preventDefault(),b.sendKeyCommand(c,a)),!(D||("UndoKey"===a.specialKey&&(K(),a.preventDefault()),"RedoKey"===a.specialKey&&(L(),a.preventDefault()),13!==a.keyCode||a.shiftKey||a.ctrlKey||a.metaKey||a.altKey))){var h;d=u.getSelectionElement();if(d.nodeName.match(ga)){var g=angular.element(J);if(function(a,c){for(var b=0;b<a.length;b++)if(a[b]===c)return!0;return!1}(["blockquote","ul",
"ol"],d.parentNode.tagName.toLowerCase())){if(/^<br(|\/)>$/i.test(d.innerHTML.trim())&&!d.nextSibling){h=angular.element(d);var k=h.parent();k.after(g);h.remove();0===k.children().length&&k.remove();u.setSelectionToElementStart(g[0]);a.preventDefault()}/^<[^>]+><br(|\/)><\/[^>]+>$/i.test(d.innerHTML.trim())&&(h=angular.element(d),h.after(g),h.remove(),u.setSelectionToElementStart(g[0]),a.preventDefault())}}}});var ia;h.on("keyup",c.events.keyup=function(a,c){if(c&&angular.extend(a,c),u.setStateShiftKey(!1),
9===a.keyCode)return void(u.getSelection().start.element===h[0]&&h.children().length&&u.setSelectionToElementStart(h.children()[0]));if(!((37!==a.keyCode||a.shiftKey||u.updateLeftArrowKey(h),39!==a.keyCode||a.shiftKey||u.updateRightArrowKey(h),ba&&d.cancel(ba),D||O.test(a.keyCode))||13===a.keyCode&&(a.ctrlKey||a.metaKey||a.altKey))){if(!(""===J||"<BR><BR>"===J||13!==a.keyCode||a.ctrlKey||a.metaKey||a.altKey||a.shiftKey)){for(c=u.getSelectionElement();!c.nodeName.match(ga)&&c!==h[0];)c=c.parentNode;
if(c.tagName.toLowerCase()!==t.taDefaultWrap&&"li"!==c.tagName.toLowerCase()&&(""===c.innerHTML.trim()||"<br>"===c.innerHTML.trim())){var b=angular.element(J);angular.element(c).replaceWith(b);u.setSelectionToElementStart(b[0])}}var e=R();""===J||""!==e.trim()&&"<br>"!==e.trim()?"<"!==e.substring(0,1)&&""!==t.taDefaultWrap:(h[0].innerHTML=J,u.setSelectionToElementStart(h.children()[0]));var f=x!==a.keyCode&&P.test(a.keyCode);ia&&d.cancel(ia);ia=d(function(){S(e,f,!0)},C.$options.debounce||400);f||
(ba=d(function(){p.$undoManager.push(e)},250));x=a.keyCode}});var ja;if(h.on("input",function(){R()!==p.$viewValue&&(ja&&d.cancel(ja),ja=d(function(){var a=R();a!==p.$viewValue&&S(a,!0)},1E3))}),h.on("blur",c.events.blur=function(){Z=!1;D?(I=!0,p.$render()):S(void 0,void 0,!0)}),t.placeholder&&(8<A||void 0===A)){var X;if(!t.id)throw"textAngular Error: An unique ID is required for placeholders to work";X=na("#"+t.id+".placeholder-text:before",'content: "'+t.placeholder+'"');c.$on("$destroy",function(){oa(X)})}h.on("focus",
c.events.focus=function(){Z=!0;h.removeClass("placeholder-text");ha()});h.on("mouseup",c.events.mouseup=function(){var a=u.getSelection();a&&a.start.element===h[0]&&h.children().length&&u.setSelectionToElementStart(h.children()[0])});h.on("mousedown",c.events.mousedown=function(a,c){c&&angular.extend(a,c);a.stopPropagation()})}else{h.on("change blur",c.events.change=c.events.blur=function(){D||p.$setViewValue(R())});h.on("keydown",c.events.keydown=function(a,c){if(c&&angular.extend(a,c),9===a.keyCode){c=
this.selectionStart;var b=this.selectionEnd,d=h.val();if(a.shiftKey){var b=d.lastIndexOf("\n",c),e=d.lastIndexOf("\t",c);-1!==e&&e>=b&&(h.val(d.substring(0,e)+d.substring(e+1)),this.selectionStart=this.selectionEnd=c-1)}else h.val(d.substring(0,c)+"\t"+d.substring(b)),this.selectionStart=this.selectionEnd=c+1;a.preventDefault()}});var ka=function(a,c){for(var b="",d=0;d<c;d++)b+=a;return b},Y=function(a,c,b){for(var d=0;d<a.length;d++)c.call(b,d,a[d])},pa=function(a,c){var b="",d=a.childNodes;return c++,
b+=ka("\t",c-1)+a.outerHTML.substring(0,4),Y(d,function(a,d){a=d.nodeName.toLowerCase();return"#comment"===a?void(b+="\x3c!--"+d.nodeValue+"--\x3e"):"#text"===a?void(b+=d.textContent):void(d.outerHTML&&(b+="ul"===a||"ol"===a?"\n"+pa(d,c):"\n"+ka("\t",c)+d.outerHTML))}),b+="\n"+ka("\t",c-1)+a.outerHTML.substring(a.outerHTML.lastIndexOf("<"))};p.$formatters.unshift(function(a){var c=angular.element("<div>"+a+"</div>")[0].childNodes;return 0<c.length&&(a="",Y(c,function(c,b){c=b.nodeName.toLowerCase();
return"#comment"===c?void(a+="\x3c!--"+b.nodeValue+"--\x3e"):"#text"===c?void(a+=b.textContent):void(b.outerHTML&&(0<a.length&&(a+="\n"),a+="ul"===c||"ol"===c?""+pa(b,0):""+b.outerHTML))})),a})}var fa,da=function(a,b){(b&&angular.extend(a,b),la||D)||(la=!0,c.$emit("ta-drop-event",this,a,a.originalEvent?a.originalEvent.dataTransfer:a.dataTransfer),d(function(){la=!1;S(void 0,void 0,!0)},100))},ma=!1;p.$render=function(){if(!ma){ma=!0;var a=p.$viewValue||"";I||(F&&Z&&(h.removeClass("placeholder-text"),
fa&&d.cancel(fa),fa=d(function(){Z||(h[0].focus(),u.setSelectionToElementEnd(h.children()[h.children().length-1]));fa=void 0},1)),F?(h[0].innerHTML=""===a?J:a,D?h.off("drop",da):(ha(),h.on("drop",da))):"textarea"!==h[0].tagName.toLowerCase()&&"input"!==h[0].tagName.toLowerCase()?h[0].innerHTML=l(a):h.val(a));F&&t.placeholder&&(""===a?Z?h.removeClass("placeholder-text"):h.addClass("placeholder-text"):h.removeClass("placeholder-text"));ma=I=!1}};t.taReadonly&&(D=c.$eval(t.taReadonly),D?(h.addClass("ta-readonly"),
"textarea"!==h[0].tagName.toLowerCase()&&"input"!==h[0].tagName.toLowerCase()||h.attr("disabled","disabled"),void 0!==h.attr("contenteditable")&&h.attr("contenteditable")&&h.removeAttr("contenteditable")):(h.removeClass("ta-readonly"),"textarea"===h[0].tagName.toLowerCase()||"input"===h[0].tagName.toLowerCase()?h.removeAttr("disabled"):F&&h.attr("contenteditable","true")),c.$watch(t.taReadonly,function(a,c){c!==a&&(a?(h.addClass("ta-readonly"),"textarea"!==h[0].tagName.toLowerCase()&&"input"!==h[0].tagName.toLowerCase()||
h.attr("disabled","disabled"),void 0!==h.attr("contenteditable")&&h.attr("contenteditable")&&h.removeAttr("contenteditable"),angular.forEach(g,function(a){h.find(a).on("click",ca)}),h.off("drop",da)):(h.removeClass("ta-readonly"),"textarea"===h[0].tagName.toLowerCase()||"input"===h[0].tagName.toLowerCase()?h.removeAttr("disabled"):F&&h.attr("contenteditable","true"),angular.forEach(g,function(a){h.find(a).off("click",ca)}),h.on("drop",da)),D=a)}));F&&!D&&(angular.forEach(g,function(a){h.find(a).on("click",
ca)}),h.on("drop",da))}}}]);var la=!1,C=angular.module("textAngular","ngSanitize textAngularSetup textAngular.factories textAngular.DOM textAngular.validators textAngular.taBind".split(" "));return C.config([function(){angular.forEach(G,function(f,d){delete G[d]})}]),C.directive("textAngular",["$compile","$timeout","taOptions","taSelection","taExecCommand","textAngularManager","$document","$animate","$log","$q","$parse",function(f,d,k,m,n,u,g,l,e,y,r){return{require:"?ngModel",scope:{},restrict:"EA",
priority:2,link:function(a,b,c,h){var t,x,q,v,w,A,p,C,F,E=c.serial?c.serial:Math.floor(1E16*Math.random());a._name=c.name?c.name:"textAngularEditor"+E;var D=function(a,c,b){d(function(){var d=function(){a.off(c,d);b.apply(this,arguments)};a.on(c,d)},100)};if(w=n(c.taDefaultWrap),angular.extend(a,angular.copy(k),{wrapSelection:function(c,b,d){"undo"===c.toLowerCase()?a["$undoTaBindtaTextElement"+E]():"redo"===c.toLowerCase()?a["$redoTaBindtaTextElement"+E]():(w(c,!1,b,a.defaultTagAttributes),d&&a["reApplyOnSelectorHandlerstaTextElement"+
E](),a.displayElements.text[0].focus())},showHtml:a.$eval(c.taShowHtml)||!1}),c.taFocussedClass&&(a.classes.focussed=c.taFocussedClass),c.taTextEditorClass&&(a.classes.textEditor=c.taTextEditorClass),c.taHtmlEditorClass&&(a.classes.htmlEditor=c.taHtmlEditorClass),c.taDefaultTagAttributes)try{angular.extend(a.defaultTagAttributes,angular.fromJson(c.taDefaultTagAttributes))}catch(O){e.error(O)}c.taTextEditorSetup&&(a.setup.textEditorSetup=a.$parent.$eval(c.taTextEditorSetup));c.taHtmlEditorSetup&&(a.setup.htmlEditorSetup=
a.$parent.$eval(c.taHtmlEditorSetup));c.taFileDrop?a.fileDropHandler=a.$parent.$eval(c.taFileDrop):a.fileDropHandler=a.defaultFileDropHandler;q=b[0].innerHTML;b[0].innerHTML="";a.displayElements={forminput:angular.element("<input type='hidden' tabindex='-1' style='display: none;'>"),html:angular.element("<textarea></textarea>"),text:angular.element("<div></div>"),scrollWindow:angular.element("<div class='ta-scroll-window'></div>"),popover:angular.element('<div class="popover fade bottom" style="max-width: none; width: 305px;"></div>'),
popoverArrow:angular.element('<div class="arrow"></div>'),popoverContainer:angular.element('<div class="popover-content"></div>'),resize:{overlay:angular.element('<div class="ta-resizer-handle-overlay"></div>'),background:angular.element('<div class="ta-resizer-handle-background"></div>'),anchors:[angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-tl"></div>'),angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-tr"></div>'),angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-bl"></div>'),
angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-br"></div>')],info:angular.element('<div class="ta-resizer-handle-info"></div>')}};a.displayElements.popover.append(a.displayElements.popoverArrow);a.displayElements.popover.append(a.displayElements.popoverContainer);a.displayElements.scrollWindow.append(a.displayElements.popover);a.displayElements.popover.on("mousedown",function(a,c){return c&&angular.extend(a,c),a.preventDefault(),!1});a.handlePopoverEvents=function(){"block"===
a.displayElements.popover.css("display")&&(C&&d.cancel(C),C=d(function(){a.reflowPopover(F);a.reflowResizeOverlay(F)},100))};angular.element(window).on("resize",function(c,b){a.handlePopoverEvents()});angular.element(window).on("scroll",function(c,b){a.handlePopoverEvents()});a.getScrollTop=function(c,b){var d=c.scrollTop;"undefined"==typeof d&&(d=0);var e;if(e=b){var f;a:{var h;e={vertical:!1,horizontal:!1};try{if(h=window.getComputedStyle(c),null===h){f=e;break a}}catch(ra){f=e;break a}f=h["overflow-y"];
h=h["overflow-x"];f={vertical:("scroll"===f||"auto"===f)&&c.scrollHeight>c.clientHeight,horizontal:("scroll"===h||"auto"===h)&&c.scrollWidth>c.clientWidth}}e=f.vertical}return e&&(c.removeEventListener("scroll",a._scrollListener,!1),c.addEventListener("scroll",a._scrollListener,!1)),0!==d?{node:c.nodeName,top:d}:c.parentNode?a.getScrollTop(c.parentNode,b):{node:"<none>",top:0}};a.showPopover=function(c){a.getScrollTop(a.displayElements.scrollWindow[0],!0);a.displayElements.popover.css("display","block");
F=c;a.reflowPopover(c);l.addClass(a.displayElements.popover,"in");D(g.find("body"),"click keyup",function(){a.hidePopover()})};a._scrollListener=function(c,b){a.handlePopoverEvents()};a.reflowPopover=function(c){var b=a.getScrollTop(a.displayElements.scrollWindow[0],!1);51>c[0].offsetTop-b.top?(a.displayElements.popover.css("top",c[0].offsetTop+c[0].offsetHeight+a.displayElements.scrollWindow[0].scrollTop+"px"),a.displayElements.popover.removeClass("top").addClass("bottom")):(a.displayElements.popover.css("top",
c[0].offsetTop-54+a.displayElements.scrollWindow[0].scrollTop+"px"),a.displayElements.popover.removeClass("bottom").addClass("top"));var b=a.displayElements.text[0].offsetWidth-a.displayElements.popover[0].offsetWidth,d=c[0].offsetLeft+c[0].offsetWidth/2-a.displayElements.popover[0].offsetWidth/2;c=Math.max(0,Math.min(b,d));b=Math.min(d,Math.max(0,d-b))-11;c+=window.scrollX;b-=window.scrollX;a.displayElements.popover.css("left",c+"px");a.displayElements.popoverArrow.css("margin-left",b+"px")};a.hidePopover=
function(){a.displayElements.popover.css("display","none");a.displayElements.popoverContainer.attr("style","");a.displayElements.popoverContainer.attr("class","popover-content");a.displayElements.popover.removeClass("in")};a.displayElements.resize.overlay.append(a.displayElements.resize.background);angular.forEach(a.displayElements.resize.anchors,function(c){a.displayElements.resize.overlay.append(c)});a.displayElements.resize.overlay.append(a.displayElements.resize.info);a.displayElements.scrollWindow.append(a.displayElements.resize.overlay);
a.displayElements.resize.background.on("click",function(c){a.displayElements.text[0].focus()});a.reflowResizeOverlay=function(c){c=angular.element(c)[0];a.displayElements.resize.overlay.css({display:"block",left:c.offsetLeft-5+"px",top:c.offsetTop-5+"px",width:c.offsetWidth+10+"px",height:c.offsetHeight+10+"px"});a.displayElements.resize.info.text(c.offsetWidth+" x "+c.offsetHeight)};a.showResizeOverlay=function(b){var d=g.find("body");A=function(e){var f=parseInt(b.attr("width")),h=parseInt(b.attr("height")),
g=e.clientX,k=e.clientY;(void 0===f||isNaN(f))&&(f=b[0].offsetWidth);(void 0===h||isNaN(h))&&(h=b[0].offsetHeight);a.hidePopover();var l=h/f,m=function(d){var e=Math.max(0,f+(d.clientX-g)),m=Math.max(0,h+(d.clientY-k)),q=c.taResizeMaintainAspectRatio;if(void 0!==c.taResizeForceAspectRatio||q&&!d.shiftKey)d=m/e,e=l>d?e:m/l,m=l>d?e*l:m;d=angular.element(b);d.css("height",Math.round(Math.max(0,m))+"px");d.css("width",Math.round(Math.max(0,e))+"px");a.reflowResizeOverlay(b)};d.on("mousemove",m);D(d,"mouseup",
function(c){c.preventDefault();c.stopPropagation();d.off("mousemove",m);a.$apply(function(){a.hidePopover();a.updateTaBindtaTextElement()},100)});e.stopPropagation();e.preventDefault()};a.displayElements.resize.anchors[3].off("mousedown");a.displayElements.resize.anchors[3].on("mousedown",A);a.reflowResizeOverlay(b);D(d,"click",function(){a.hideResizeOverlay()})};a.hideResizeOverlay=function(){a.displayElements.resize.anchors[3].off("mousedown",A);a.displayElements.resize.overlay.css("display","none")};
a.setup.htmlEditorSetup(a.displayElements.html);a.setup.textEditorSetup(a.displayElements.text);a.displayElements.html.attr({id:"taHtmlElement"+E,"ng-show":"showHtml","ta-bind":"ta-bind","ng-model":"html","ng-model-options":b.attr("ng-model-options")});a.displayElements.text.attr({id:"taTextElement"+E,contentEditable:"true","ta-bind":"ta-bind","ng-model":"html","ng-model-options":b.attr("ng-model-options")});a.displayElements.scrollWindow.attr({"ng-hide":"showHtml"});c.taDefaultWrap&&a.displayElements.text.attr("ta-default-wrap",
c.taDefaultWrap);c.taUnsafeSanitizer&&(a.displayElements.text.attr("ta-unsafe-sanitizer",c.taUnsafeSanitizer),a.displayElements.html.attr("ta-unsafe-sanitizer",c.taUnsafeSanitizer));a.displayElements.scrollWindow.append(a.displayElements.text);b.append(a.displayElements.scrollWindow);b.append(a.displayElements.html);a.displayElements.forminput.attr("name",a._name);b.append(a.displayElements.forminput);c.tabindex&&(b.removeAttr("tabindex"),a.displayElements.text.attr("tabindex",c.tabindex),a.displayElements.html.attr("tabindex",
c.tabindex));c.placeholder&&(a.displayElements.text.attr("placeholder",c.placeholder),a.displayElements.html.attr("placeholder",c.placeholder));c.taDisabled&&(a.displayElements.text.attr("ta-readonly","disabled"),a.displayElements.html.attr("ta-readonly","disabled"),a.disabled=a.$parent.$eval(c.taDisabled),a.$parent.$watch(c.taDisabled,function(c){a.disabled=c;a.disabled?b.addClass(a.classes.disabled):b.removeClass(a.classes.disabled)}));c.taPaste&&(a._pasteHandler=function(b){return r(c.taPaste)(a.$parent,
{$html:b})},a.displayElements.text.attr("ta-paste","_pasteHandler($html)"));f(a.displayElements.scrollWindow)(a);f(a.displayElements.html)(a);a.updateTaBindtaTextElement=a["updateTaBindtaTextElement"+E];a.updateTaBindtaHtmlElement=a["updateTaBindtaHtmlElement"+E];b.addClass("ta-root");a.displayElements.scrollWindow.addClass("ta-text ta-editor "+a.classes.textEditor);a.displayElements.html.addClass("ta-html ta-editor "+a.classes.htmlEditor);var B=function(a,c){c!==g[0].queryCommandState(a)&&g[0].execCommand(a,
!1,null)},I=a._actionRunning=!1;if(a.startAction=function(){var c=!1,b=!1,d=!1,e=!1;return a._actionRunning=!0,c=g[0].queryCommandState("bold"),b=g[0].queryCommandState("italic"),d=g[0].queryCommandState("underline"),e=g[0].queryCommandState("strikeThrough"),I=z.saveSelection(),B("bold",c),B("italic",b),B("underline",d),B("strikeThrough",e),function(){I&&z.restoreSelection(I)}},a.endAction=function(){a._actionRunning=!1;I&&(a.showHtml?a.displayElements.html[0].focus():a.displayElements.text[0].focus(),
z.removeMarkers(I));I=!1;a.updateSelectedStyles();a.showHtml||a["updateTaBindtaTextElement"+E]()},t=function(c){a.focussed=!0;b.addClass(a.classes.focussed);v.focus();b.triggerHandler("focus");a.updateSelectedStyles&&!a._bUpdateSelectedStyles&&d(function(){a.updateSelectedStyles()},0)},a.displayElements.html.on("focus",t),a.displayElements.text.on("focus",t),x=function(c){return a._actionRunning||g[0].activeElement===a.displayElements.html[0]||g[0].activeElement===a.displayElements.text[0]||(b.removeClass(a.classes.focussed),
v.unfocus(),d(function(){a._bUpdateSelectedStyles=!1;b.triggerHandler("blur");a.focussed=!1},0)),c.preventDefault(),!1},a.displayElements.html.on("blur",x),a.displayElements.text.on("blur",x),a.displayElements.text.on("paste",function(a){b.triggerHandler("paste",a)}),a.queryFormatBlockState=function(c){return!a.showHtml&&c.toLowerCase()===g[0].queryCommandValue("formatBlock").toLowerCase()},a.queryCommandState=function(c){return a.showHtml?"":g[0].queryCommandState(c)},a.switchView=function(){a.showHtml=
!a.showHtml;l.enabled(!1,a.displayElements.html);l.enabled(!1,a.displayElements.text);a.showHtml?d(function(){return l.enabled(!0,a.displayElements.html),l.enabled(!0,a.displayElements.text),a.displayElements.html[0].focus()},100):d(function(){return l.enabled(!0,a.displayElements.html),l.enabled(!0,a.displayElements.text),a.displayElements.text[0].focus()},100)},c.ngModel){var aa=!0;h.$render=function(){if(aa){aa=!1;var b=a.$parent.$eval(c.ngModel);void 0!==b&&null!==b||!q||""===q||h.$setViewValue(q)}a.displayElements.forminput.val(h.$viewValue);
a.html=h.$viewValue||""};b.attr("required")&&(h.$validators.required=function(a,c){a=a||c;return!(!a||""===a.trim())})}else a.displayElements.forminput.val(q),a.html=q;(a.$watch("html",function(b,d){b!==d&&(c.ngModel&&h.$viewValue!==b&&h.$setViewValue(b),a.displayElements.forminput.val(b))}),c.taTargetToolbars)?v=u.registerEditor(a._name,a,c.taTargetToolbars.split(",")):(t=angular.element('<div text-angular-toolbar name="textAngularToolbar'+E+'">'),c.taToolbar&&t.attr("ta-toolbar",c.taToolbar),c.taToolbarClass&&
t.attr("ta-toolbar-class",c.taToolbarClass),c.taToolbarGroupClass&&t.attr("ta-toolbar-group-class",c.taToolbarGroupClass),c.taToolbarButtonClass&&t.attr("ta-toolbar-button-class",c.taToolbarButtonClass),c.taToolbarActiveButtonClass&&t.attr("ta-toolbar-active-button-class",c.taToolbarActiveButtonClass),c.taFocussedClass&&t.attr("ta-focussed-class",c.taFocussedClass),b.prepend(t),f(t)(a.$parent),v=u.registerEditor(a._name,a,["textAngularToolbar"+E]));a.$on("$destroy",function(){u.unregisterEditor(a._name);
angular.element(window).off("blur")});a.$on("ta-element-select",function(c,b){v.triggerElementSelect(c,b)&&a["reApplyOnSelectorHandlerstaTextElement"+E]()});a.$on("ta-drop-event",function(c,b,f,h){h&&h.files&&0<h.files.length?(a.displayElements.text[0].focus(),angular.forEach(h.files,function(c){try{y.when(a.fileDropHandler(c,a.wrapSelection)||a.fileDropHandler!==a.defaultFileDropHandler&&y.when(a.defaultFileDropHandler(c,a.wrapSelection))).then(function(){a["updateTaBindtaTextElement"+E]()})}catch(N){e.error(N)}}),
f.preventDefault(),f.stopPropagation()):d(function(){a["updateTaBindtaTextElement"+E]()},0)});a._bUpdateSelectedStyles=!1;angular.element(window).on("blur",function(){a._bUpdateSelectedStyles=!1;a.focussed=!1});a.updateSelectedStyles=function(){var c;p&&d.cancel(p);void 0!==(c=m.getSelectionElement())&&c.parentNode!==a.displayElements.text[0]?v.updateSelectedStyles(angular.element(c)):v.updateSelectedStyles();a._bUpdateSelectedStyles&&(p=d(a.updateSelectedStyles,200))};t=function(){return a.focussed?
void(a._bUpdateSelectedStyles||(a._bUpdateSelectedStyles=!0,a.$apply(function(){a.updateSelectedStyles()}))):void(a._bUpdateSelectedStyles=!1)};a.displayElements.html.on("keydown",t);a.displayElements.text.on("keydown",t);t=function(){a._bUpdateSelectedStyles=!1};a.displayElements.html.on("keyup",t);a.displayElements.text.on("keyup",t);t=function(c,b){if(m.getSelection){var d=m.getSelection();m.getSelectionElement()&&"a"===m.getSelectionElement().nodeName.toLowerCase()&&(3===d.start.element.nodeType&&
d.start.element.textContent.length===d.end.offset&&m.setSelectionAfterElement(m.getSelectionElement()),3===d.start.element.nodeType&&0===d.start.offset&&m.setSelectionBeforeElement(m.getSelectionElement()))}b&&angular.extend(c,b);a.$apply(function(){if(v.sendKeyCommand(c))return a._bUpdateSelectedStyles||a.updateSelectedStyles(),c.preventDefault(),!1})};a.displayElements.html.on("keypress",t);a.displayElements.text.on("keypress",t);t=function(){a._bUpdateSelectedStyles=!1;d(function(){a.updateSelectedStyles()},
0)};a.displayElements.html.on("mouseup",t);a.displayElements.text.on("mouseup",t)}}}]),C.service("textAngularManager",["taToolExecuteAction","taTools","taRegisterTool","$interval","$rootScope","$log",function(f,d,k,m,n,u){var g,l={},e={},y=0,r=function(a){angular.forEach(e,function(c){c.editorFunctions.updateSelectedStyles(a)})},a=function(){y=Date.now();g=m(function(){r();g=void 0},50,1)};n.$on("destroy",function(){g&&(m.cancel(g),g=void 0)});var b=function(){50<Math.abs(Date.now()-y)&&a()};return{registerEditor:function(a,
h,g){if(!a||""===a)throw"textAngular Error: An editor requires a name";if(!h)throw"textAngular Error: An editor requires a scope";if(e[a])throw'textAngular Error: An Editor with name "'+a+'" already exists';return e[a]={scope:h,toolbars:g,toolbarScopes:[],_registerToolbarScope:function(a){0<=this.toolbars.indexOf(a.name)&&this.toolbarScopes.push(a)},editorFunctions:{disable:function(){angular.forEach(e[a].toolbarScopes,function(a){a.disabled=!0})},enable:function(){angular.forEach(e[a].toolbarScopes,
function(a){a.disabled=!1})},focus:function(){angular.forEach(e[a].toolbarScopes,function(a){a._parent=h;a.disabled=!1;a.focussed=!0});h.focussed=!0},unfocus:function(){angular.forEach(e[a].toolbarScopes,function(a){a.disabled=!0;a.focussed=!1});h.focussed=!1},updateSelectedStyles:function(c){angular.forEach(e[a].toolbarScopes,function(a){angular.forEach(a.tools,function(b){b.activeState&&(a._parent=h,b.active=b.activeState(c))})})},sendKeyCommand:function(c){var b=!1;return(c.ctrlKey||c.metaKey||
c.specialKey)&&angular.forEach(d,function(d,g){if(d.commandKeyCode&&(d.commandKeyCode===c.which||d.commandKeyCode===c.specialKey))for(d=0;d<e[a].toolbarScopes.length;d++)if(void 0!==e[a].toolbarScopes[d].tools[g]){f.call(e[a].toolbarScopes[d].tools[g],h);b=!0;break}}),b},triggerElementSelect:function(c,b){var f=function(a,c){for(var b=!0,d=0;d<c.length;d++)b=b&&a.attr(c[d]);return b},g=[],k={},l=!1;b=angular.element(b);var m=!1;if(angular.forEach(d,function(a,c){a.onElementSelect&&a.onElementSelect.element&&
a.onElementSelect.element.toLowerCase()===b[0].tagName.toLowerCase()&&(!a.onElementSelect.filter||a.onElementSelect.filter(b))&&(m=m||angular.isArray(a.onElementSelect.onlyWithAttrs)&&f(b,a.onElementSelect.onlyWithAttrs),a.onElementSelect.onlyWithAttrs&&!f(b,a.onElementSelect.onlyWithAttrs)||(k[c]=a))}),m?(angular.forEach(k,function(a,c){a.onElementSelect.onlyWithAttrs&&f(b,a.onElementSelect.onlyWithAttrs)&&g.push({name:c,tool:a})}),g.sort(function(a,c){return c.tool.onElementSelect.onlyWithAttrs.length-
a.tool.onElementSelect.onlyWithAttrs.length})):angular.forEach(k,function(a,c){g.push({name:c,tool:a})}),0<g.length)for(var n=0;n<g.length;n++){for(var q=g[n].tool,t=g[n].name,r=0;r<e[a].toolbarScopes.length;r++)if(void 0!==e[a].toolbarScopes[r].tools[t]){q.onElementSelect.action.call(e[a].toolbarScopes[r].tools[t],c,b,h);l=!0;break}if(l)break}return l}}},angular.forEach(g,function(c){l[c]&&e[a].toolbarScopes.push(l[c])}),b(),e[a].editorFunctions},retrieveEditor:function(a){return e[a]},unregisterEditor:function(a){delete e[a];
b()},registerToolbar:function(a){if(!a)throw"textAngular Error: A toolbar requires a scope";if(!a.name||""===a.name)throw"textAngular Error: A toolbar requires a name";if(l[a.name])throw'textAngular Error: A toolbar with name "'+a.name+'" already exists';l[a.name]=a;angular.forEach(e,function(c){c._registerToolbarScope(a)});b()},retrieveToolbar:function(a){return l[a]},retrieveToolbarsViaEditor:function(a){var c=[],b=this;return angular.forEach(this.retrieveEditor(a).toolbars,function(a){c.push(b.retrieveToolbar(a))}),
c},unregisterToolbar:function(a){delete l[a];b()},updateToolsDisplay:function(a){var c=this;angular.forEach(a,function(a,b){c.updateToolDisplay(b,a)})},resetToolsDisplay:function(){var a=this;angular.forEach(d,function(c,b){a.resetToolDisplay(b)});b()},updateToolDisplay:function(a,d){var c=this;angular.forEach(l,function(b,e){c.updateToolbarToolDisplay(e,a,d)});b()},resetToolDisplay:function(a){var c=this;angular.forEach(l,function(b,d){c.resetToolbarToolDisplay(d,a)});b()},updateToolbarToolDisplay:function(a,
b,d){if(!l[a])throw'textAngular Error: No Toolbar with name "'+a+'" exists';l[a].updateToolDisplay(b,d)},resetToolbarToolDisplay:function(a,b){if(!l[a])throw'textAngular Error: No Toolbar with name "'+a+'" exists';l[a].updateToolDisplay(b,d[b],!0)},removeTool:function(a){delete d[a];angular.forEach(l,function(c){delete c.tools[a];for(var b=0;b<c.toolbar.length;b++){for(var d,e=0;e<c.toolbar[b].length;e++){if(c.toolbar[b][e]===a){d={group:b,index:e};break}if(void 0!==d)break}void 0!==d&&(c.toolbar[d.group].slice(d.index,
1),c._$element.children().eq(d.group).children().eq(d.index).remove())}});b()},addTool:function(a,d,e,f){k(a,d);angular.forEach(l,function(c){c.addTool(a,d,e,f)});b()},addToolToToolbar:function(a,d,e,f,g){k(a,d);l[e].addTool(a,d,f,g);b()},refreshEditor:function(a){if(!e[a])throw'textAngular Error: No Editor with name "'+a+'" exists';e[a].scope.updateTaBindtaTextElement();e[a].scope.$$phase||e[a].scope.$digest();b()},sendKeyCommand:function(a,b){var c=e[a._name];if(c&&c.editorFunctions.sendKeyCommand(b))return a._bUpdateSelectedStyles||
a.updateSelectedStyles(),b.preventDefault(),!1},updateStyles:r,getVersion:function(){return"v1.5.12"},getToolbarScopes:function(){var a=[];return angular.forEach(e,function(c){a=a.concat(c.toolbarScopes)}),a}}}]),C.directive("textAngularToolbar",["$compile","textAngularManager","taOptions","taTools","taToolExecuteAction","$window",function(f,d,k,m,n,u){return{scope:{name:"@"},restrict:"EA",link:function(g,l,e){if(!g.name||""===g.name)throw"textAngular Error: A toolbar requires a name";angular.extend(g,
angular.copy(k));e.taToolbar&&(g.toolbar=g.$parent.$eval(e.taToolbar));e.taToolbarClass&&(g.classes.toolbar=e.taToolbarClass);e.taToolbarGroupClass&&(g.classes.toolbarGroup=e.taToolbarGroupClass);e.taToolbarButtonClass&&(g.classes.toolbarButton=e.taToolbarButtonClass);e.taToolbarActiveButtonClass&&(g.classes.toolbarButtonActive=e.taToolbarActiveButtonClass);e.taFocussedClass&&(g.classes.focussed=e.taFocussedClass);g.disabled=!0;g.focussed=!1;g._$element=l;l[0].innerHTML="";l.addClass("ta-toolbar "+
g.classes.toolbar);g.$watch("focussed",function(){g.focussed?l.addClass(g.classes.focussed):l.removeClass(g.classes.focussed)});var y=function(a,b){var c;if(c=a&&a.display?angular.element(a.display):angular.element("<button type='button'>"),a&&a.class?c.addClass(a.class):c.addClass(g.classes.toolbarButton),c.attr("name",b.name),c.attr("ta-button","ta-button"),c.attr("ng-disabled","isDisabled()"),c.attr("tabindex","-1"),c.attr("ng-click","executeAction()"),c.attr("ng-class","displayActiveToolClass(active)"),
a&&a.tooltiptext&&c.attr("title",a.tooltiptext),a&&!a.display&&!b._display&&(c[0].innerHTML="",a.buttontext&&(c[0].innerHTML=a.buttontext),a.iconclass)){var d=angular.element("<i>"),e=c[0].innerHTML;d.addClass(a.iconclass);c[0].innerHTML="";c.append(d);e&&""!==e&&c.append("&nbsp;"+e)}return b._lastToolDefinition=angular.copy(a),f(c)(b)};g.tools={};g._parent={disabled:!0,showHtml:!1,queryFormatBlockState:function(){return!1},queryCommandState:function(){return!1}};var r={$window:u,$editor:function(){return g._parent},
isDisabled:function(){return("html"!==this.name||!g._parent.startAction)&&("function"!=typeof this.$eval("disabled")&&this.$eval("disabled")||this.$eval("disabled()")||"html"!==this.name&&this.$editor().showHtml||this.$parent.disabled||this.$editor().disabled)},displayActiveToolClass:function(a){return a?g.classes.toolbarButtonActive:""},executeAction:n};angular.forEach(g.toolbar,function(a){var b=angular.element("<div>");b.addClass(g.classes.toolbarGroup);angular.forEach(a,function(a){g.tools[a]=
angular.extend(g.$new(!0),m[a],r,{name:a});g.tools[a].$element=y(m[a],g.tools[a]);b.append(g.tools[a].$element)});l.append(b)});g.updateToolDisplay=function(a,b,c){var d=g.tools[a];if(d){if(d._lastToolDefinition&&!c&&(b=angular.extend({},d._lastToolDefinition,b)),null===b.buttontext&&null===b.iconclass&&null===b.display)throw'textAngular Error: Tool Definition for updating "'+a+'" does not have a valid display/iconclass/buttontext value';null===b.buttontext&&delete b.buttontext;null===b.iconclass&&
delete b.iconclass;null===b.display&&delete b.display;a=y(b,d);d.$element.replaceWith(a);d.$element=a}};g.addTool=function(a,b,c,d){g.tools[a]=angular.extend(g.$new(!0),m[a],r,{name:a});g.tools[a].$element=y(m[a],g.tools[a]);void 0===c&&(c=g.toolbar.length-1);b=angular.element(l.children()[c]);void 0===d?(b.append(g.tools[a].$element),g.toolbar[c][g.toolbar[c].length-1]=a):(b.children().eq(d).after(g.tools[a].$element),g.toolbar[c][d]=a)};d.registerToolbar(g);g.$on("$destroy",function(){d.unregisterToolbar(g.name)})}}}]),
C.directive("textAngularVersion",["textAngularManager",function(f){var d=f.getVersion();return{restrict:"EA",link:function(f,m,n){m.html(d)}}}]),C.name});