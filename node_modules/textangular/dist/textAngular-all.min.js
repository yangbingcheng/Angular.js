/*
 AngularJS v1.3.10
 (c) 2010-2014 Google, Inc. http://angularjs.org
 License: MIT
*/
!function(p,v){"function"==typeof define&&define.amd?define(p):"undefined"!=typeof module&&"object"==typeof exports?module.exports=p():v.rangy=p()}(function(){function p(a,b){var c=typeof a[b];return c==Z||!(c!=r||!a[b])||"unknown"==c}function v(a,b){return!(typeof a[b]!=r||!a[b])}function C(a,b){return typeof a[b]!=e}function aa(a){return function(c,b){for(var d=b.length;d--;)if(!a(c,b[d]))return!1;return!0}}function G(a){return a&&y(a,R)&&m(a,k)}function O(a){return v(a,"body")?a.body:a.getElementsByTagName("body")[0]}
function P(a){typeof console!=e&&p(console,"log")&&console.log(a)}function M(c){a.initialized=!0;a.supported=!1;c="Rangy is not supported in this environment. Reason: "+c;B&&a.config.alertOnFail?alert(c):P(c)}function A(){if(B&&!a.initialized){var c,b=!1,d=!1;p(document,"createRange")&&(c=document.createRange(),y(c,h)&&m(c,f)&&(b=!0));var e=O(document);if(!e||"body"!=e.nodeName.toLowerCase())return void M("No body element found");if(e&&p(e,"createTextRange")&&(c=e.createTextRange(),G(c)&&(d=!0)),
!b&&!d)return void M("Neither Range nor TextRange are available");a.initialized=!0;a.features={implementsDomRange:b,implementsTextRange:d};var u,l;for(l in q)(u=q[l])instanceof J&&u.init(u,a);b=0;for(d=g.length;b<d;++b)try{g[b](a)}catch(ya){c="Rangy init listener threw an exception. Continuing. Detail: "+(ya.message||ya.description||String(ya)),P(c)}}}function Y(c,b,d){d&&(c+=" in module "+d.name);a.warn("DEPRECATED: "+c+" is deprecated. Please use "+b+" instead.")}function V(a,b,d,g){a[b]=function(){return Y(b,
d,g),a[d].apply(a,D.toArray(arguments))}}function W(a){a=a||window;A();for(var c=0,b=l.length;c<b;++c)l[c](a)}function J(a,b,d){this.name=a;this.dependencies=b;this.supported=this.initialized=!1;this.initializer=d}function S(c,b,d){b=new J(c,b,function(b){if(!b.initialized){b.initialized=!0;try{d(a,b),b.supported=!0}catch(u){P("Module '"+c+"' failed to load: "+(u.message||u.description||String(u))),u.stack&&P(u.stack)}}});return q[c]=b,b}function F(){}var r="object",Z="function",e="undefined",f="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),
h="setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "),k="boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),R="collapse compareEndPoints duplicate moveToElementText parentElement select setEndPoint getBoundingClientRect".split(" "),y=aa(p),n=aa(v),m=aa(C),q={},B=typeof window!=e&&
typeof document!=e,D={isHostMethod:p,isHostObject:v,isHostProperty:C,areHostMethods:y,areHostObjects:n,areHostProperties:m,isTextRange:G,getBody:O,forEach:[].forEach?function(a,b){a.forEach(b)}:function(a,b){for(var c=0,d=a.length;c<d;++c)b(a[c],c)}},a={version:"1.3.0",initialized:!1,isBrowser:B,supported:!0,util:D,features:{},modules:q,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==e||rangyAutoInitialize}};a.fail=M;a.warn=function(c){c="Rangy warning: "+
c;B&&a.config.alertOnWarn?alert(c):P(c)};var d;({}).hasOwnProperty?(D.extend=d=function(a,b,g){var c,e,w;for(w in b)b.hasOwnProperty(w)&&(c=a[w],e=b[w],g&&null!==c&&"object"==typeof c&&null!==e&&"object"==typeof e&&d(c,e,!0),a[w]=e);return b.hasOwnProperty("toString")&&(a.toString=b.toString),a},D.createOptions=function(a,b){var c={};return d(c,b),a&&d(c,a),c}):M("hasOwnProperty not supported");B||M("Rangy can only run in a browser");(function(){var a;if(B){var b=document.createElement("div");b.appendChild(document.createElement("span"));
var d=[].slice;try{1==d.call(b.childNodes,0)[0].nodeType&&(a=function(a){return d.call(a,0)})}catch(Oa){}}a||(a=function(a){for(var c=[],b=0,d=a.length;b<d;++b)c[b]=a[b];return c});D.toArray=a})();var b;B&&(p(document,"addEventListener")?b=function(a,b,d){a.addEventListener(b,d,!1)}:p(document,"attachEvent")?b=function(a,b,d){a.attachEvent("on"+b,d)}:M("Document does not have required addEventListener or attachEvent method"),D.addListener=b);var g=[];D.deprecationNotice=Y;D.createAliasForDeprecatedMethod=
V;a.init=A;a.addInitListener=function(b){a.initialized?b(a):g.push(b)};var l=[];a.addShimListener=function(a){l.push(a)};B&&(a.shim=a.createMissingNativeApi=W,V(a,"createMissingNativeApi","shim"));J.prototype={init:function(){for(var a,b,d=this.dependencies||[],g=0,e=d.length;g<e;++g){if(b=d[g],a=q[b],!(a&&a instanceof J))throw Error("required module '"+b+"' not found");if(a.init(),!a.supported)throw Error("required module '"+b+"' not supported");}this.initializer(this)},fail:function(a){throw this.initialized=
!0,this.supported=!1,Error(a);},warn:function(b){a.warn("Module "+this.name+": "+b)},deprecationNotice:function(b,d){a.warn("DEPRECATED: "+b+" in module "+this.name+" is deprecated. Please use "+d+" instead")},createError:function(a){return Error("Error in Rangy "+this.name+" module: "+a)}};a.createModule=function(b){var c,d;2==arguments.length?(c=arguments[1],d=[]):(c=arguments[2],d=arguments[1]);c=S(b,d,c);a.initialized&&a.supported&&c.init()};a.createCoreModule=function(a,b,d){S(a,b,d)};a.RangePrototype=
F;a.rangePrototype=new F;a.selectionPrototype=new function(){};a.createCoreModule("DomUtil",[],function(a,b){function c(a){for(var b=0;a=a.previousSibling;)++b;return b}function d(a,b){for(var c=[];a;a=a.parentNode)c.push(a);for(a=b;a;a=a.parentNode)if(ba(c,a))return a;return null}function g(a,b,c){for(b=c?b:b.parentNode;b;){if(b===a)return!0;b=b.parentNode}return!1}function e(a,b,c){var d;for(a=c?a:a.parentNode;a;){if(d=a.parentNode,d===b)return a;a=d}return null}function f(a){a=a.nodeType;return 3==
a||4==a||8==a}function q(a,b){var c=b.nextSibling;b=b.parentNode;return c?b.insertBefore(a,c):b.appendChild(a),a}function l(a){if(9==a.nodeType)return a;if(typeof a.ownerDocument!=B)return a.ownerDocument;if(typeof a.document!=B)return a.document;if(a.parentNode)return l(a.parentNode);throw b.createError("getDocument: no document found for node");}function m(a){a=l(a);if(typeof a.defaultView!=B)return a.defaultView;if(typeof a.parentWindow!=B)return a.parentWindow;throw b.createError("Cannot get a window object for node");
}function x(a){if(typeof a.contentDocument!=B)return a.contentDocument;if(typeof a.contentWindow!=B)return a.contentWindow.document;throw b.createError("getIframeDocument: No Document object found for iframe element");}function h(a){return a&&y.isHostMethod(a,"setTimeout")&&y.isHostObject(a,"document")}function n(a){return!1}function k(a){return a?f(a)?'"'+a.data+'"':1==a.nodeType?"<"+a.nodeName+(a.id?' id="'+a.id+'"':"")+">[index:"+c(a)+",length:"+a.childNodes.length+"]["+(a.innerHTML||"[innerHTML not supported]").slice(0,
25)+"]":a.nodeName:"[No node]"}function z(a){this._next=this.root=a}function D(a,b){this.node=a;this.offset=b}function ea(a){this.code=this[a];this.codeName=a;this.message="DOMException: "+this.codeName}var B="undefined",y=a.util,R=y.getBody;y.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||b.fail("document missing a Node creation method");y.isHostMethod(document,"getElementsByTagName")||b.fail("document missing getElementsByTagName method");var r=document.createElement("div");
y.areHostMethods(r,["insertBefore","appendChild","cloneNode"])||b.fail("Incomplete Element implementation");y.isHostProperty(r,"innerHTML")||b.fail("Element is missing innerHTML property");r=document.createTextNode("test");y.areHostMethods(r,["splitText","deleteData","insertData","appendData","cloneNode"])||b.fail("Incomplete Text Node implementation");var ba=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1},p=!1;!function(){var b=document.createElement("b");b.innerHTML="<br />";
p=!1;a.features.crashyTextNodes=p}();var K;typeof window.getComputedStyle!=B?K=function(a,b){return m(a).getComputedStyle(a,null)[b]}:typeof document.documentElement.currentStyle!=B?K=function(a,b){return a.currentStyle?a.currentStyle[b]:""}:b.fail("No means of obtaining computed style properties found");z.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var a,b=this._current=this._next;if(this._current){if(!(a=b.firstChild))for(a=null;b!==this.root&&!(a=b.nextSibling);)b=
b.parentNode;this._next=a}return this._current},detach:function(){this._current=this._next=this.root=null}};D.prototype={equals:function(a){return!!a&&this.node===a.node&&this.offset==a.offset},inspect:function(){return"[DomPosition("+k(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}};ea.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24};
ea.prototype.toString=function(){return this.message};a.dom={arrayContains:ba,isHtmlNamespace:function(a){var b;return typeof a.namespaceURI==B||null===(b=a.namespaceURI)||"http://www.w3.org/1999/xhtml"==b},parentElement:function(a){a=a.parentNode;return 1==a.nodeType?a:null},getNodeIndex:c,getNodeLength:function(a){switch(a.nodeType){case 7:case 10:return 0;case 3:case 8:return a.length;default:return a.childNodes.length}},getCommonAncestor:d,isAncestorOf:g,isOrIsAncestorOf:function(a,b){return g(a,
b,!0)},getClosestAncestorIn:e,isCharacterDataNode:f,isTextOrCommentNode:function(a){if(!a)return!1;a=a.nodeType;return 3==a||8==a},insertAfter:q,splitDataNode:function(a,b,d){var g=a.cloneNode(!1);if(g.deleteData(0,b),a.deleteData(b,a.length-b),q(g,a),d)for(var e,f=0;e=d[f++];)e.node==a&&e.offset>b?(e.node=g,e.offset-=b):e.node==a.parentNode&&e.offset>c(a)&&++e.offset;return g},getDocument:l,getWindow:m,getIframeWindow:function(a){if(typeof a.contentWindow!=B)return a.contentWindow;if(typeof a.contentDocument!=
B)return a.contentDocument.defaultView;throw b.createError("getIframeWindow: No Window object found for iframe element");},getIframeDocument:x,getBody:R,isWindow:h,getContentDocument:function(a,b,c){var d;if(a?y.isHostProperty(a,"nodeType")?d=1==a.nodeType&&"iframe"==a.tagName.toLowerCase()?x(a):l(a):h(a)&&(d=a.document):d=document,!d)throw b.createError(c+"(): Parameter must be a Window object or DOM node");return d},getRootContainer:function(a){for(var b;b=a.parentNode;)a=b;return a},comparePoints:function(a,
g,f,w){var q,l,u,m;if(a==f)return g===w?0:g<w?-1:1;if(q=e(f,a,!0))return g<=c(q)?-1:1;if(q=e(a,f,!0))return c(q)<w?-1:1;if(l=d(a,f),!l)throw Error("comparePoints error: nodes have no common ancestor");if(u=a===l?l:e(a,l,!0),m=f===l?l:e(f,l,!0),u===m)throw b.createError("comparePoints got to case 4 and childA and childB are the same!");for(a=l.firstChild;a;){if(a===u)return-1;if(a===m)return 1;a=a.nextSibling}},isBrokenNode:n,inspectNode:k,getComputedStyleProperty:K,createTestElement:function(a,b,
c){var d=R(a);a=a.createElement("div");a.contentEditable=""+!!c;b&&(a.innerHTML=b);b=d.firstChild;return b?d.insertBefore(a,b):d.appendChild(a),a},removeNode:function(a){return a.parentNode.removeChild(a)},fragmentFromNodeChildren:function(a){for(var b,c=l(a).createDocumentFragment();b=a.firstChild;)c.appendChild(b);return c},createIterator:function(a){return new z(a)},DomPosition:D};a.DOMException=ea});a.createCoreModule("DomRange",["DomUtil"],function(a,b){function c(a,b){return 3!=a.nodeType&&
(H(a,b.startContainer)||H(a,b.endContainer))}function d(a){return a.document||fa(a.startContainer)}function g(a){return new Q(a.parentNode,J(a))}function e(a){return new Q(a.parentNode,J(a)+1)}function f(a,b,c){var d=11==a.nodeType?a.firstChild:a;return L(b)?c==b.length?I.insertAfter(a,b):b.parentNode.insertBefore(a,0==c?b:ra(b,c)):c>=b.childNodes.length?b.appendChild(a):b.insertBefore(a,b.childNodes[c]),d}function l(a,b,c){if(K(a),K(b),d(b)!=d(a))throw new N("WRONG_DOCUMENT_ERR");var t=U(a.startContainer,
a.startOffset,b.endContainer,b.endOffset);a=U(a.endContainer,a.endOffset,b.startContainer,b.startOffset);return c?0>=t&&0<=a:0>t&&0<a}function q(a){for(var b,c,t,ja=d(a.range).createDocumentFragment();c=a.next();){if(b=a.isPartiallySelectedSubtree(),c=c.cloneNode(!b),b&&(t=a.getSubtreeIterator(),c.appendChild(q(t)),t.detach()),10==c.nodeType)throw new N("HIERARCHY_REQUEST_ERR");ja.appendChild(c)}return ja}function m(a,b,c){var d,t;c=c||{stop:!1};for(var ja;d=a.next();)if(a.isPartiallySelectedSubtree()){if(!1===
b(d))return void(c.stop=!0);if(ja=a.getSubtreeIterator(),m(ja,b,c),ja.detach(),c.stop)break}else for(d=I.createIterator(d);t=d.next();)if(!1===b(t))return void(c.stop=!0)}function x(a){for(var b;a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),x(b),b.detach()):a.remove()}function h(a){for(var b,c,t=d(a.range).createDocumentFragment();b=a.next();){if(a.isPartiallySelectedSubtree()?(b=b.cloneNode(!1),c=a.getSubtreeIterator(),b.appendChild(h(c)),c.detach()):a.remove(),10==b.nodeType)throw new N("HIERARCHY_REQUEST_ERR");
t.appendChild(b)}return t}function n(a,b,c){var d,t=!(!b||!b.length),ja=!!c;t&&(d=new RegExp("^("+b.join("|")+")$"));var g=[];return m(new z(a,!1),function(b){if(!(t&&!d.test(b.nodeType)||ja&&!c(b))){var e=a.startContainer;b==e&&L(e)&&a.startOffset==e.length||(e=a.endContainer,b==e&&L(e)&&0==a.endOffset||g.push(b))}}),g}function k(a){return"["+("undefined"==typeof a.getName?"Range":a.getName())+"("+I.inspectNode(a.startContainer)+":"+a.startOffset+", "+I.inspectNode(a.endContainer)+":"+a.endOffset+
")]"}function z(a,b){(this.range=a,this.clonePartiallySelectedTextNodes=b,a.collapsed)||(this.sc=a.startContainer,this.so=a.startOffset,this.ec=a.endContainer,this.eo=a.endOffset,a=a.commonAncestorContainer,this.sc===this.ec&&L(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==a||L(this.sc)?la(this.sc,a,!0):this.sc.childNodes[this.so],this._last=this.ec!==a||L(this.ec)?la(this.ec,a,!0):this.ec.childNodes[this.eo-1]))}function D(a){return function(b,
c){var d;for(b=c?b:b.parentNode;b;){if(d=b.nodeType,oa(a,d))return b;b=b.parentNode}return null}}function B(a,b){if(Ma(a,b))throw new N("INVALID_NODE_TYPE_ERR");}function y(a,b){if(!oa(b,a.nodeType))throw new N("INVALID_NODE_TYPE_ERR");}function R(a,b){if(0>b||b>(L(a)?a.length:a.childNodes.length))throw new N("INDEX_SIZE_ERR");}function r(a,b){if(ma(a,!0)!==ma(b,!0))throw new N("WRONG_DOCUMENT_ERR");}function p(a){if(t(a,!0))throw new N("NO_MODIFICATION_ALLOWED_ERR");}function ba(a,b){return b<=(L(a)?
a.length:a.childNodes.length)}function Z(a){return!!a.startContainer&&!!a.endContainer&&!(ga&&(I.isBrokenNode(a.startContainer)||I.isBrokenNode(a.endContainer)))&&E(a.startContainer)==E(a.endContainer)&&ba(a.startContainer,a.startOffset)&&ba(a.endContainer,a.endOffset)}function K(a){if(!Z(a))throw Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+a.inspect()+")");}function da(a,b){K(a);var c=a.startContainer,d=a.startOffset,t=a.endContainer,g=a.endOffset,e=
c===t;L(t)&&0<g&&g<t.length&&ra(t,g,b);L(c)&&0<d&&d<c.length&&(c=ra(c,d,b),e?(g-=d,t=c):t==c.parentNode&&g>=J(c)&&g++,d=0);a.setStartAndEnd(c,d,t,g)}function v(a){K(a);var b=a.commonAncestorContainer.parentNode.cloneNode(!1);return b.appendChild(a.cloneContents()),b.innerHTML}function C(a){a.START_TO_START=Da;a.START_TO_END=Ga;a.END_TO_END=V;a.END_TO_START=Y;a.NODE_BEFORE=W;a.NODE_AFTER=S;a.NODE_BEFORE_AND_AFTER=Ha;a.NODE_INSIDE=Ea}function G(a){C(a);C(a.prototype)}function F(a,b){return function(){K(this);
var c,d,t=this.startContainer,g=this.startOffset,H=this.commonAncestorContainer,f=new z(this,!0);t!==H&&(c=la(t,H,!0),d=e(c),t=d.node,g=d.offset);m(f,p);f.reset();c=a(f);return f.detach(),b(this,t,g,t,g),c}}function O(b,d){function t(a,b){return function(c){y(c,na);y(E(c),P);c=(a?g:e)(c);(b?H:f)(this,c.node,c.offset)}}function H(a,b,c){var t=a.endContainer,g=a.endOffset;b===a.startContainer&&c===a.startOffset||(E(b)==E(t)&&1!=U(b,c,t,g)||(t=b,g=c),d(a,b,c,t,g))}function f(a,b,c){var t=a.startContainer,
g=a.startOffset;b===a.endContainer&&c===a.endOffset||(E(b)==E(t)&&-1!=U(b,c,t,g)||(t=b,g=c),d(a,t,g,b,c))}var l=function(){};l.prototype=a.rangePrototype;b.prototype=new l;M.extend(b.prototype,{setStart:function(a,b){B(a,!0);R(a,b);H(this,a,b)},setEnd:function(a,b){B(a,!0);R(a,b);f(this,a,b)},setStartAndEnd:function(){var a=arguments,b=a[0],c=a[1],t=b,g=c;switch(a.length){case 3:g=a[2];break;case 4:t=a[2],g=a[3]}d(this,b,c,t,g)},setBoundary:function(a,b,c){this["set"+(c?"Start":"End")](a,b)},setStartBefore:t(!0,
!0),setStartAfter:t(!1,!0),setEndBefore:t(!0,!1),setEndAfter:t(!1,!1),collapse:function(a){K(this);a?d(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):d(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){B(a,!0);d(this,a,0,a,sa(a))},selectNode:function(a){B(a,!1);y(a,na);var b=g(a);a=e(a);d(this,b.node,b.offset,a.node,a.offset)},extractContents:F(h,d),deleteContents:F(x,d),canSurroundContents:function(){K(this);p(this.startContainer);
p(this.endContainer);var a=new z(this,!0),b=a._first&&c(a._first,this)||a._last&&c(a._last,this);return a.detach(),!b},splitBoundaries:function(){da(this)},splitBoundariesPreservingPositions:function(a){da(this,a)},normalizeBoundaries:function(){K(this);var a,b=this.startContainer,c=this.startOffset,t=this.endContainer,g=this.endOffset,e=function(a){var b=a.nextSibling;b&&b.nodeType==a.nodeType&&(t=a,g=a.length,a.appendData(b.data),ha(b))},H=function(a){var d=a.previousSibling;if(d&&d.nodeType==a.nodeType){b=
a;var e=a.length;(c=d.length,a.insertData(0,d.data),ha(d),b==t)?(g+=c,t=b):t==a.parentNode&&(d=J(a),g==d?(t=a,g=e):g>d&&g--)}},f=!0;L(t)?g==t.length?e(t):0==g&&(a=t.previousSibling,a&&a.nodeType==t.nodeType&&(g=a.length,b==t&&(f=!1),a.appendData(t.data),ha(t),t=a)):(0<g&&(f=t.childNodes[g-1])&&L(f)&&e(f),f=!this.collapsed);f?L(b)?0==c?H(b):c==b.length&&(a=b.nextSibling,a&&a.nodeType==b.nodeType&&(t==a&&(t=b,g+=b.length),b.appendData(a.data),ha(a))):c<b.childNodes.length&&(a=b.childNodes[c])&&L(a)&&
H(a):(b=t,c=g);d(this,b,c,t,g)},collapseToPoint:function(a,b){B(a,!0);R(a,b);this.setStartAndEnd(a,b)}});G(b)}function A(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset;a.commonAncestorContainer=a.collapsed?a.startContainer:I.getCommonAncestor(a.startContainer,a.endContainer)}function T(a,b,c,t,d){a.startContainer=b;a.startOffset=c;a.endContainer=t;a.endOffset=d;a.document=I.getDocument(b);A(a)}function X(a){this.startContainer=a;this.startOffset=0;this.endContainer=
a;this.endOffset=0;this.document=a;A(this)}var I=a.dom,M=a.util,Q=I.DomPosition,N=a.DOMException,L=I.isCharacterDataNode,J=I.getNodeIndex,H=I.isOrIsAncestorOf,fa=I.getDocument,U=I.comparePoints,ra=I.splitDataNode,la=I.getClosestAncestorIn,sa=I.getNodeLength,oa=I.arrayContains,E=I.getRootContainer,ga=a.features.crashyTextNodes,ha=I.removeNode;z.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},
next:function(){var a=this._current=this._next;return a&&(this._next=a!==this._last?a.nextSibling:null,L(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so))),a},remove:function(){var a,b,c=this._current;!L(c)||c!==this.sc&&c!==this.ec?c.parentNode&&ha(c):(a=c===this.sc?this.so:0,b=c===this.ec?this.eo:c.length,a!=b&&c.deleteData(a,b-a))},isPartiallySelectedSubtree:function(){return c(this._current,
this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse(!1);else{a=new X(d(this.range));var b=this._current,c=b,t=0,g=b,e=sa(b);H(b,this.sc)&&(c=this.sc,t=this.so);H(b,this.ec)&&(g=this.ec,e=this.eo);T(a,c,t,g,e)}return new z(a,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var na=[1,3,4,5,7,8,10],P=[2,9,11],aa=[1,3,4,5,7,8,10,
11],wa=[1,3,4,5,7,8],ma=D([9,11]),t=D([5,6,10,12]),Ma=D([6,10,12]);b=document.createElement("style");var ua=!1;try{b.innerHTML="<b>x</b>",ua=3==b.firstChild.nodeType}catch(ja){}a.features.htmlParsingConforms=ua;var xa="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),Da=0,Ga=1,V=2,Y=3,W=0,S=1,Ha=2,Ea=3;M.extend(a.rangePrototype,{compareBoundaryPoints:function(a,b){K(this);r(this.startContainer,b.startContainer);var c,t,d,g,e=a==Y||a==Da?"start":"end";
a=a==Ga||a==Da?"start":"end";return c=this[e+"Container"],t=this[e+"Offset"],d=b[a+"Container"],g=b[a+"Offset"],U(c,t,d,g)},insertNode:function(a){if(K(this),y(a,aa),p(this.startContainer),H(a,this.startContainer))throw new N("HIERARCHY_REQUEST_ERR");a=f(a,this.startContainer,this.startOffset);this.setStartBefore(a)},cloneContents:function(){K(this);var a,b;if(this.collapsed)return d(this).createDocumentFragment();if(this.startContainer===this.endContainer&&L(this.startContainer))return a=this.startContainer.cloneNode(!0),
a.data=a.data.slice(this.startOffset,this.endOffset),b=d(this).createDocumentFragment(),b.appendChild(a),b;b=new z(this,!0);return a=q(b),b.detach(),a},canSurroundContents:function(){K(this);p(this.startContainer);p(this.endContainer);var a=new z(this,!0),b=a._first&&c(a._first,this)||a._last&&c(a._last,this);return a.detach(),!b},surroundContents:function(a){if(y(a,wa),!this.canSurroundContents())throw new N("INVALID_STATE_ERR");var b=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);
f(a,this.startContainer,this.startOffset);a.appendChild(b);this.selectNode(a)},cloneRange:function(){K(this);for(var a,b=new X(d(this)),c=xa.length;c--;)a=xa[c],b[a]=this[a];return b},toString:function(){K(this);var a=this.startContainer;if(a===this.endContainer&&L(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[],a=new z(this,!0);return m(a,function(a){3!=a.nodeType&&4!=a.nodeType||b.push(a.data)}),a.detach(),b.join("")},compareNode:function(a){K(this);
var b=a.parentNode,c=J(a);if(!b)throw new N("NOT_FOUND_ERR");a=this.comparePoint(b,c);b=this.comparePoint(b,c+1);return 0>a?0<b?Ha:W:0<b?S:Ea},comparePoint:function(a,b){K(this);if(!a)throw new N("HIERARCHY_REQUEST_ERR");return r(a,this.startContainer),0>U(a,b,this.startContainer,this.startOffset)?-1:0<U(a,b,this.endContainer,this.endOffset)?1:0},createContextualFragment:ua?function(a){var b=this.startContainer,c=fa(b);if(!b)throw new N("INVALID_STATE_ERR");var t=null;return 1==b.nodeType?t=b:L(b)&&
(t=I.parentElement(b)),t=null===t||"HTML"==t.nodeName&&I.isHtmlNamespace(fa(t).documentElement)&&I.isHtmlNamespace(t)?c.createElement("body"):t.cloneNode(!1),t.innerHTML=a,I.fragmentFromNodeChildren(t)}:function(a){var b=d(this).createElement("body");return b.innerHTML=a,I.fragmentFromNodeChildren(b)},toHtml:function(){return v(this)},intersectsNode:function(a,b){if(K(this),E(a)!=E(this.startContainer))return!1;var c=a.parentNode,t=J(a);if(!c)return!0;a=U(c,t,this.endContainer,this.endOffset);c=U(c,
t+1,this.startContainer,this.startOffset);return b?0>=a&&0<=c:0>a&&0<c},isPointInRange:function(a,b){K(this);if(!a)throw new N("HIERARCHY_REQUEST_ERR");return r(a,this.startContainer),0<=U(a,b,this.startContainer,this.startOffset)&&0>=U(a,b,this.endContainer,this.endOffset)},intersectsRange:function(a){return l(this,a,!1)},intersectsOrTouchesRange:function(a){return l(this,a,!0)},intersection:function(a){if(this.intersectsRange(a)){var b=U(this.startContainer,this.startOffset,a.startContainer,a.startOffset),
c=U(this.endContainer,this.endOffset,a.endContainer,a.endOffset),t=this.cloneRange();return-1==b&&t.setStart(a.startContainer,a.startOffset),1==c&&t.setEnd(a.endContainer,a.endOffset),t}return null},union:function(a){if(this.intersectsOrTouchesRange(a)){var b=this.cloneRange();return-1==U(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&b.setStart(a.startContainer,a.startOffset),1==U(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset),
b}throw new N("Ranges do not intersect");},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==Ea},containsNodeContents:function(a){return 0<=this.comparePoint(a,0)&&0>=this.comparePoint(a,sa(a))},containsRange:function(a){var b=this.intersection(a);return null!==b&&a.equals(b)},containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var c=b.getNodes([3]);return 0<c.length?(b.setStart(c[0],0),a=c.pop(),b.setEnd(a,a.length),this.containsRange(b)):this.containsNodeContents(a)},
getNodes:function(a,b){return K(this),n(this,a,b)},getDocument:function(){return d(this)},collapseBefore:function(a){this.setEndBefore(a);this.collapse(!1)},collapseAfter:function(a){this.setStartAfter(a);this.collapse(!0)},getBookmark:function(b){var c=d(this),t=a.createRange(c);b=b||I.getBody(c);t.selectNodeContents(b);var c=this.intersection(t),g=0,e=0;return c&&(t.setEnd(c.startContainer,c.startOffset),g=t.toString().length,e=g+c.toString().length),{start:g,end:e,containerNode:b}},moveToBookmark:function(a){var b=
a.containerNode,c=0;this.setStart(b,0);this.collapse(!0);for(var t,d,g,b=[b],e=!1,H=!1;!H&&(t=b.pop());)if(3==t.nodeType)d=c+t.length,!e&&a.start>=c&&a.start<=d&&(this.setStart(t,a.start-c),e=!0),e&&a.end>=c&&a.end<=d&&(this.setEnd(t,a.end-c),H=!0),c=d;else for(g=t.childNodes,d=g.length;d--;)b.push(g[d])},getName:function(){return"DomRange"},equals:function(a){return X.rangesEqual(this,a)},isValid:function(){return Z(this)},inspect:function(){return k(this)},detach:function(){}});O(X,T);M.extend(X,
{rangeProperties:xa,RangeIterator:z,copyComparisonConstants:G,createPrototypeRange:O,inspect:k,toHtml:v,getRangeDocument:d,rangesEqual:function(a,b){return a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset}});a.DomRange=X});a.createCoreModule("WrappedRange",["DomRange"],function(a,b){var c,d,g=a.dom,e=a.util,f=g.DomPosition,l=a.DomRange,q=g.getBody,m=g.getContentDocument,x=g.isCharacterDataNode;if(a.features.implementsDomRange&&
!function(){function d(a){for(var b,c=u.length;c--;)b=u[c],a[b]=a.nativeRange[b];a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset}var f,w,u=l.rangeProperties;c=function(a){if(!a)throw b.createError("WrappedRange: Range must be specified");this.nativeRange=a;d(this)};l.createPrototypeRange(c,function(a,b,c,d,g){var e=a.startContainer!==b||a.startOffset!=c,f=a.endContainer!==d||a.endOffset!=g,l=!a.equals(a.nativeRange);(e||f||l)&&(a.setEnd(d,g),a.setStart(b,c))});f=c.prototype;
f.selectNode=function(a){this.nativeRange.selectNode(a);d(this)};f.cloneContents=function(){return this.nativeRange.cloneContents()};f.surroundContents=function(a){this.nativeRange.surroundContents(a);d(this)};f.collapse=function(a){this.nativeRange.collapse(a);d(this)};f.cloneRange=function(){return new c(this.nativeRange.cloneRange())};f.refresh=function(){d(this)};f.toString=function(){return this.nativeRange.toString()};var x=document.createTextNode("test");q(document).appendChild(x);var h=document.createRange();
h.setStart(x,0);h.setEnd(x,0);try{h.setStart(x,1),f.setStart=function(a,b){this.nativeRange.setStart(a,b);d(this)},f.setEnd=function(a,b){this.nativeRange.setEnd(a,b);d(this)},w=function(a){return function(b){this.nativeRange[a](b);d(this)}}}catch(K){f.setStart=function(a,b){try{this.nativeRange.setStart(a,b)}catch(za){this.nativeRange.setEnd(a,b),this.nativeRange.setStart(a,b)}d(this)},f.setEnd=function(a,b){try{this.nativeRange.setEnd(a,b)}catch(za){this.nativeRange.setStart(a,b),this.nativeRange.setEnd(a,
b)}d(this)},w=function(a,b){return function(c){try{this.nativeRange[a](c)}catch(Aa){this.nativeRange[b](c),this.nativeRange[a](c)}d(this)}}}f.setStartBefore=w("setStartBefore","setEndBefore");f.setStartAfter=w("setStartAfter","setEndAfter");f.setEndBefore=w("setEndBefore","setStartBefore");f.setEndAfter=w("setEndAfter","setStartAfter");f.selectNodeContents=function(a){this.setStartAndEnd(a,0,g.getNodeLength(a))};h.selectNodeContents(x);h.setEnd(x,3);w=document.createRange();w.selectNodeContents(x);
w.setEnd(x,4);w.setStart(x,2);-1==h.compareBoundaryPoints(h.START_TO_END,w)&&1==h.compareBoundaryPoints(h.END_TO_START,w)?f.compareBoundaryPoints=function(a,b){return b=b.nativeRange||b,a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END),this.nativeRange.compareBoundaryPoints(a,b)}:f.compareBoundaryPoints=function(a,b){return this.nativeRange.compareBoundaryPoints(a,b.nativeRange||b)};w=document.createElement("div");w.innerHTML="123";var n=w.firstChild,k=q(document);k.appendChild(w);
h.setStart(n,1);h.setEnd(n,2);h.deleteContents();"13"==n.data&&(f.deleteContents=function(){this.nativeRange.deleteContents();d(this)},f.extractContents=function(){var a=this.nativeRange.extractContents();return d(this),a});k.removeChild(w);k=null;e.isHostMethod(h,"createContextualFragment")&&(f.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)});q(document).removeChild(x);f.getName=function(){return"WrappedRange"};a.WrappedRange=c;a.createNativeRange=function(a){return a=
m(a,b,"createNativeRange"),a.createRange()}}(),a.features.implementsTextRange){var h=function(a,b,c,d,e){var l=a.duplicate();l.collapse(c);var w=l.parentElement();if(g.isOrIsAncestorOf(b,w)||(w=b),!w.canHaveHTML)return w=new f(w.parentNode,g.getNodeIndex(w)),{boundaryPosition:w,nodeInfo:{nodeIndex:w.offset,containerElement:w.node}};b=g.getDocument(w).createElement("span");b.parentNode&&g.removeNode(b);var q,m,h=c?"StartToStart":"StartToEnd",u=e&&e.containerElement==w?e.nodeIndex:0,n=w.childNodes.length,
k=n;for(e=k;e==n?w.appendChild(b):w.insertBefore(b,w.childNodes[e]),l.moveToElementText(b),q=l.compareEndPoints(h,a),0!=q&&u!=k;){if(-1==q){if(k==u+1)break;u=e}else k=k==u+1?u:e;e=Math.floor((u+k)/2);w.removeChild(b)}if(m=b.nextSibling,-1==q&&m&&x(m)){l.setEndPoint(c?"EndToStart":"EndToEnd",a);if(/[\r\n]/.test(m.data))for(c=l.duplicate(),d=c.text.replace(/\r\n/g,"\r").length,d=c.moveStart("character",d);-1==c.compareEndPoints("StartToEnd",c);)d++,c.moveStart("character",1);else d=l.text.length;m=
new f(m,d)}else m=(d||!c)&&b.previousSibling,m=(c=(d||c)&&b.nextSibling)&&x(c)?new f(c,0):m&&x(m)?new f(m,m.data.length):new f(w,g.getNodeIndex(b));return g.removeNode(b),{boundaryPosition:m,nodeInfo:{nodeIndex:e,containerElement:w}}},n=function(a,b){var c,d,e,f,w=a.offset,l=g.getDocument(a.node),m=q(l).createTextRange(),u=x(a.node);return u?(c=a.node,d=c.parentNode):(f=a.node.childNodes,c=w<f.length?f[w]:null,d=a.node),e=l.createElement("span"),e.innerHTML="&#feff;",c?d.insertBefore(e,c):d.appendChild(e),
m.moveToElementText(e),m.collapse(!b),d.removeChild(e),u&&m[b?"moveStart":"moveEnd"]("character",w),m};d=function(a){this.textRange=a;this.refresh()};d.prototype=new l(document);d.prototype.refresh=function(){var a,b,c,d,e=this.textRange;d=e.parentElement();var f=e.duplicate();f.collapse(!0);var w=f.parentElement(),f=e.duplicate();f.collapse(!1);e=f.parentElement();w=w==e?w:g.getCommonAncestor(w,e);d=w==d?w:g.getCommonAncestor(d,w);w=this.textRange;0==w.compareEndPoints("StartToEnd",w)?b=a=h(this.textRange,
d,!0,!0).boundaryPosition:(c=h(this.textRange,d,!0,!1),a=c.boundaryPosition,b=h(this.textRange,d,!1,!1,c.nodeInfo).boundaryPosition);this.setStart(a.node,a.offset);this.setEnd(b.node,b.offset)};d.prototype.getName=function(){return"WrappedTextRange"};l.copyComparisonConstants(d);var k=function(a){if(a.collapsed)return n(new f(a.startContainer,a.startOffset),!0);var b=n(new f(a.startContainer,a.startOffset),!0),c=n(new f(a.endContainer,a.endOffset),!1);a=q(l.getRangeDocument(a)).createTextRange();
return a.setEndPoint("StartToStart",b),a.setEndPoint("EndToEnd",c),a};if(d.rangeToTextRange=k,d.prototype.toTextRange=function(){return k(this)},a.WrappedTextRange=d,!a.features.implementsDomRange||a.config.preferTextRange){var z=Function("return this;")();"undefined"==typeof z.Range&&(z.Range=d);a.createNativeRange=function(a){return a=m(a,b,"createNativeRange"),q(a).createTextRange()};a.WrappedRange=d}}a.createRange=function(c){return c=m(c,b,"createRange"),new a.WrappedRange(a.createNativeRange(c))};
a.createRangyRange=function(a){return a=m(a,b,"createRangyRange"),new l(a)};e.createAliasForDeprecatedMethod(a,"createIframeRange","createRange");e.createAliasForDeprecatedMethod(a,"createIframeRangyRange","createRangyRange");a.addShimListener(function(b){var c=b.document;"undefined"==typeof c.createRange&&(c.createRange=function(){return a.createRange(c)});c=b=null})});a.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(a,b){function c(a){return"string"==typeof a?/^backward(s)?$/i.test(a):
!!a}function d(a,c){if(a){if(C.isWindow(a))return a;if(a instanceof D)return a.win;a=C.getContentDocument(a,b,c);return C.getWindow(a)}return window}function g(a){return d(a,"getWinSelection").getSelection()}function e(a){return d(a,"getDocSelection").document.selection}function f(a){var b=!1;return a.anchorNode&&(b=1==C.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)),b}function l(a,b,c){var d=c?"end":"start";c=c?"start":"end";a.anchorNode=b[d+"Container"];a.anchorOffset=b[d+
"Offset"];a.focusNode=b[c+"Container"];a.focusOffset=b[c+"Offset"]}function q(a){a.anchorNode=a.focusNode=null;a.anchorOffset=a.focusOffset=0;a.rangeCount=0;a.isCollapsed=!0;a._ranges.length=0}function m(b){var c;return b instanceof J?(c=a.createNativeRange(b.getDocument()),c.setEnd(b.endContainer,b.endOffset),c.setStart(b.startContainer,b.startOffset)):b instanceof O?c=b.nativeRange:T.implementsDomRange&&b instanceof C.getWindow(b.startContainer).Range&&(c=b),c}function h(a){var c=a.getNodes(),d;
a:if(c.length&&1==c[0].nodeType){d=1;for(var t=c.length;d<t;++d)if(!C.isAncestorOf(c[0],c[d])){d=!1;break a}d=!0}else d=!1;if(!d)throw b.createError("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return c[0]}function n(a){return!!a&&"undefined"!=typeof a.text}function x(a,b){b=new O(b);a._ranges=[b];l(a,b,!1);a.rangeCount=1;a.isCollapsed=b.collapsed}function k(b){if(b._ranges.length=0,"None"==b.docSelection.type)q(b);else{var c=b.docSelection.createRange();
if(n(c))x(b,c);else{b.rangeCount=c.length;for(var d,t=X(c.item(0)),g=0;g<b.rangeCount;++g)d=a.createRange(t),d.selectNode(c.item(g)),b._ranges.push(d);b.isCollapsed=1==b.rangeCount&&b._ranges[0].collapsed;l(b,b._ranges[b.rangeCount-1],!1)}}}function z(a,c){var d=a.docSelection.createRange();c=h(c);for(var t=X(d.item(0)),t=I(t).createControlRange(),g=0,e=d.length;g<e;++g)t.add(d.item(g));try{t.add(c)}catch(Na){throw b.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");
}t.select();k(a)}function D(a,b,c){this.nativeSelection=a;this.docSelection=b;this._ranges=[];this.win=c;this.refresh()}function B(a){a.win=a.anchorNode=a.focusNode=a._ranges=null;a.rangeCount=a.anchorOffset=a.focusOffset=0;a.detached=!0}function y(a,b){for(var c,d,g=na.length;g--;)if(c=na[g],d=c.selection,"deleteAll"==b)B(d);else if(c.win==a)return"delete"==b?(na.splice(g,1),!0):d;return"deleteAll"==b&&(na.length=0),null}function R(a,c){var d;d=X(c[0].startContainer);for(var g=I(d).createControlRange(),
t=0,e=c.length;t<e;++t){d=h(c[t]);try{g.add(d)}catch(Na){throw b.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)");}}g.select();k(a)}function r(a,b){if(a.win.document!=X(b))throw new M("WRONG_DOCUMENT_ERR");}function p(b){return function(c,d){var g;this.rangeCount?(g=this.getRangeAt(0),g["set"+(b?"Start":"End")](c,d)):(g=a.createRange(this.win.document),g.setStartAndEnd(c,d));this.setSingleRange(g,this.isBackward())}}
function Z(a){var b=[],c=new A(a.anchorNode,a.anchorOffset),d=new A(a.focusNode,a.focusOffset),g="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var t=0,e=a.rangeCount;t<e;++t)b[t]=J.inspect(a.getRangeAt(t));return"["+g+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+d.inspect()+"]"}a.config.checkSelectionRanges=!0;var v,K,C=a.dom,G=a.util,F=G.isHostMethod,J=a.DomRange,O=a.WrappedRange,M=a.DOMException,A=C.DomPosition,T=a.features,X=C.getDocument,
I=C.getBody,P=J.rangesEqual,Q=F(window,"getSelection"),N=G.isHostObject(document,"selection");T.implementsWinGetSelection=Q;var L=(T.implementsDocSelection=N)&&(!Q||a.config.preferTextRange);if(L)v=e,a.isSelectionValid=function(a){a=d(a,"isSelectionValid").document;var b=a.selection;return"None"!=b.type||X(b.createRange().parentElement())==a};else{if(!Q)return b.fail("Neither document.selection or window.getSelection() detected."),!1;v=g;a.isSelectionValid=function(){return!0}}a.getNativeSelection=
v;Q=v();if(!Q)return b.fail("Native selection was null (possibly issue 138?)"),!1;var aa=a.createNativeRange(document),H=I(document),fa=G.areHostProperties(Q,["anchorNode","focusNode","anchorOffset","focusOffset"]);T.selectionHasAnchorAndFocus=fa;var U=F(Q,"extend");T.selectionHasExtend=U;var ra="number"==typeof Q.rangeCount;T.selectionHasRangeCount=ra;var la=!1,sa=!0,oa=U?function(b,c){var d=J.getRangeDocument(c),d=a.createRange(d);d.collapseToPoint(c.endContainer,c.endOffset);b.addRange(m(d));b.extend(c.startContainer,
c.startOffset)}:null;G.areHostMethods(Q,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof Q.rangeCount&&T.implementsDomRange&&!function(){var b=window.getSelection();if(b){for(var c=b.rangeCount,d=1<c,g=[],e=f(b),H=0;H<c;++H)g[H]=b.getRangeAt(H);var H=C.createTestElement(document,"",!1),w=H.appendChild(document.createTextNode("???")),l=document.createRange();(l.setStart(w,1),l.collapse(!0),b.removeAllRanges(),b.addRange(l),sa=1==b.rangeCount,b.removeAllRanges(),d)||((d=window.navigator.appVersion.match(/Chrome\/(.*?) /))&&
36<=parseInt(d[1])?la=!1:(d=l.cloneRange(),l.setStart(w,0),d.setEnd(w,3),d.setStart(w,2),b.addRange(l),b.addRange(d),la=2==b.rangeCount));C.removeNode(H);b.removeAllRanges();for(H=0;H<c;++H)0==H&&e?oa?oa(b,g[H]):(a.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),b.addRange(g[H])):b.addRange(g[H])}}();T.selectionSupportsMultipleRanges=la;T.collapsedNonEditableSelectionsSupported=sa;var E,ga=
!1;H&&F(H,"createControlRange")&&(E=H.createControlRange(),G.areHostProperties(E,["item","add"])&&(ga=!0));T.implementsControlRange=ga;K=fa?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return!!a.rangeCount&&a.getRangeAt(a.rangeCount-1).collapsed};var ha;F(Q,"getRangeAt")?ha=function(a,b){try{return a.getRangeAt(b)}catch(ua){return null}}:fa&&(ha=function(b){var c=X(b.anchorNode),c=a.createRange(c);return c.setStartAndEnd(b.anchorNode,b.anchorOffset,b.focusNode,
b.focusOffset),c.collapsed!==this.isCollapsed&&c.setStartAndEnd(b.focusNode,b.focusOffset,b.anchorNode,b.anchorOffset),c});D.prototype=a.selectionPrototype;var na=[],Y=function(a){if(a&&a instanceof D)return a.refresh(),a;a=d(a,"getNativeSelection");var b=y(a),c=v(a),g=N?e(a):null;return b?(b.nativeSelection=c,b.docSelection=g,b.refresh()):(b=new D(c,g,a),na.push({win:a,selection:b})),b};a.getSelection=Y;G.createAliasForDeprecatedMethod(a,"getIframeSelection","getSelection");E=D.prototype;if(!L&&
fa&&G.areHostMethods(Q,["removeAllRanges","addRange"]))E.removeAllRanges=function(){this.nativeSelection.removeAllRanges();q(this)},ra?E.addRange=function(b,d){if(ga&&N&&"Control"==this.docSelection.type)z(this,b);else if(c(d)&&U)oa(this.nativeSelection,b),this.refresh();else{var g;la?g=this.rangeCount:(this.removeAllRanges(),g=0);d=m(b).cloneRange();try{this.nativeSelection.addRange(d)}catch(xa){}(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==g+1)?(a.config.checkSelectionRanges&&
(g=ha(this.nativeSelection,this.rangeCount-1))&&!P(g,b)&&(b=new O(g)),this._ranges[this.rangeCount-1]=b,l(this,b,ma(this.nativeSelection)),this.isCollapsed=K(this)):this.refresh()}}:E.addRange=function(a,b){c(b)&&U?oa(this.nativeSelection,a):this.nativeSelection.addRange(m(a));this.refresh()},E.setRanges=function(a){if(ga&&N&&1<a.length)R(this,a);else{this.removeAllRanges();for(var b=0,c=a.length;b<c;++b)this.addRange(a[b])}};else{if(!(F(Q,"empty")&&F(aa,"select")&&ga&&L))return b.fail("No means of selecting a Range or TextRange was found"),
!1;E.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var a;if(this.anchorNode)a=X(this.anchorNode);else if("Control"==this.docSelection.type){var b=this.docSelection.createRange();b.length&&(a=X(b.item(0)))}a&&(I(a).createTextRange().select(),this.docSelection.empty())}}catch(ua){}q(this)};E.addRange=function(b){"Control"==this.docSelection.type?z(this,b):(a.WrappedTextRange.rangeToTextRange(b).select(),this._ranges[0]=b,this.rangeCount=1,this.isCollapsed=
this._ranges[0].collapsed,l(this,b,!1))};E.setRanges=function(a){this.removeAllRanges();var b=a.length;1<b?R(this,a):b&&this.addRange(a[0])}}E.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new M("INDEX_SIZE_ERR");return this._ranges[a].cloneRange()};var V;if(L)V=function(b){var c;a.isSelectionValid(b.win)?c=b.docSelection.createRange():(c=I(b.win.document).createTextRange(),c.collapse(!0));"Control"==b.docSelection.type?k(b):n(c)?x(b,c):q(b)};else if(F(Q,"getRangeAt")&&"number"==typeof Q.rangeCount)V=
function(b){if(ga&&N&&"Control"==b.docSelection.type)k(b);else if(b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount,b.rangeCount){for(var c=0,d=b.rangeCount;c<d;++c)b._ranges[c]=new a.WrappedRange(b.nativeSelection.getRangeAt(c));l(b,b._ranges[b.rangeCount-1],ma(b.nativeSelection));b.isCollapsed=K(b)}else q(b)};else{if(!fa||"boolean"!=typeof Q.isCollapsed||"boolean"!=typeof aa.collapsed||!T.implementsDomRange)return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"),
!1;V=function(a){var b;b=a.nativeSelection;b.anchorNode?(b=ha(b,0),a._ranges=[b],a.rangeCount=1,b=a.nativeSelection,a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=b.focusOffset,a.isCollapsed=K(a)):q(a)}}E.refresh=function(a){var b=a?this._ranges.slice(0):null,c=this.anchorNode,d=this.anchorOffset;if(V(this),a){a=b.length;if(a!=this._ranges.length||this.anchorNode!=c||this.anchorOffset!=d)return!0;for(;a--;)if(!P(b[a],this._ranges[a]))return!0;return!1}};
var wa=function(a,b){var c=a.getAllRanges();a.removeAllRanges();for(var d=0,g=c.length;d<g;++d)P(b,c[d])||a.addRange(c[d]);a.rangeCount||q(a)};ga&&N?E.removeRange=function(a){if("Control"==this.docSelection.type){var b,c=this.docSelection.createRange();a=h(a);b=X(c.item(0));for(var d=I(b).createControlRange(),g=!1,e=0,f=c.length;e<f;++e)b=c.item(e),b!==a||g?d.add(c.item(e)):g=!0;d.select();k(this)}else wa(this,a)}:E.removeRange=function(a){wa(this,a)};var ma;!L&&fa&&T.implementsDomRange?(ma=f,E.isBackward=
function(){return ma(this)}):ma=E.isBackward=function(){return!1};E.isBackwards=E.isBackward;E.toString=function(){for(var a=[],b=0,c=this.rangeCount;b<c;++b)a[b]=""+this._ranges[b];return a.join("")};E.collapse=function(b,c){r(this,b);var d=a.createRange(b);d.collapseToPoint(b,c);this.setSingleRange(d);this.isCollapsed=!0};E.collapseToStart=function(){if(!this.rangeCount)throw new M("INVALID_STATE_ERR");var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)};E.collapseToEnd=function(){if(!this.rangeCount)throw new M("INVALID_STATE_ERR");
var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)};E.selectAllChildren=function(b){r(this,b);var c=a.createRange(b);c.selectNodeContents(b);this.setSingleRange(c)};E.deleteFromDocument=function(){if(ga&&N&&"Control"==this.docSelection.type){for(var a,b=this.docSelection.createRange();b.length;)a=b.item(0),b.remove(a),C.removeNode(a);this.refresh()}else if(this.rangeCount&&(a=this.getAllRanges(),a.length)){this.removeAllRanges();for(var b=0,c=a.length;b<c;++b)a[b].deleteContents();
this.addRange(a[c-1])}};E.eachRange=function(a,b){for(var c=0,d=this._ranges.length;c<d;++c)if(a(this.getRangeAt(c)))return b};E.getAllRanges=function(){var a=[];return this.eachRange(function(b){a.push(b)}),a};E.setSingleRange=function(a,b){this.removeAllRanges();this.addRange(a,b)};E.callMethodOnEachRange=function(a,b){var c=[];return this.eachRange(function(d){c.push(d[a].apply(d,b||[]))}),c};E.setStart=p(!0);E.setEnd=p(!1);a.rangePrototype.select=function(a){Y(this.getDocument()).setSingleRange(this,
a)};E.changeEachRange=function(a){var b=[],c=this.isBackward();this.eachRange(function(c){a(c);b.push(c)});this.removeAllRanges();c&&1==b.length?this.addRange(b[0],"backward"):this.setRanges(b)};E.containsNode=function(a,b){return this.eachRange(function(c){return c.containsNode(a,b)},!0)||!1};E.getBookmark=function(a){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[a])}};E.moveToBookmark=function(b){for(var c,d,g=[],e=0;c=b.rangeBookmarks[e++];)d=a.createRange(this.win),
d.moveToBookmark(c),g.push(d);b.backward?this.setSingleRange(g[0],"backward"):this.setRanges(g)};E.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}};E.restoreRanges=function(a){this.removeAllRanges();for(var b,c=0;b=a.ranges[c];++c)this.addRange(b,a.backward&&0==c)};E.toHtml=function(){var a=[];return this.eachRange(function(b){a.push(J.toHtml(b))}),a.join("")};T.implementsTextRange&&(E.getNativeTextRange=function(){var c;if(c=this.docSelection){c=
c.createRange();if(n(c))return c;throw b.createError("getNativeTextRange: selection is a control selection");}if(0<this.rangeCount)return a.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw b.createError("getNativeTextRange: selection contains no range");});E.getName=function(){return"WrappedSelection"};E.inspect=function(){return Z(this)};E.detach=function(){y(this.win,"delete");B(this)};D.detachAll=function(){y(null,"deleteAll")};D.inspect=Z;D.isDirectionBackward=c;a.Selection=D;a.selectionPrototype=
E;a.addShimListener(function(a){"undefined"==typeof a.getSelection&&(a.getSelection=function(){return Y(a)});a=null})});var z=!1,n=function(b){z||(z=!0,!a.initialized&&a.config.autoInitialize&&A())};return B&&("complete"==document.readyState?n():(p(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",n,!1),b(window,"load",n))),a},this);
(function(p,v){"function"==typeof define&&define.amd?define(["./rangy-core"],p):"undefined"!=typeof module&&"object"==typeof exports?module.exports=p(require("rangy")):p(v.rangy)})(function(p){return p.createModule("SaveRestore",["WrappedRange"],function(p,C){function v(r,p){var e,f="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),h=W.getDocument(r.startContainer);r=r.cloneRange();return r.collapse(p),e=h.createElement("span"),e.id=f,e.style.lineHeight="0",e.style.display="none",e.className=
"rangySelectionBoundary",e.appendChild(h.createTextNode(F)),r.insertNode(e),e}function G(r,p,e,f){(r=(r||document).getElementById(e))?(p[f?"setStartBefore":"setEndBefore"](r),J(r)):C.warn("Marker element has been removed. Cannot restore selection.")}function O(r,p){return p.compareBoundaryPoints(r.START_TO_START,r)}function P(r,Z){var e,f,h=p.DomRange.getRangeDocument(r),k=r.toString();Z=S(Z);return r.collapsed?(f=v(r,!1),{document:h,markerId:f.id,collapsed:!0}):(f=v(r,!1),e=v(r,!0),{document:h,startMarkerId:e.id,
endMarkerId:f.id,collapsed:!1,backward:Z,toString:function(){return"original text: '"+k+"', new text: '"+r.toString()+"'"}})}function M(r,v){var e=r.document;"undefined"==typeof v&&(v=!0);var f=p.createRange(e);r.collapsed?(r=(e||document).getElementById(r.markerId))?(r.style.display="inline",(e=r.previousSibling)&&3==e.nodeType?(J(r),f.collapseToPoint(e,e.length)):(f.collapseBefore(r),J(r))):C.warn("Marker element has been removed. Cannot restore selection."):(G(e,f,r.startMarkerId,!0),G(e,f,r.endMarkerId,
!1));return v&&f.normalizeBoundaries(),f}function A(r,v){var e,f,h=[];e=S(v);r=r.slice(0);r.sort(O);v=0;for(f=r.length;v<f;++v)h[v]=P(r[v],e);for(v=f-1;0<=v;--v)e=r[v],f=p.DomRange.getRangeDocument(e),e.collapsed?e.collapseAfter((f||document).getElementById(h[v].markerId)):(e.setEndBefore((f||document).getElementById(h[v].endMarkerId)),e.setStartAfter((f||document).getElementById(h[v].startMarkerId)));return h}function Y(r){for(var p=[],e=r.length-1;0<=e;e--)p[e]=M(r[e],!0);return p}function V(p,
v){(p=(p||document).getElementById(v))&&J(p)}var W=p.dom,J=W.removeNode,S=p.Selection.isDirectionBackward,F="\ufeff";p.util.extend(p,{saveRange:P,restoreRange:M,saveRanges:A,restoreRanges:Y,saveSelection:function(r){if(!p.isSelectionValid(r))return C.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus."),null;var v=p.getSelection(r),e=v.getAllRanges(),f=1==e.length&&v.isBackward(),h=A(e,f);return f?v.setSingleRange(e[0],f):v.setRanges(e),
{win:r,rangeInfos:h,restored:!1}},restoreSelection:function(r,v){if(!r.restored){var e=r.rangeInfos,f=p.getSelection(r.win),h=Y(e);1==e.length&&v&&p.features.selectionHasExtend&&e[0].backward?(f.removeAllRanges(),f.addRange(h[0],!0)):f.setRanges(h);r.restored=!0}},removeMarkerElement:V,removeMarkers:function(p){for(var v,e=p.rangeInfos,f=0,h=e.length;f<h;++f)v=e[f],v.collapsed?V(p.doc,v.markerId):(V(p.doc,v.startMarkerId),V(p.doc,v.endMarkerId))}})}),p},this);
(function(p,v,C){function aa(a){var b=[];Y(b,v.noop).chars(a);return b.join("")}function G(a){var b={};a=a.split(",");var c;for(c=0;c<a.length;c++)b[a[c]]=!0;return b}function O(a,b){function c(a,c,g,e){c=v.lowercase(c);if(q[c])for(;k.last()&&B[k.last()];)d("",k.last());m[c]&&k.last()==c&&d("",c);(e=n[c]||!!e)||k.push(c);var f={};g.replace(S,function(a,b,c,d,g){f[b]=P(c||d||g||"")});b.start&&b.start(c,f,e)}function d(a,c){a=0;if(c=v.lowercase(c))for(a=k.length-1;0<=a&&k[a]!=c;a--);if(0<=a){for(c=
k.length-1;c>=a;c--)b.end&&b.end(k[c]);k.length=a}}"string"!==typeof a&&(a=null===a||"undefined"===typeof a?"":""+a);var g,l,k=[],z=a,x;for(k.last=function(){return k[k.length-1]};a;){x="";g=!0;if(k.last()&&D[k.last()])a=a.replace(new RegExp("([^]*)<\\s*\\/\\s*"+k.last()+"[^>]*>","i"),function(a,c){c=c.replace(Z,"$1").replace(h,"$1");b.chars&&b.chars(P(c));return""}),d("",k.last());else{if(y.test(a)){if(l=a.match(y))b.whitespace&&b.whitespace(l[0]),a=a.replace(l[0],""),g=!1}else if(e.test(a)){if(l=
a.match(e))b.comment&&b.comment(l[1]),a=a.replace(l[0],""),g=!1}else if(f.test(a)){if(l=a.match(f))a=a.replace(l[0],""),g=!1}else if(r.test(a)){if(l=a.match(J))a=a.substring(l[0].length),l[0].replace(J,d),g=!1}else F.test(a)&&((l=a.match(W))?(l[4]&&(a=a.substring(l[0].length),l[0].replace(W,c)),g=!1):(x+="<",a=a.substring(1)));g&&(g=a.indexOf("<"),x+=0>g?a:a.substring(0,g),a=0>g?"":a.substring(g),b.chars&&b.chars(P(x)))}if(a==z)throw V("badparse","The sanitizer was unable to parse the following block of html: {0}",
a);z=a}d()}function P(a){if(!a)return"";var b=l.exec(a);a=b[1];var c=b[3];if(b=b[2])g.innerHTML=b.replace(/</g,"&lt;"),b="textContent"in g?g.textContent:g.innerText;return a+b+c}function M(a){return a.replace(/&/g,"&amp;").replace(k,function(a){var b=a.charCodeAt(0);a=a.charCodeAt(1);return"&#"+(1024*(b-55296)+(a-56320)+65536)+";"}).replace(R,function(a){var b=a.charCodeAt(0);return 159>=b||173==b||1536<=b&&1540>=b||1807==b||6068==b||6069==b||8204<=b&&8207>=b||8232<=b&&8239>=b||8288<=b&&8303>=b||
65279==b||65520<=b&&65535>=b?"&#"+b+";":a}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function A(a){var b="";a=a.split(";");v.forEach(a,function(a){a=a.split(":");if(2==a.length){var c=z(v.lowercase(a[0]));a=z(v.lowercase(a[1]));if(("color"===c||"background-color"===c)&&(a.match(/^rgb\([0-9%,\. ]*\)$/i)||a.match(/^rgba\([0-9%,\. ]*\)$/i)||a.match(/^hsl\([0-9%,\. ]*\)$/i)||a.match(/^hsla\([0-9%,\. ]*\)$/i)||a.match(/^#[0-9a-f]{3,6}$/i)||a.match(/^[a-z]*$/i))||"text-align"===c&&("left"===a||"right"===
a||"center"===a||"justify"===a)||"text-decoration"===c&&("underline"===a||"line-through"===a)||"font-weight"===c&&"bold"===a||"font-style"===c&&"italic"===a||"float"===c&&("left"===a||"right"===a||"none"===a)||"font-size"===c&&a.match(/[0-9\.]*(px|em|rem|%)/)||("width"===c||"height"===c)&&a.match(/[0-9\.]*(px|em|rem|%)/)||"direction"===c&&a.match(/^ltr|rtl|initial|inherit$/))b+=c+": "+a+";"}});return b}function Y(c,g){var e=!1,f=v.bind(c,c.push);return{start:function(c,l,q){c=v.lowercase(c);!e&&D[c]&&
(e=c);e||!0!==a[c]||(f("<"),f(c),v.forEach(l,function(a,e){var q=v.lowercase(e),m="img"===c&&"src"===q||"background"===q,k;(k="style"===q&&""!==(a=A(a)))||(k="img"===c&&l["ta-insert-video"]&&("ta-insert-video"===q||"allowfullscreen"===q||"frameborder"===q||"contenteditable"===q&&"false"===a)?!0:!1);if(k||!0===b[q]&&(!0!==d[q]||g(a,m)))f(" "),f(e),f('="'),f(M(a)),f('"')}),f(q?"/>":">"))},comment:function(a){f(a)},whitespace:function(a){f(M(a))},end:function(b){b=v.lowercase(b);e||!0!==a[b]||(f("</"),
f(b),f(">"));b==e&&(e=!1)},chars:function(a){e||f(M(a))}}}var V=v.$$minErr("$sanitize"),W=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,J=/^<\/\s*([\w:-]+)[^>]*>/,S=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,F=/^</,r=/^<\//,Z=/\x3c!--(.*?)--\x3e/g,e=/(^\x3c!--.*?--\x3e)/,f=/<!DOCTYPE([^>]*?)>/i,h=/<!\[CDATA\[(.*?)]]\x3e/g,k=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,R=/([^\#-~| |!])/g,y=/^(\s+)/,n=G("area,br,col,hr,img,wbr,input");
p=G("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr");C=G("rp,rt");var m=v.extend({},C,p),q=v.extend({},p,G("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),B=v.extend({},C,G("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var"));p=G("animate,animateColor,animateMotion,animateTransform,circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,set,stop,svg,switch,text,title,tspan,use");
var D=G("script,style"),a=v.extend({},n,q,B,m,p),d=G("background,cite,href,longdesc,src,usemap,xlink:href");p=G("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,id,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width");C=G("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,attributeName,attributeType,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan");
var b=v.extend({},d,C,p),g=document.createElement("pre"),l=/^(\s*)([\s\S]*?)(\s*)$/,z=function(){return String.prototype.trim?function(a){return v.isString(a)?a.trim():a}:function(a){return v.isString(a)?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}();v.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(a){return function(b,c){"undefined"!=typeof c&&(c.version="taSanitize");c=[];O(b,Y(c,function(b,c){return!/^unsafe/.test(a(b,c))}));return c.join("")}}]});
v.module("ngSanitize").filter("linky",["$sanitize",function(a){var b=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/,c=/^mailto:/;return function(d,g){function e(a){a&&q.push(aa(a))}function f(a,b){q.push("<a ");v.isDefined(g)&&q.push('target="',g,'" ');q.push('href="',a.replace(/"/g,"&quot;"),'">');e(b);q.push("</a>")}if(!d)return d;for(var l=d,q=[],m,k;d=l.match(b);)m=d[0],d[2]||d[4]||(m=(d[3]?"http://":"mailto:")+m),k=d.index,e(l.substr(0,k)),f(m,d[0].replace(c,
"")),l=l.substring(k+d[0].length);e(l);return a(q.join(""))}}])})(window,window.angular);
!function(p,v){"function"==typeof define&&define.amd?define("textAngular",["rangy","rangy/lib/rangy-selectionsaverestore"],function(C,aa){return p["textAngular.name"]=v(C,aa)}):"object"==typeof exports?module.exports=v(require("rangy"),require("rangy/lib/rangy-selectionsaverestore")):p.textAngular=v(rangy)}(this,function(p){var v={};angular.module("textAngularSetup",[]).constant("taRegisterTool",function(e,f){if(!e||""===e||v.hasOwnProperty(e))throw"textAngular Error: A unique name is required for a Tool Definition";
var h;if((h=f.display)&&!(h=""===f.display)){var k;try{k=0!==angular.element(f.display).length}catch(R){k=!1}h=!k}if(h||!f.display&&!f.buttontext&&!f.iconclass)throw'textAngular Error: Tool Definition for "'+e+'" does not have a valid display/iconclass/buttontext value';v[e]=f}).value("taTools",v).value("taOptions",{forceTextAngularSanitize:!0,keyMappings:[],toolbar:["h1 h2 h3 h4 h5 h6 p pre quote".split(" "),"bold italics underline strikeThrough ul ol redo undo clear".split(" "),"justifyLeft justifyCenter justifyRight justifyFull indent outdent".split(" "),
"html insertImage insertLink insertVideo wordcount charcount".split(" ")],classes:{focussed:"focussed",toolbar:"btn-toolbar",toolbarGroup:"btn-group",toolbarButton:"btn btn-default",toolbarButtonActive:"active",disabled:"disabled",textEditor:"form-control",htmlEditor:"form-control"},defaultTagAttributes:{a:{target:""}},setup:{textEditorSetup:function(e){},htmlEditorSetup:function(e){}},defaultFileDropHandler:function(e,f){var h=new FileReader;return"image"===e.type.substring(0,5)&&(h.onload=function(){""!==
h.result&&f("insertImage",h.result,!0)},h.readAsDataURL(e),!0)}}).value("taSelectableElements",["a","img"]).value("taCustomRenderers",[{selector:"img",customAttribute:"ta-insert-video",renderLogic:function(e){var f=angular.element("<iframe></iframe>"),h=e.prop("attributes");angular.forEach(h,function(e){f.attr(e.name,e.value)});f.attr("src",f.attr("ta-insert-video"));e.replaceWith(f)}}]).value("taTranslations",{html:{tooltip:"Toggle html / Rich Text"},heading:{tooltip:"Heading "},p:{tooltip:"Paragraph"},
pre:{tooltip:"Preformatted text"},ul:{tooltip:"Unordered List"},ol:{tooltip:"Ordered List"},quote:{tooltip:"Quote/unquote selection or paragraph"},undo:{tooltip:"Undo"},redo:{tooltip:"Redo"},bold:{tooltip:"Bold"},italic:{tooltip:"Italic"},underline:{tooltip:"Underline"},strikeThrough:{tooltip:"Strikethrough"},justifyLeft:{tooltip:"Align text left"},justifyRight:{tooltip:"Align text right"},justifyFull:{tooltip:"Justify text"},justifyCenter:{tooltip:"Center"},indent:{tooltip:"Increase indent"},outdent:{tooltip:"Decrease indent"},
clear:{tooltip:"Clear formatting"},insertImage:{dialogPrompt:"Please enter an image URL to insert",tooltip:"Insert image",hotkey:"the - possibly language dependent hotkey ... for some future implementation"},insertVideo:{tooltip:"Insert video",dialogPrompt:"Please enter a youtube URL to embed"},insertLink:{tooltip:"Insert / edit link",dialogPrompt:"Please enter a URL to insert"},editLink:{reLinkButton:{tooltip:"Relink"},unLinkButton:{tooltip:"Unlink"},targetToggle:{buttontext:"Open in New Window"}},
wordcount:{tooltip:"Display words Count"},charcount:{tooltip:"Display characters Count"}}).factory("taToolFunctions",["$window","taTranslations",function(e,f){return{imgOnSelectAction:function(e,f,p){var k=function(){p.updateTaBindtaTextElement();p.hidePopover()};e.preventDefault();p.displayElements.popover.css("width","375px");e=p.displayElements.popoverContainer;e.empty();var h=angular.element('<div class="btn-group" style="padding-right: 6px;">'),m=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">100% </button>');
m.on("click",function(a){a.preventDefault();f.css({width:"100%",height:""});k()});var q=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">50% </button>');q.on("click",function(a){a.preventDefault();f.css({width:"50%",height:""});k()});var B=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">25% </button>');B.on("click",function(a){a.preventDefault();f.css({width:"25%",height:""});
k()});var D=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">Reset</button>');D.on("click",function(a){a.preventDefault();f.css({width:"",height:""});k()});h.append(m);h.append(q);h.append(B);h.append(D);e.append(h);h=angular.element('<div class="btn-group" style="padding-right: 6px;">');m=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-left"></i></button>');
m.on("click",function(a){a.preventDefault();f.css("float","left");f.css("cssFloat","left");f.css("styleFloat","left");k()});q=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-right"></i></button>');q.on("click",function(a){a.preventDefault();f.css("float","right");f.css("cssFloat","right");f.css("styleFloat","right");k()});B=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-justify"></i></button>');
B.on("click",function(a){a.preventDefault();f.css("float","");f.css("cssFloat","");f.css("styleFloat","");k()});h.append(m);h.append(B);h.append(q);e.append(h);h=angular.element('<div class="btn-group">');m=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-trash-o"></i></button>');m.on("click",function(a){a.preventDefault();f.remove();k()});h.append(m);e.append(h);p.showPopover(f);p.showResizeOverlay(f)},aOnSelectAction:function(h,
k,p){h.preventDefault();p.displayElements.popover.css("width","436px");h=p.displayElements.popoverContainer;h.empty();h.css("line-height","28px");var y=angular.element('<a href="'+k.attr("href")+'" target="_blank">'+k.attr("href")+"</a>");y.css({display:"inline-block","max-width":"200px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","vertical-align":"middle"});h.append(y);var y=angular.element('<div class="btn-group pull-right">'),n=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on" title="'+
f.editLink.reLinkButton.tooltip+'"><i class="fa fa-edit icon-edit"></i></button>');n.on("click",function(q){q.preventDefault();(q=e.prompt(f.insertLink.dialogPrompt,k.attr("href")))&&""!==q&&"http://"!==q&&(k.attr("href",q),p.updateTaBindtaTextElement());p.hidePopover()});y.append(n);n=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on" title="'+f.editLink.unLinkButton.tooltip+'"><i class="fa fa-unlink icon-unlink"></i></button>');n.on("click",
function(e){e.preventDefault();k.replaceWith(k.contents());p.updateTaBindtaTextElement();p.hidePopover()});y.append(n);var m=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on">'+f.editLink.targetToggle.buttontext+"</button>");"_blank"===k.attr("target")&&m.addClass("active");m.on("click",function(e){e.preventDefault();k.attr("target","_blank"===k.attr("target")?"":"_blank");m.toggleClass("active");p.updateTaBindtaTextElement()});y.append(m);
h.append(y);p.showPopover(k)},extractYoutubeVideoId:function(e){return(e=e.match(/(?:youtube(?:-nocookie)?\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/i))&&e[1]||null}}}]).run(["taRegisterTool","$window","taTranslations","taSelection","taToolFunctions","$sanitize","taOptions","$log",function(e,f,h,k,p,y,n,m){m={};if(y("",m),!0===n.forceTextAngularSanitize&&"taSanitize"!==m.version)throw angular.$$minErr("textAngular")("textAngularSetup","The textAngular-sanitize provider has been replaced by another -- have you included angular-sanitize by mistake?");
e("html",{iconclass:"fa fa-code",tooltiptext:h.html.tooltip,action:function(){this.$editor().switchView()},activeState:function(){return this.$editor().showHtml}});var q=function(a){return function(){return this.$editor().queryFormatBlockState(a)}},B=function(){return this.$editor().wrapSelection("formatBlock","<"+this.name.toUpperCase()+">")};angular.forEach("h1 h2 h3 h4 h5 h6".split(" "),function(a){e(a.toLowerCase(),{buttontext:a.toUpperCase(),tooltiptext:h.heading.tooltip+a.charAt(1),action:B,
activeState:q(a.toLowerCase())})});e("p",{buttontext:"P",tooltiptext:h.p.tooltip,action:function(){return this.$editor().wrapSelection("formatBlock","<P>")},activeState:function(){return this.$editor().queryFormatBlockState("p")}});e("pre",{buttontext:"pre",tooltiptext:h.pre.tooltip,action:function(){return this.$editor().wrapSelection("formatBlock","<PRE>")},activeState:function(){return this.$editor().queryFormatBlockState("pre")}});e("ul",{iconclass:"fa fa-list-ul",tooltiptext:h.ul.tooltip,action:function(){return this.$editor().wrapSelection("insertUnorderedList",
null)},activeState:function(){return this.$editor().queryCommandState("insertUnorderedList")}});e("ol",{iconclass:"fa fa-list-ol",tooltiptext:h.ol.tooltip,action:function(){return this.$editor().wrapSelection("insertOrderedList",null)},activeState:function(){return this.$editor().queryCommandState("insertOrderedList")}});e("quote",{iconclass:"fa fa-quote-right",tooltiptext:h.quote.tooltip,action:function(){return this.$editor().wrapSelection("formatBlock","<BLOCKQUOTE>")},activeState:function(){return this.$editor().queryFormatBlockState("blockquote")}});
e("undo",{iconclass:"fa fa-undo",tooltiptext:h.undo.tooltip,action:function(){return this.$editor().wrapSelection("undo",null)}});e("redo",{iconclass:"fa fa-repeat",tooltiptext:h.redo.tooltip,action:function(){return this.$editor().wrapSelection("redo",null)}});e("bold",{iconclass:"fa fa-bold",tooltiptext:h.bold.tooltip,action:function(){return this.$editor().wrapSelection("bold",null)},activeState:function(){return this.$editor().queryCommandState("bold")},commandKeyCode:98});e("justifyLeft",{iconclass:"fa fa-align-left",
tooltiptext:h.justifyLeft.tooltip,action:function(){return this.$editor().wrapSelection("justifyLeft",null)},activeState:function(a){if(a&&"#document"===a.nodeName)return!1;var d=!1;return a&&(d="left"===a.css("text-align")||"left"===a.attr("align")||"right"!==a.css("text-align")&&"center"!==a.css("text-align")&&"justify"!==a.css("text-align")&&!this.$editor().queryCommandState("justifyRight")&&!this.$editor().queryCommandState("justifyCenter")&&!this.$editor().queryCommandState("justifyFull")),d||
this.$editor().queryCommandState("justifyLeft")}});e("justifyRight",{iconclass:"fa fa-align-right",tooltiptext:h.justifyRight.tooltip,action:function(){return this.$editor().wrapSelection("justifyRight",null)},activeState:function(a){if(a&&"#document"===a.nodeName)return!1;var d=!1;return a&&(d="right"===a.css("text-align")),d||this.$editor().queryCommandState("justifyRight")}});e("justifyFull",{iconclass:"fa fa-align-justify",tooltiptext:h.justifyFull.tooltip,action:function(){return this.$editor().wrapSelection("justifyFull",
null)},activeState:function(a){var d=!1;return a&&(d="justify"===a.css("text-align")),d||this.$editor().queryCommandState("justifyFull")}});e("justifyCenter",{iconclass:"fa fa-align-center",tooltiptext:h.justifyCenter.tooltip,action:function(){return this.$editor().wrapSelection("justifyCenter",null)},activeState:function(a){if(a&&"#document"===a.nodeName)return!1;var d=!1;return a&&(d="center"===a.css("text-align")),d||this.$editor().queryCommandState("justifyCenter")}});e("indent",{iconclass:"fa fa-indent",
tooltiptext:h.indent.tooltip,action:function(){return this.$editor().wrapSelection("indent",null)},activeState:function(){return this.$editor().queryFormatBlockState("blockquote")},commandKeyCode:"TabKey"});e("outdent",{iconclass:"fa fa-outdent",tooltiptext:h.outdent.tooltip,action:function(){return this.$editor().wrapSelection("outdent",null)},activeState:function(){return!1},commandKeyCode:"ShiftTabKey"});e("italics",{iconclass:"fa fa-italic",tooltiptext:h.italic.tooltip,action:function(){return this.$editor().wrapSelection("italic",
null)},activeState:function(){return this.$editor().queryCommandState("italic")},commandKeyCode:105});e("underline",{iconclass:"fa fa-underline",tooltiptext:h.underline.tooltip,action:function(){return this.$editor().wrapSelection("underline",null)},activeState:function(){return this.$editor().queryCommandState("underline")},commandKeyCode:117});e("strikeThrough",{iconclass:"fa fa-strikethrough",tooltiptext:h.strikeThrough.tooltip,action:function(){return this.$editor().wrapSelection("strikeThrough",
null)},activeState:function(){return document.queryCommandState("strikeThrough")}});e("clear",{iconclass:"fa fa-ban",tooltiptext:h.clear.tooltip,action:function(a,d){this.$editor().wrapSelection("removeFormat",null);var b=angular.element(k.getSelectionElement());a=k.getAllSelectedElements();var g=function(a,b){a=angular.element(a);var c=b;return b||(c=a),angular.forEach(a.children(),function(a){if("ul"===a.tagName.toLowerCase()||"ol"===a.tagName.toLowerCase())c=g(a,c);else{var b=angular.element("<p></p>");
b.html(angular.element(a).html());c.after(b);c=b}}),a.remove(),c};angular.forEach(a,function(a){"ul"!==a.nodeName.toLowerCase()&&"ol"!==a.nodeName.toLowerCase()||g(a)});angular.forEach(b.find("ul"),g);angular.forEach(b.find("ol"),g);var e=this.$editor(),f=function(a){a=angular.element(a);a[0]!==e.displayElements.text[0]&&a.removeAttr("class");angular.forEach(a.children(),f)};angular.forEach(b,f);b[0]&&"li"!==b[0].tagName.toLowerCase()&&"ol"!==b[0].tagName.toLowerCase()&&"ul"!==b[0].tagName.toLowerCase()&&
this.$editor().wrapSelection("formatBlock","default");d()}});var D=function(a){return a?-1!==a.toLowerCase().indexOf("javascript"):!1};e("insertImage",{iconclass:"fa fa-picture-o",tooltiptext:h.insertImage.tooltip,action:function(){var a;if(a=f.prompt(h.insertImage.dialogPrompt,"http://"),a&&""!==a&&"http://"!==a&&!D(a))return k.getSelectionElement().tagName&&"a"===k.getSelectionElement().tagName.toLowerCase()&&k.setSelectionAfterElement(k.getSelectionElement()),a='<img src="'+a+'">',this.$editor().wrapSelection("insertHTML",
a,!0)},onElementSelect:{element:"img",action:p.imgOnSelectAction}});e("insertVideo",{iconclass:"fa fa-youtube-play",tooltiptext:h.insertVideo.tooltip,action:function(){var a;if(a=f.prompt(h.insertVideo.dialogPrompt,"https://"),!D(a)&&a&&""!==a&&"https://"!==a&&(videoId=p.extractYoutubeVideoId(a),videoId))return a='<img class="ta-insert-video" src="https://img.youtube.com/vi/'+videoId+'/hqdefault.jpg" ta-insert-video="'+("https://www.youtube.com/embed/"+videoId)+'" contenteditable="false" allowfullscreen="true" frameborder="0" />',
k.getSelectionElement().tagName&&"a"===k.getSelectionElement().tagName.toLowerCase()&&k.setSelectionAfterElement(k.getSelectionElement()),this.$editor().wrapSelection("insertHTML",a,!0)},onElementSelect:{element:"img",onlyWithAttrs:["ta-insert-video"],action:p.imgOnSelectAction}});e("insertLink",{tooltiptext:h.insertLink.tooltip,iconclass:"fa fa-link",action:function(){var a;if(a=k.getSelectionElement().tagName&&"a"===k.getSelectionElement().tagName.toLowerCase()?f.prompt(h.insertLink.dialogPrompt,
k.getSelectionElement().href):f.prompt(h.insertLink.dialogPrompt,"http://"),a&&""!==a&&"http://"!==a&&!D(a))return this.$editor().wrapSelection("createLink",a,!0)},activeState:function(a){return!!a&&"A"===a[0].tagName},onElementSelect:{element:"a",action:p.aOnSelectAction}});e("wordcount",{display:'<div id="toolbarWC" style="display:block; min-width:100px;">Words: <span ng-bind="wordcount"></span></div>',disabled:!0,wordcount:0,activeState:function(){var a=this.$editor().displayElements.text[0].innerHTML||
"",d=0;return""!==a.replace(/\s*<[^>]*?>\s*/g,"")&&""!==a.trim()&&(d=a.replace(/<\/?(b|i|em|strong|span|u|strikethrough|a|img|small|sub|sup|label)( [^>*?])?>/gi,"").replace(/(<[^>]*?>\s*<[^>]*?>)/gi," ").replace(/(<[^>]*?>)/gi,"").replace(/\s+/gi," ").match(/\S+/g).length),this.wordcount=d,this.$editor().wordcount=d,!1}});e("charcount",{display:'<div id="toolbarCC" style="display:block; min-width:120px;">Characters: <span ng-bind="charcount"></span></div>',disabled:!0,charcount:0,activeState:function(){var a=
this.$editor().displayElements.text,a=(a[0].innerText||a[0].textContent).replace(/(\r\n|\n|\r)/gm,"").replace(/^\s+/g," ").replace(/\s+$/g," ").length;return this.charcount=a,this.$editor().charcount=a,!1}})}]);var C=function(){for(var e=3,f=document.createElement("div"),h=f.getElementsByTagName("i");f.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",h[0];);return 4<e?e:void 0}(),aa=/AppleWebKit\/([\d.]+)/i.test(navigator.userAgent);navigator.userAgent.toLowerCase().indexOf("firefox");
var G=G||{};G.now=function(){return G.now||G.mozNow||G.msNow||G.oNow||G.webkitNow||function(){return(new Date).getTime()}}();var O=/^(address|article|aside|audio|blockquote|canvas|center|dd|div|dl|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|noscript|ol|output|p|pre|section|table|tfoot|ul|video)$/i,P=/^(ul|li|ol)$/i,M=/^(#text|span|address|article|aside|audio|blockquote|canvas|center|dd|div|dl|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|noscript|ol|output|p|pre|section|table|tfoot|ul|video|li)$/i;
String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var A,Y,V,W,J,S;if(8<C||void 0===C){for(var F=document.styleSheets,r=0;r<F.length;r++)if((0===F[r].media.length||F[r].media.mediaText.match(/(all|screen)/gi))&&F[r].href&&F[r].href.match(/textangular\.(min\.|)css/gi)){A=F[r];break}A||(A=function(){var e=document.createElement("style");return aa&&e.appendChild(document.createTextNode("")),document.getElementsByTagName("head")[0].appendChild(e),e.sheet}());
Y=function(e,f){return W(A,e,f)};W=function(e,f,h){var k,p;return e.cssRules?k=Math.max(e.cssRules.length-1,0):e.rules&&(k=Math.max(e.rules.length-1,0)),e.insertRule?e.insertRule(f+"{"+h+"}",k):e.addRule(f,h,k),A.rules?p=A.rules[k]:A.cssRules&&(p=A.cssRules[k]),p};S=function(e,f){var h,k;for(h=0;h<f.length;h++)if(f[h].cssText===e.cssText){k=h;break}return k};V=function(e){J(A,e)};J=function(e,f){var h=e.cssRules||e.rules;h&&0!==h.length&&(f=S(f,h),e.removeRule?e.removeRule(f):e.deleteRule(f))}}angular.module("textAngular.factories",
[]).factory("taBrowserTag",[function(){return function(e){return e?""===e?void 0===C?"div":8>=C?"P":"p":8>=C?e.toUpperCase():e:8>=C?"P":"p"}}]).factory("taApplyCustomRenderers",["taCustomRenderers","taDOM",function(e,f){return function(h){var k=angular.element("<div></div>");return k[0].innerHTML=h,angular.forEach(e,function(e){var h=[];e.selector&&""!==e.selector?h=k.find(e.selector):e.customAttribute&&""!==e.customAttribute&&(h=f.getByAttribute(k,e.customAttribute));angular.forEach(h,function(f){f=
angular.element(f);e.selector&&""!==e.selector&&e.customAttribute&&""!==e.customAttribute?void 0!==f.attr(e.customAttribute)&&e.renderLogic(f):e.renderLogic(f)})}),k[0].innerHTML}}]).factory("taFixChrome",function(){return function(e){if(!e||!angular.isString(e)||0>=e.length)return e;for(var f,h,k,p=/<([^>\/]+?)style=("([^\"]+)"|'([^']+)')([^>]*)>/gi,y=/<span class="Apple-converted-space">([^<]+)<\/span>/gi,n="",m=0;f=y.exec(e);)h=f[1],h=h.replace(/&nbsp;/gi," "),n+=e.substring(m,f.index)+h,m=f.index+
f[0].length;for(m&&(n+=e.substring(m),e=n,n="",m=0);f=p.exec(e);)(h=f[3]||f[4])&&h.match(/line-height: 1.[0-9]{3,12};|color: inherit; line-height: 1.1;|color: rgb\(\d{1,3}, \d{1,3}, \d{1,3}\);|background-color: rgb\(\d{1,3}, \d{1,3}, \d{1,3}\);/i)&&(h=h.replace(/( |)font-family: inherit;|( |)line-height: 1.[0-9]{3,12};|( |)color: inherit;|( |)color: rgb\(\d{1,3}, \d{1,3}, \d{1,3}\);|( |)background-color: rgb\(\d{1,3}, \d{1,3}, \d{1,3}\);/gi,""),k="<"+f[1].trim(),0<h.trim().length&&(k+=" style="+f[2].substring(0,
1)+h+f[2].substring(0,1)),k+=f[5].trim()+">",n+=e.substring(m,f.index)+k,m=f.index+f[0].length);return n+=e.substring(m),0<m?n.replace(/<span\s?>(.*?)<\/span>(<br(\/|)>|)/gi,"$1"):e}}).factory("taSanitize",["$sanitize",function(e){function f(a,b){for(var d,e=0,f=0,c=/<[^>]*>/gi;d=c.exec(a);)if(f=d.index,"/"===d[0].substr(1,1)){if(0===e)break;e--}else e++;return b+a.substring(0,f)+angular.element(b)[0].outerHTML.substring(b.length)+a.substring(f)}function h(a){if(!a||!angular.isString(a)||0>=a.length)return a;
var b,d,e,m,c,n,w=/<([^>\/]+?)style=("([^"]+)"|'([^']+)')([^>]*)>/gi,D="",u="";for(n=0;d=w.exec(a);)if(m=d[3]||d[4],c=new RegExp(q,"i"),angular.isString(m)&&c.test(m)){c="";for(var p=new RegExp(q,"ig");e=p.exec(m);)for(b=0;b<k.length;b++)e[2*b+2]&&(c+="<"+k[b].tag+">");n=h(a.substring(n,d.index));u+=0<D.length?f(n,D):n;m=m.replace(new RegExp(q,"ig"),"");u+="<"+d[1].trim();0<m.length&&(u+=' style="'+m+'"');u+=d[5]+">";n=d.index+d[0].length;D=c}return u+(0<D.length?f(a.substring(n),D):a.substring(n))}
for(var k=[{property:"font-weight",values:["bold"],tag:"b"},{property:"font-style",values:["italic"],tag:"i"}],p=[],y=0;y<k.length;y++){for(var n="("+k[y].property+":\\s*(",m=0;m<k[y].values.length;m++)0<m&&(n+="|"),n+=k[y].values[m];n+=");)";p.push(n)}var q="("+p.join("|")+")",B=new RegExp(/<span id="selectionBoundary_\d+_\d+" class="rangySelectionBoundary">[^<>]+?<\/span>/gi),D=new RegExp(/<span class="rangySelectionBoundary" id="selectionBoundary_\d+_\d+">[^<>]+?<\/span>/gi),a=new RegExp(/<span id="selectionBoundary_\d+_\d+" class="rangySelectionBoundary">[^<>]+?<\/span>/gi);
return function(d,b,g){if(!g)try{d=h(d)}catch(u){}if(d&&angular.isString(d)&&!(0>=d.length)){for(var f,q=/<([^>\/]+?)align=("([^"]+)"|'([^']+)')([^>]*)>/gi,c="",m=0;f=q.exec(d);){var c=c+d.substring(m,f.index),m=f.index+f[0].length,k="<"+f[1]+f[5];/style=("([^"]+)"|'([^']+)')/gi.test(k)?k=k.replace(/style=("([^"]+)"|'([^']+)')/i,'style="$2$3 text-align:'+(f[3]||f[4])+';"'):k+=' style="text-align:'+(f[3]||f[4])+';"';k+=">";c+=k}d=c+d.substring(m)}if(d)try{d=d.replace(B,""),d=d.replace(D,""),d=d.replace(B,
""),d=d.replace(a,"")}catch(u){}var n;try{n=e(d),g&&(n=d)}catch(u){n=b||""}g=n.match(/(<pre[^>]*>.*?<\/pre[^>]*>)/gi);d=n.replace(/(&#(9|10);)*/gi,"");f=/<pre[^>]*>.*?<\/pre[^>]*>/gi;c=q=0;for(n="";null!==(b=f.exec(d))&&q<g.length;)n+=d.substring(c,b.index)+g[q],c=b.index+b[0].length,q++;return n+d.substring(c)}}]).factory("taToolExecuteAction",["$q","$log",function(e,f){return function(h){void 0!==h&&(this.$editor=function(){return h});var k,p=e.defer(),y=p.promise,n=this.$editor();try{k=this.action(p,
n.startAction()),y.finally(function(){n.endAction.call(n)})}catch(m){f.error(m)}(k||void 0===k)&&p.resolve()}}]);angular.module("textAngular.DOM",["textAngular.factories"]).factory("taExecCommand",["taSelection","taBrowserTag","$document",function(e,f,h){var k=function(f,a){var d,b,g=f.find("li");for(b=g.length-1;0<=b;b--)d=angular.element("<"+a+">"+g[b].innerHTML+"</"+a+">"),f.after(d);f.remove();e.setSelectionToElementEnd(d[0])},v=function(q,a,d,b,g){var l,m,c,k,h=q.find("li");for(l=0;l<h.length;l++)if(h[l].outerHTML===
a[0].outerHTML){k=l;0<l&&(m=h[l-1]);l+1<h.length&&(c=h[l+1]);break}l="";if(b?l+="<"+g+">"+a[0].innerHTML+"</"+g+">":(l+="<"+f(d)+">",l+="<li>"+a[0].innerHTML+"</li>",l+="</"+f(d)+">"),d=angular.element(l),!m)return a.remove(),q.after(angular.element(q[0].outerHTML)),q.after(d),q.remove(),void e.setSelectionToElementEnd(d[0]);if(c){a=(q.parent(),"");m=q[0].nodeName.toLowerCase();a+="<"+m+">";for(l=0;l<k;l++)a+="<li>"+h[l].innerHTML+"</li>";a+="</"+m+">";c=""+("<"+m+">");for(l=k+1;l<h.length;l++)c+=
"<li>"+h[l].innerHTML+"</li>";q.after(angular.element(c+("</"+m+">")));q.after(d);q.after(angular.element(a));q.remove()}else a.remove(),q.after(d);e.setSelectionToElementEnd(d[0])},y=function(q,a,d,b,g){var l,m,c,h,k=q.find("li"),n=[];for(l=0;l<k.length;l++)for(m=0;m<a.length;m++)k[l].isEqualNode(a[m])&&(n[m]=l);0<n[0]&&(c=k[n[0]-1]);n[a.length-1]+1<k.length&&(h=k[n[a.length-1]+1]);l="";if(b)for(m=0;m<a.length;m++)l+="<"+g+">"+a[m].innerHTML+"</"+g+">",a[m].remove();else{l+="<"+f(d)+">";for(m=0;m<
a.length;m++)l+=a[m].outerHTML,a[m].remove();l+="</"+f(d)+">"}if(d=angular.element(l),!c)return q.after(angular.element(q[0].outerHTML)),q.after(d),q.remove(),void e.setSelectionToElementEnd(d[0]);if(!h)return q.after(d),void e.setSelectionToElementEnd(d[0]);c="";h=q[0].nodeName.toLowerCase();c+="<"+h+">";for(l=0;l<n[0];l++)c+="<li>"+k[l].innerHTML+"</li>";c+="</"+h+">";b=""+("<"+h+">");for(l=n[a.length-1]+1;l<k.length;l++)b+="<li>"+k[l].innerHTML+"</li>";q.after(angular.element(b+("</"+h+">")));
q.after(d);q.after(angular.element(c));q.remove();e.setSelectionToElementEnd(d[0])},n=function(f){/(<br(|\/)>)$/i.test(f.innerHTML.trim())?e.setSelectionBeforeElement(angular.element(f).find("br")[0]):e.setSelectionToElementEnd(f)},m=function(e,a){a=angular.element("<"+a+">"+e[0].innerHTML+"</"+a+">");e.after(a);e.remove();n(a.find("li")[0])},q=function(e,a,d){for(var b="",g=0;g<e.length;g++)b+="<"+f("li")+">"+e[g].innerHTML+"</"+f("li")+">";e=angular.element("<"+d+">"+b+"</"+d+">");a.after(e);a.remove();
n(e.find("li")[0])},B=function(e,a){for(var d=0;d<e.childNodes.length;d++){var b=e.childNodes[d];b.tagName&&b.tagName.match(O)&&B(b,a)}if(null===e.parentNode)return e;a=angular.element(a);return a[0].innerHTML=e.innerHTML,e.parentNode.insertBefore(a[0],e),e.parentNode.removeChild(e),a};return function(n,a){return n=f(n),function(d,b,g,l){var z,c,x,w,r=angular.element("<"+n+">");try{e.getSelection&&(w=e.getSelection());x=e.getSelectionElement();var u,D;void 0!==x.tagName&&("div"===x.tagName.toLowerCase()&&
/taTextElement.+/.test(x.id)&&w&&w.start&&1===w.start.offset&&1===w.end.offset?(u=x.innerHTML,/<br>/i.test(u)&&(u=u.replace(/<br>/i,"&#8203;")),/<br\/>/i.test(u)&&(u=u.replace(/<br\/>/i,"&#8203;")),/<span>(<span>)+/i.test(u)&&(u=__.replace(/<span>(<span>)+/i,"<span>")),/<\/span>(<\/span>)+/i.test(u)&&(u=__.replace(/<\/span>(<\/span>)+/i,"</span>")),/<span><\/span>/i.test(u)&&(u=u.replace(/<span><\/span>/i,"")),D="<div>"+u+"</div>",x.innerHTML=D,e.setSelectionToElementEnd(x.childNodes[0]),x=e.getSelectionElement()):
"span"===x.tagName.toLowerCase()&&w&&w.start&&1===w.start.offset&&1===w.end.offset?(u=x.innerHTML,/<br>/i.test(u)&&(u=u.replace(/<br>/i,"&#8203;")),/<br\/>/i.test(u)&&(u=u.replace(/<br\/>/i,"&#8203;")),/<span>(<span>)+/i.test(u)&&(u=__.replace(/<span>(<span>)+/i,"<span>")),/<\/span>(<\/span>)+/i.test(u)&&(u=__.replace(/<\/span>(<\/span>)+/i,"</span>")),/<span><\/span>/i.test(u)&&(u=u.replace(/<span><\/span>/i,"")),D="<div>"+u+"</div>",x.innerHTML=D,e.setSelectionToElementEnd(x.childNodes[0]),x=e.getSelectionElement()):
"p"===x.tagName.toLowerCase()&&w&&w.start&&1===w.start.offset&&1===w.end.offset?(u=x.innerHTML,/<br>/i.test(u)&&(u=u.replace(/<br>/i,"&#8203;"),x.innerHTML=u,e.setSelectionToElementEnd(x.childNodes[0]),x=e.getSelectionElement())):"li"===x.tagName.toLowerCase()&&w&&w.start&&w.start.offset===w.end.offset&&(u=x.innerHTML,/<br>/i.test(u)&&(u=u.replace(/<br>/i,""),x.innerHTML=u,e.setSelectionToElementEnd(x.childNodes[0]),x=e.getSelectionElement())))}catch(Ka){}w=angular.element(x);u=x.tagName&&x.tagName.toLowerCase()||
"";if("insertorderedlist"===d.toLowerCase()||"insertunorderedlist"===d.toLowerCase()){r=f("insertorderedlist"===d.toLowerCase()?"ol":"ul");z=e.getOnlySelectedElements();if(1<z.length&&("ol"===u||"ul"===u))return y(w,z,r,r===u,n);if(u===r)return w[0].childNodes.length!==z.length&&1===z.length?(w=angular.element(z[0]),v(w.parent(),w,r,!0,n)):k(w,n);if("li"===u&&w.parent()[0].tagName.toLowerCase()===r&&1===w.parent().children().length)return k(w.parent(),n);if("li"===u&&w.parent()[0].tagName.toLowerCase()!==
r&&1===w.parent().children().length)return m(w.parent(),r);if(u.match(O)&&!w.hasClass("ta-bind")){if(z.length&&w[0].childNodes.length!==z.length&&1===z.length)return w=angular.element(z[0]),v(w.parent(),w,r,r===u,n);if("ol"===u||"ul"===u)return m(w,r);var C=!1;return angular.forEach(w.children(),function(a){a.tagName.match(O)&&(C=!0)}),C?q(w.children(),w,r):q([angular.element("<div>"+x.innerHTML+"</div>")[0]],w,r)}if(u.match(O)){if(c=e.getOnlySelectedElements(),0===c.length)b=angular.element("<"+
r+"><li>"+x.innerHTML+"</li></"+r+">"),w.html(""),w.append(b);else{if(1===c.length&&("ol"===c[0].tagName.toLowerCase()||"ul"===c[0].tagName.toLowerCase()))return c[0].tagName.toLowerCase()===r?k(angular.element(c[0]),n):m(angular.element(c[0]),r);z="";g=[];for(d=0;d<c.length;d++)3!==c[d].nodeType&&(b=angular.element(c[d]),"li"!==c[d].tagName.toLowerCase()&&(z+="ol"===c[d].tagName.toLowerCase()||"ul"===c[d].tagName.toLowerCase()?b[0].innerHTML:"span"!==c[d].tagName.toLowerCase()||"ol"!==c[d].childNodes[0].tagName.toLowerCase()&&
"ul"!==c[d].childNodes[0].tagName.toLowerCase()?"<"+f("li")+">"+b[0].innerHTML+"</"+f("li")+">":b[0].childNodes[0].innerHTML,g.unshift(b)));b=angular.element("<"+r+">"+z+"</"+r+">");g.pop().replaceWith(b);angular.forEach(g,function(a){a.remove()})}return void e.setSelectionToElementEnd(b[0])}}else{if("formatblock"===d.toLowerCase()){x=g.toLowerCase().replace(/[<>]/gi,"");"default"===x.trim()&&(x=n,g="<"+n+">");for(b="li"===u?w.parent():w;!b[0].tagName||!b[0].tagName.match(O)&&!b.parent().attr("contenteditable");)b=
b.parent(),u=(b[0].tagName||"").toLowerCase();if(u===x){c=b.children();g=!1;for(d=0;d<c.length;d++)g=g||c[d].tagName.match(O);g?(b.after(c),z=b.next(),b.remove(),b=z):(r.append(b[0].childNodes),b.after(r),b.remove(),b=r)}else if(b.parent()[0].tagName.toLowerCase()!==x||b.parent().hasClass("ta-bind"))if(u.match(P))b.wrap(g);else{c=e.getOnlySelectedElements();0===c.length&&(c=[b[0]]);for(d=0;d<c.length;d++)if(3===c[d].nodeType||!c[d].tagName.match(O))for(;3===c[d].nodeType||!c[d].tagName||!c[d].tagName.match(O);)c[d]=
c[d].parentNode;if(c=c.filter(function(a,b,c){return c.indexOf(a)===b}),1<c.length&&(c=c.filter(function(a,b,c){return!("div"===a.nodeName.toLowerCase()&&/^taTextElement/.test(a.id))})),angular.element(c[0]).hasClass("ta-bind"))b=angular.element(g),b[0].innerHTML=c[0].innerHTML,c[0].innerHTML=b[0].outerHTML;else if("blockquote"===x){z="";for(d=0;d<c.length;d++)z+=c[d].outerHTML;b=angular.element(g);b[0].innerHTML=z;c[0].parentNode.insertBefore(b[0],c[0]);for(d=c.length-1;0<=d;d--)c[d].parentNode&&
c[d].parentNode.removeChild(c[d])}else if("pre"===x&&e.getStateShiftKey()){z="";for(d=0;d<c.length;d++)z+=c[d].outerHTML;b=angular.element(g);b[0].innerHTML=z;c[0].parentNode.insertBefore(b[0],c[0]);for(d=c.length-1;0<=d;d--)c[d].parentNode&&c[d].parentNode.removeChild(c[d])}else for(d=0;d<c.length;d++)r=B(c[d],g),c[d]===b[0]&&(b=angular.element(r))}else{c=b.parent();g=c.contents();for(d=0;d<g.length;d++)c.parent().hasClass("ta-bind")&&3===g[d].nodeType&&(r=angular.element("<"+n+">"),r[0].innerHTML=
g[d].outerHTML,g[d]=r[0]),c.parent()[0].insertBefore(g[d],c[0]);c.remove()}return e.setSelectionToElementEnd(b[0]),void b[0].focus()}if("createlink"===d.toLowerCase()){if("a"===u)return void(e.getSelectionElement().href=g);c='<a href="'+g+'" target="'+(l.a.target?l.a.target:"")+'">';e.getSelection().collapsed?e.insertHtml(c+g+"</a>",a):p.getSelection().getRangeAt(0).canSurroundContents()&&(c=angular.element(c+"</a>")[0],p.getSelection().getRangeAt(0).surroundContents(c));return}if("inserthtml"===
d.toLowerCase())return void e.insertHtml(g,a)}try{h[0].execCommand(d,b,g)}catch(Ka){}}}}]).service("taSelection",["$document","taDOM","$log",function(e,f,h){var k,r=e[0],y=function(e,f){return e.tagName&&e.tagName.match(/^br$/i)&&0===f&&!e.previousSibling?{element:e.parentNode,offset:0}:{element:e,offset:f}},n={getSelection:function(){var e;try{e=p.getSelection().getRangeAt(0)}catch(B){return}var f=e.commonAncestorContainer;e={start:y(e.startContainer,e.startOffset),end:y(e.endContainer,e.endOffset),
collapsed:e.collapsed};return 3===f.nodeType&&("div"===f.parentNode.nodeName.toLowerCase()&&/^taTextElement/.test(f.parentNode.id)||(f=f.parentNode)),"div"===f.nodeName.toLowerCase()&&/^taTextElement/.test(f.id)?(e.start.element=f.childNodes[e.start.offset],e.end.element=f.childNodes[e.end.offset],e.container=f):f.parentNode===e.start.element||f.parentNode===e.end.element?e.container=f.parentNode:e.container=f,e},updateLeftArrowKey:function(e){if((e=p.getSelection().getRangeAt(0))&&e.collapsed){var f=
n.getFlattenedDom(e);if(f.findIndex){var m,h=e.startContainer,a=f.findIndex(function(a,d){return a.node===h?!0:-1!==a.parents.indexOf(h)});if(!(f.forEach(function(a,d){a.parents.forEach(function(a,b){})}),a+1<f.length&&(m=f[a+1].node),m&&m.textContent&&/^\ufeff([^\ufeff]*)$/.exec(m.textContent))){var d;if(0<a&&(d=f[a-1].node),0===e.startOffset&&d&&/^\ufeff([^\ufeff]*)$/.exec(d.textContent))return void n.setSelectionToElementEnd(d)}}}},updateRightArrowKey:function(e){},getFlattenedDom:function(e){function f(a){a.node.childNodes.length?
Array.prototype.slice.call(a.node.childNodes).forEach(function(d){var b=a.parents.slice();b.slice(-1)[0]!==a.node&&b.push(a.node);f({parents:b,node:d})}):h.push({parents:a.parents,node:a.node})}var m=e.commonAncestorContainer.parentNode;if(!m)return e.commonAncestorContainer.childNodes;var h=Array.prototype.slice.call(m.childNodes);e=h.indexOf(e.startContainer);return e+1<h.length&&0<e||m.parentNode&&(m=m.parentNode),h=[],f({parents:[m],node:m}),h},getOnlySelectedElements:function(){var e=p.getSelection().getRangeAt(0),
f=e.commonAncestorContainer;return f=3===f.nodeType?f.parentNode:f,e.getNodes([1],function(e){return e.parentNode===f})},getAllSelectedElements:function(){var e=p.getSelection().getRangeAt(0),f=e.commonAncestorContainer,f=3===f.nodeType?f.parentNode:f,h=e.getNodes([1],function(a){return a.parentNode===f}),k=f.innerHTML;if(k=k.replace(/<span id=.selectionBoundary[^>]+>\ufeff?<\/span>/gi,""),k===e.toHtml()&&("div"!==f.nodeName.toLowerCase()||!/^taTextElement/.test(f.id))){e=[];for(k=h.length;k--;e.unshift(h[k]));
h=e;h.push(f)}return h},getSelectionElement:function(){return n.getSelection()?n.getSelection().container:void 0},setSelection:function(e,f,h,k){var a=p.createRange();a.setStart(e,h);a.setEnd(f,k);p.getSelection().setSingleRange(a)},setSelectionBeforeElement:function(e){var f=p.createRange();f.selectNode(e);f.collapse(!0);p.getSelection().setSingleRange(f)},setSelectionAfterElement:function(e){var f=p.createRange();f.selectNode(e);f.collapse(!1);p.getSelection().setSingleRange(f)},setSelectionToElementStart:function(e){var f=
p.createRange();f.selectNodeContents(e);f.collapse(!0);p.getSelection().setSingleRange(f)},setSelectionToElementEnd:function(e){var f=p.createRange();f.selectNodeContents(e);f.collapse(!1);e.childNodes&&e.childNodes[e.childNodes.length-1]&&"br"===e.childNodes[e.childNodes.length-1].nodeName&&(f.startOffset=f.endOffset=f.startOffset-1);p.getSelection().setSingleRange(f)},setStateShiftKey:function(e){k=e},getStateShiftKey:function(){return k},insertHtml:function(e,h){var k,m,a;k=angular.element("<div>"+
e+"</div>");var d=p.getSelection().getRangeAt(0),b=r.createDocumentFragment(),g=k[0].childNodes;k=!0;if(0<g.length){e=[];for(m=0;m<g.length;m++){var l=g[m];"p"===l.nodeName.toLowerCase()&&""===l.innerHTML.trim()||(k=k&&!O.test(l.nodeName),e.push(l))}for(g=0;g<e.length;g++)a=b.appendChild(e[g]);!k&&d.collapsed&&/^(|<br(|\/)>)$/i.test(d.startContainer.innerHTML)&&d.selectNode(d.startContainer)}else k=!0,a=b=r.createTextNode(e);if(k)d.deleteContents();else if(d.collapsed&&d.startContainer!==h)if(d.startContainer.innerHTML&&
d.startContainer.innerHTML.match(/^<[^>]*>$/i))h=d.startContainer,1===d.startOffset?(d.setStartAfter(h),d.setEndAfter(h)):(d.setStartBefore(h),d.setEndBefore(h));else{if(3===d.startContainer.nodeType&&d.startContainer.parentNode!==h)for(h=d.startContainer.parentNode,k=h.cloneNode(),f.splitNodes(h.childNodes,h,k,d.startContainer,d.startOffset);!M.test(h.nodeName);)angular.element(h).after(k),h=h.parentNode,e=k,k=h.cloneNode(),f.splitNodes(h.childNodes,h,k,e);else h=d.startContainer,k=h.cloneNode(),
f.splitNodes(h.childNodes,h,k,void 0,void 0,d.startOffset);if(angular.element(h).after(k),d.setStartAfter(h),d.setEndAfter(h),/^(|<br(|\/)>)$/i.test(h.innerHTML.trim())&&(d.setStartBefore(h),d.setEndBefore(h),angular.element(h).remove()),/^(|<br(|\/)>)$/i.test(k.innerHTML.trim())&&angular.element(k).remove(),"li"===h.nodeName.toLowerCase()){e=r.createDocumentFragment();for(h=0;h<b.childNodes.length;h++)k=angular.element("<li>"),f.transferChildNodes(b.childNodes[h],k[0]),f.transferNodeAttributes(b.childNodes[h],
k[0]),e.appendChild(k[0]);b=e;a&&(a=b.childNodes[b.childNodes.length-1],a=a.childNodes[a.childNodes.length-1])}}else d.deleteContents();d.insertNode(b);a&&n.setSelectionToElementEnd(a)}};return n}]).service("taDOM",function(){var e={getByAttribute:function(f,h){var k=[],p=f.children();return p.length&&angular.forEach(p,function(f){k=k.concat(e.getByAttribute(angular.element(f),h))}),void 0!==f.attr(h)&&k.push(f),k},transferChildNodes:function(e,h){for(h.innerHTML="";0<e.childNodes.length;)h.appendChild(e.childNodes[0]);
return h},splitNodes:function(f,h,k,p,r,n){if(!p&&isNaN(n))throw Error("taDOM.splitNodes requires a splitNode or splitIndex");for(var m=document.createDocumentFragment(),q=document.createDocumentFragment(),v=0;0<f.length&&(isNaN(n)||n!==v)&&f[0]!==p;)m.appendChild(f[0]),v++;for(!isNaN(r)&&0<=r&&f[0]&&(m.appendChild(document.createTextNode(f[0].nodeValue.substring(0,r))),f[0].nodeValue=f[0].nodeValue.substring(r));0<f.length;)q.appendChild(f[0]);e.transferChildNodes(m,h);e.transferChildNodes(q,k)},
transferNodeAttributes:function(e,h){for(var f=0;f<e.attributes.length;f++)h.setAttribute(e.attributes[f].name,e.attributes[f].value);return h}};return e});angular.module("textAngular.validators",[]).directive("taMaxText",function(){return{restrict:"A",require:"ngModel",link:function(e,f,h,k){var p=parseInt(e.$eval(h.taMaxText));if(isNaN(p))throw"Max text must be an integer";h.$observe("taMaxText",function(e){if(p=parseInt(e),isNaN(p))throw"Max text must be an integer";k.$dirty&&k.$validate()});k.$validators.taMaxText=
function(e){var f=angular.element("<div/>");return f.html(e),f.text().length<=p}}}}).directive("taMinText",function(){return{restrict:"A",require:"ngModel",link:function(e,f,h,k){var p=parseInt(e.$eval(h.taMinText));if(isNaN(p))throw"Min text must be an integer";h.$observe("taMinText",function(e){if(p=parseInt(e),isNaN(p))throw"Min text must be an integer";k.$dirty&&k.$validate()});k.$validators.taMinText=function(e){var f=angular.element("<div/>");return f.html(e),!f.text().length||f.text().length>=
p}}}});angular.module("textAngular.taBind",["textAngular.factories","textAngular.DOM"]).service("_taBlankTest",[function(){return function(e){if(!e)return!0;var f=document.createElement("DIV");f.innerHTML=e;f=f.textContent||f.innerText||"";return""===(f.replace("?",""),f.trim())&&!/<img[^>]+>/.test(e)}}]).directive("taButton",[function(){return{link:function(e,f,h){f.attr("unselectable","on");f.on("mousedown",function(e,f){return f&&angular.extend(e,f),e.preventDefault(),!1})}}}]).directive("taBind",
["taSanitize","$timeout","$document","taFixChrome","taBrowserTag","taSelection","taSelectableElements","taApplyCustomRenderers","taOptions","_taBlankTest","$parse","taDOM","textAngularManager",function(e,f,h,k,r,v,n,m,q,B,D,a,d){return{priority:2,require:["ngModel","?ngModelOptions"],link:function(b,g,l,r){function c(a){var b;return aa.forEach(function(c){if(c.keyCode===a.keyCode){var d=(a.metaKey?qa:0)+(a.ctrlKey?pa:0)+(a.shiftKey?ka:0)+(a.altKey?ea:0);c.forbiddenModifiers&d||c.mustHaveModifiers.every(function(a){return d&
a})&&(b=c.specialKey)}}),b}var z,w,y,u=r[0],G=r[1]||{},F=void 0!==g.attr("contenteditable")&&g.attr("contenteditable"),J=F||"textarea"===g[0].tagName.toLowerCase()||"input"===g[0].tagName.toLowerCase(),A=!1,R=!1,ca=!1,P=l.taUnsafeSanitizer||q.disableSanitizer,ia=/^(9|19|20|27|33|34|35|36|37|38|39|40|45|112|113|114|115|116|117|118|119|120|121|122|123|144|145)$/i,La=/^(8|13|32|46|59|61|107|109|173|186|187|188|189|190|191|192|219|220|221|222)$/i,pa=1,qa=2,ea=4,ka=8,aa=[{specialKey:"UndoKey",forbiddenModifiers:ea+
ka,mustHaveModifiers:[qa+pa],keyCode:90},{specialKey:"RedoKey",forbiddenModifiers:ea,mustHaveModifiers:[qa+pa,ka],keyCode:90},{specialKey:"RedoKey",forbiddenModifiers:ea+ka,mustHaveModifiers:[qa+pa],keyCode:89},{specialKey:"TabKey",forbiddenModifiers:qa+ka+ea+pa,mustHaveModifiers:[],keyCode:9},{specialKey:"ShiftTabKey",forbiddenModifiers:qa+ea+pa,mustHaveModifiers:[ka],keyCode:9}];void 0===l.taDefaultWrap&&(l.taDefaultWrap="p");""===l.taDefaultWrap?y="":(y=void 0===C||11<=C?"br"===l.taDefaultWrap.toLowerCase()?
"<BR><BR>":"<"+l.taDefaultWrap+"><br></"+l.taDefaultWrap+">":8>=C?"<"+l.taDefaultWrap.toUpperCase()+"></"+l.taDefaultWrap.toUpperCase()+">":"<"+l.taDefaultWrap+"></"+l.taDefaultWrap+">",void 0===C||11<=C?l.taDefaultWrap.toLowerCase():8>=C&&(l.taDefaultWrap.toUpperCase(),l.taDefaultWrap.toUpperCase()));G.$options||(G.$options={});r=function(a){if(B(a))return a;var b=angular.element("<div>"+a+"</div>");if(0===b.children().length)a="<"+l.taDefaultWrap+">"+a+"</"+l.taDefaultWrap+">";else{for(var c=b[0].childNodes,
d=!1,b=0;b<c.length&&!(d=c[b].nodeName.toLowerCase().match(O));b++);if(d)for(a="",b=0;b<c.length;b++){var d=c[b],e=d.nodeName.toLowerCase();"#comment"===e?a+="\x3c!--"+d.nodeValue+"--\x3e":"#text"===e?(d=d.textContent,a+=d.trim()?"<"+l.taDefaultWrap+">"+d+"</"+l.taDefaultWrap+">":d):e.match(O)?a+=d.outerHTML:(d=d.outerHTML||d.nodeValue,a+=""!==d.trim()?"<"+l.taDefaultWrap+">"+d+"</"+l.taDefaultWrap+">":d)}else a="<"+l.taDefaultWrap+">"+a+"</"+l.taDefaultWrap+">"}return a};l.taPaste&&(w=D(l.taPaste));
g.addClass("ta-bind");var W;b["$undoManager"+(l.id||"")]=u.$undoManager={_stack:[],_index:0,_max:1E3,push:function(a){return"undefined"==typeof a||null===a||"undefined"!=typeof this.current()&&null!==this.current()&&a===this.current()?a:(this._index<this._stack.length-1&&(this._stack=this._stack.slice(0,this._index+1)),this._stack.push(a),W&&f.cancel(W),this._stack.length>this._max&&this._stack.shift(),this._index=this._stack.length-1,a)},undo:function(){return this.setToIndex(this._index-1)},redo:function(){return this.setToIndex(this._index+
1)},setToIndex:function(a){if(!(0>a||a>this._stack.length-1))return this._index=a,this.current()},current:function(){return this._stack[this._index]}};var S,ba=function(){if(F)return g[0].innerHTML;if(J)return g.val();throw"textAngular Error: attempting to update non-editable taBind";},ta=function(a){return b.$emit("ta-element-select",this),a.preventDefault(),!1},K=b["reApplyOnSelectorHandlers"+(l.id||"")]=function(){A||angular.forEach(n,function(a){g.find(a).off("click",ta).on("click",ta)})},da=
function(a,b,c){ca=c||!1;"undefined"!=typeof b&&null!==b||(b=F);"undefined"!=typeof a&&null!==a||(a=ba());B(a)?(""!==u.$viewValue&&u.$setViewValue(""),b&&""!==u.$undoManager.current()&&u.$undoManager.push("")):(K(),u.$viewValue!==a&&(u.$setViewValue(a),b&&u.$undoManager.push(a)));u.$render()},Ja=b["$undoTaBind"+(l.id||"")]=function(){if(!A&&F){var a=u.$undoManager.undo();"undefined"!=typeof a&&null!==a&&(g[0].innerHTML=a,da(a,!1),S&&f.cancel(S),S=f(function(){g[0].focus();v.setSelectionToElementEnd(g[0])},
1))}},za=b["$redoTaBind"+(l.id||"")]=function(){if(!A&&F){var a=u.$undoManager.redo();"undefined"!=typeof a&&null!==a&&(g[0].innerHTML=a,da(a,!1),S&&f.cancel(S),S=f(function(){g[0].focus();v.setSelectionToElementEnd(g[0])},1))}};b["updateTaBind"+(l.id||"")]=function(){A||da(void 0,void 0,!0)};var Aa=function(a){return u.$oldViewValue=e(k(a),u.$oldViewValue,P)};if(g.attr("required")&&(u.$validators.required=function(a,b){return!B(a||b)}),u.$parsers.push(Aa),u.$parsers.unshift(r),u.$formatters.push(Aa),
u.$formatters.unshift(r),u.$formatters.unshift(function(a){return u.$undoManager.push(a||"")}),J)if(b.events={},F){var va=!1,Fa=function(c){var d=void 0!==c&&c.match(/content=["']*OneNote.File/i);if(c&&c.trim().length){if(c.match(/class=["']*Mso(Normal|List)/i)||c.match(/content=["']*Word.Document/i)||c.match(/content=["']*OneNote.File/i)){var h=c.match(/\x3c!--StartFragment--\x3e([\s\S]*?)\x3c!--EndFragment--\x3e/i),h=h?h[1]:c,h=h.replace(/<o:p>[\s\S]*?<\/o:p>/gi,"").replace(/class=(["']|)MsoNormal(["']|)/gi,
""),h=angular.element("<div>"+h+"</div>"),l=angular.element("<div></div>"),k=null,m=[];c=null;var n=!1,q;m.peek=function(){var a=this.length;if(0<a)return this[a-1]};for(var p=function(a){n=a;k=angular.element(a?"<ul>":"<ol>");m=[];m.peek=function(){var a=this.length;if(0<a)return this[a-1]};q=null},H=0;H<=h[0].childNodes.length;H++)if(h[0].childNodes[H]&&"#text"!==h[0].childNodes[H].nodeName){var r=h[0].childNodes[H].tagName.toLowerCase();if("p"===r||"h1"===r||"h2"===r||"h3"===r||"h4"===r||"h5"===
r||"h6"===r){var r=angular.element(h[0].childNodes[H]),ia=(r.attr("class")||"").match(/MsoList(Bullet|Number|Paragraph)(CxSp(First|Middle|Last)|)/i);if(ia){if(!(2>r[0].childNodes.length||1>r[0].childNodes[1].childNodes.length)){var z="bullet"===ia[1].toLowerCase()||"number"!==ia[1].toLowerCase()&&!(/^[^0-9a-z<]*[0-9a-z]+[^0-9a-z<>]</i.test(r[0].childNodes[1].innerHTML)||/^[^0-9a-z<]*[0-9a-z]+[^0-9a-z<>]</i.test(r[0].childNodes[1].childNodes[0].innerHTML)),x=(r.attr("style")||"").match(/margin-left:([\-\.0-9]*)/i),
x=parseFloat(x?x[1]:0),y=(r.attr("style")||"").match(/mso-list:l([0-9]+) level([0-9]+) lfo[0-9+]($|;)/i);if(y&&y[2]&&(x=parseInt(y[2])),y&&(!q||y[1]!==q[1])||!ia[3]||"first"===ia[3].toLowerCase()||null===m.peek()||n!==z&&m.peek()===x)p(z),l.append(k);else if(null!=m.peek()&&m.peek()<x)k=angular.element(z?"<ul>":"<ol>"),c.append(k);else if(null!=m.peek()&&m.peek()>x){for(;null!=m.peek()&&m.peek()>x;)if("li"!==k.parent()[0].tagName.toLowerCase()){if(!/[uo]l/i.test(k.parent()[0].tagName.toLowerCase()))break;
k=k.parent();m.pop()}else k=k.parent();n="ul"===k[0].tagName.toLowerCase();z!==n&&(p(z),l.append(k))}q=y;x!==m.peek()&&m.push(x);c=angular.element("<li>");k.append(c);c.html(r.html().replace(/<!(--|)\[if !supportLists\](--|)>[\s\S]*?<!(--|)\[endif\](--|)>/gi,""));r.remove()}}else p(!1),l.append(r)}}var t=function(a){a=angular.element(a);for(var b=a[0].childNodes.length-1;0<=b;b--)a.after(a[0].childNodes[b]);a.remove()};angular.forEach(l.find("span"),function(a){a.removeAttribute("lang");0>=a.attributes.length&&
t(a)});angular.forEach(l.find("font"),t);c=l.html();d&&(c=l.html()||h.html());c=c.replace(/\n/g," ")}else{if(c=c.replace(/<(|\/)meta[^>]*?>/gi,""),c.match(/<[^>]*?(ta-bind)[^>]*?>/)){if(c.match(/<[^>]*?(text-angular)[^>]*?>/)){d=angular.element("<div>"+c+"</div>");d.find("textarea").remove();h=a.getByAttribute(d,"ta-bind");for(l=0;l<h.length;l++){c=h[l][0].parentNode.parentNode;for(p=0;p<h[l][0].childNodes.length;p++)c.parentNode.insertBefore(h[l][0].childNodes[p],c);c.parentNode.removeChild(c)}c=
d.html().replace('<br class="Apple-interchange-newline">',"")}}else c.match(/^<span/)&&(c.match(/<span class=(\"Apple-converted-space\"|\'Apple-converted-space\')>.<\/span>/gi)||(c=c.replace(/<(|\/)span[^>]*?>/gi,"")));c=c.replace(/<br class="Apple-interchange-newline"[^>]*?>/gi,"").replace(/<span class="Apple-converted-space">( |&nbsp;)<\/span>/gi,"&nbsp;")}/<li(\s.*)?>/i.test(c)&&!1===/(<ul(\s.*)?>|<ol(\s.*)?>).*<li(\s.*)?>/i.test(c)&&(c=c.replace(/<li(\s.*)?>.*<\/li(\s.*)?>/i,"<ul>$&</ul>"));c=
c.replace(/^[ |\u00A0]+/gm,function(a){for(var b="",c=0;c<a.length;c++)b+="&nbsp;";return b}).replace(/\n|\r\n|\r/g,"<br />").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;");w&&(c=w(b,{$html:c})||c);c=e(c,"",P);v.insertHtml(c,g[0]);f(function(){u.$setViewValue(ba());va=!1;g.removeClass("processing-paste")},0)}else va=!1,g.removeClass("processing-paste")};g.on("paste",b.events.paste=function(a,b){if(b&&angular.extend(a,b),A||va)return a.stopPropagation(),a.preventDefault(),!1;va=!0;g.addClass("processing-paste");
var c;if((b=(a.originalEvent||a).clipboardData)&&b.getData&&0<b.types.length){for(var d="",e=0;e<b.types.length;e++)d+=" "+b.types[e];return/text\/html/i.test(d)?c=b.getData("text/html"):/text\/plain/i.test(d)&&(c=b.getData("text/plain")),Fa(c),a.stopPropagation(),a.preventDefault(),!1}var l=p.saveSelection(),k=angular.element('<div class="ta-hidden-input" contenteditable="true"></div>');h.find("body").append(k);k[0].focus();f(function(){p.restoreSelection(l);Fa(k[0].innerHTML);g[0].focus();k.remove()},
0)});g.on("cut",b.events.cut=function(a){A?a.preventDefault():f(function(){u.$setViewValue(ba())},0)});g.on("keydown",b.events.keydown=function(a,e){e&&angular.extend(a,e);16===a.keyCode?v.setStateShiftKey(!0):v.setStateShiftKey(!1);a.specialKey=c(a);var f;if(q.keyMappings.forEach(function(b){a.specialKey===b.commandKeyCode&&(a.specialKey=void 0);b.testForKey(a)&&(f=b.commandKeyCode);"UndoKey"!==b.commandKeyCode&&"RedoKey"!==b.commandKeyCode||b.enablePropagation||a.preventDefault()}),"undefined"!=
typeof f&&(a.specialKey=f),"undefined"==typeof a.specialKey||"UndoKey"===a.specialKey&&"RedoKey"===a.specialKey||(a.preventDefault(),d.sendKeyCommand(b,a)),!(A||("UndoKey"===a.specialKey&&(Ja(),a.preventDefault()),"RedoKey"===a.specialKey&&(za(),a.preventDefault()),13!==a.keyCode||a.shiftKey||a.ctrlKey||a.metaKey||a.altKey))){var g;e=v.getSelectionElement();if(e.nodeName.match(M)){var h=angular.element(y);if(function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1}(["blockquote","ul",
"ol"],e.parentNode.tagName.toLowerCase())){if(/^<br(|\/)>$/i.test(e.innerHTML.trim())&&!e.nextSibling){g=angular.element(e);var l=g.parent();l.after(h);g.remove();0===l.children().length&&l.remove();v.setSelectionToElementStart(h[0]);a.preventDefault()}/^<[^>]+><br(|\/)><\/[^>]+>$/i.test(e.innerHTML.trim())&&(g=angular.element(e),g.after(h),g.remove(),v.setSelectionToElementStart(h[0]),a.preventDefault())}}}});var Ba;g.on("keyup",b.events.keyup=function(a,b){if(b&&angular.extend(a,b),v.setStateShiftKey(!1),
9===a.keyCode)return void(v.getSelection().start.element===g[0]&&g.children().length&&v.setSelectionToElementStart(g.children()[0]));if(!((37!==a.keyCode||a.shiftKey||v.updateLeftArrowKey(g),39!==a.keyCode||a.shiftKey||v.updateRightArrowKey(g),W&&f.cancel(W),A||ia.test(a.keyCode))||13===a.keyCode&&(a.ctrlKey||a.metaKey||a.altKey))){if(!(""===y||"<BR><BR>"===y||13!==a.keyCode||a.ctrlKey||a.metaKey||a.altKey||a.shiftKey)){for(b=v.getSelectionElement();!b.nodeName.match(M)&&b!==g[0];)b=b.parentNode;
if(b.tagName.toLowerCase()!==l.taDefaultWrap&&"li"!==b.tagName.toLowerCase()&&(""===b.innerHTML.trim()||"<br>"===b.innerHTML.trim())){var c=angular.element(y);angular.element(b).replaceWith(c);v.setSelectionToElementStart(c[0])}}var d=ba();""===y||""!==d.trim()&&"<br>"!==d.trim()?"<"!==d.substring(0,1)&&""!==l.taDefaultWrap:(g[0].innerHTML=y,v.setSelectionToElementStart(g.children()[0]));var e=z!==a.keyCode&&La.test(a.keyCode);Ba&&f.cancel(Ba);Ba=f(function(){da(d,e,!0)},G.$options.debounce||400);
e||(W=f(function(){u.$undoManager.push(d)},250));z=a.keyCode}});var T;if(g.on("input",function(){ba()!==u.$viewValue&&(T&&f.cancel(T),T=f(function(){var a=ba();a!==u.$viewValue&&da(a,!0)},1E3))}),g.on("blur",b.events.blur=function(){R=!1;A?(ca=!0,u.$render()):da(void 0,void 0,!0)}),l.placeholder&&(8<C||void 0===C)){var X;if(!l.id)throw"textAngular Error: An unique ID is required for placeholders to work";X=Y("#"+l.id+".placeholder-text:before",'content: "'+l.placeholder+'"');b.$on("$destroy",function(){V(X)})}g.on("focus",
b.events.focus=function(){R=!0;g.removeClass("placeholder-text");K()});g.on("mouseup",b.events.mouseup=function(){var a=v.getSelection();a&&a.start.element===g[0]&&g.children().length&&v.setSelectionToElementStart(g.children()[0])});g.on("mousedown",b.events.mousedown=function(a,b){b&&angular.extend(a,b);a.stopPropagation()})}else{g.on("change blur",b.events.change=b.events.blur=function(){A||u.$setViewValue(ba())});g.on("keydown",b.events.keydown=function(a,b){if(b&&angular.extend(a,b),9===a.keyCode){b=
this.selectionStart;var c=this.selectionEnd,d=g.val();if(a.shiftKey){var c=d.lastIndexOf("\n",b),e=d.lastIndexOf("\t",b);-1!==e&&e>=c&&(g.val(d.substring(0,e)+d.substring(e+1)),this.selectionStart=this.selectionEnd=b-1)}else g.val(d.substring(0,b)+"\t"+d.substring(c)),this.selectionStart=this.selectionEnd=b+1;a.preventDefault()}});var I=function(a,b){for(var c="",d=0;d<b;d++)c+=a;return c},Ia=function(a,b,c){for(var d=0;d<a.length;d++)b.call(c,d,a[d])},Q=function(a,b){var c="",d=a.childNodes;return b++,
c+=I("\t",b-1)+a.outerHTML.substring(0,4),Ia(d,function(a,d){a=d.nodeName.toLowerCase();return"#comment"===a?void(c+="\x3c!--"+d.nodeValue+"--\x3e"):"#text"===a?void(c+=d.textContent):void(d.outerHTML&&(c+="ul"===a||"ol"===a?"\n"+Q(d,b):"\n"+I("\t",b)+d.outerHTML))}),c+="\n"+I("\t",b-1)+a.outerHTML.substring(a.outerHTML.lastIndexOf("<"))};u.$formatters.unshift(function(a){var b=angular.element("<div>"+a+"</div>")[0].childNodes;return 0<b.length&&(a="",Ia(b,function(b,c){b=c.nodeName.toLowerCase();
return"#comment"===b?void(a+="\x3c!--"+c.nodeValue+"--\x3e"):"#text"===b?void(a+=c.textContent):void(c.outerHTML&&(0<a.length&&(a+="\n"),a+="ul"===b||"ol"===b?""+Q(c,0):""+c.outerHTML))})),a})}var N,L=function(a,c){(c&&angular.extend(a,c),Z||A)||(Z=!0,b.$emit("ta-drop-event",this,a,a.originalEvent?a.originalEvent.dataTransfer:a.dataTransfer),f(function(){Z=!1;da(void 0,void 0,!0)},100))},Ca=!1;u.$render=function(){if(!Ca){Ca=!0;var a=u.$viewValue||"";ca||(F&&R&&(g.removeClass("placeholder-text"),
N&&f.cancel(N),N=f(function(){R||(g[0].focus(),v.setSelectionToElementEnd(g.children()[g.children().length-1]));N=void 0},1)),F?(g[0].innerHTML=""===a?y:a,A?g.off("drop",L):(K(),g.on("drop",L))):"textarea"!==g[0].tagName.toLowerCase()&&"input"!==g[0].tagName.toLowerCase()?g[0].innerHTML=m(a):g.val(a));F&&l.placeholder&&(""===a?R?g.removeClass("placeholder-text"):g.addClass("placeholder-text"):g.removeClass("placeholder-text"));Ca=ca=!1}};l.taReadonly&&(A=b.$eval(l.taReadonly),A?(g.addClass("ta-readonly"),
"textarea"!==g[0].tagName.toLowerCase()&&"input"!==g[0].tagName.toLowerCase()||g.attr("disabled","disabled"),void 0!==g.attr("contenteditable")&&g.attr("contenteditable")&&g.removeAttr("contenteditable")):(g.removeClass("ta-readonly"),"textarea"===g[0].tagName.toLowerCase()||"input"===g[0].tagName.toLowerCase()?g.removeAttr("disabled"):F&&g.attr("contenteditable","true")),b.$watch(l.taReadonly,function(a,b){b!==a&&(a?(g.addClass("ta-readonly"),"textarea"!==g[0].tagName.toLowerCase()&&"input"!==g[0].tagName.toLowerCase()||
g.attr("disabled","disabled"),void 0!==g.attr("contenteditable")&&g.attr("contenteditable")&&g.removeAttr("contenteditable"),angular.forEach(n,function(a){g.find(a).on("click",ta)}),g.off("drop",L)):(g.removeClass("ta-readonly"),"textarea"===g[0].tagName.toLowerCase()||"input"===g[0].tagName.toLowerCase()?g.removeAttr("disabled"):F&&g.attr("contenteditable","true"),angular.forEach(n,function(a){g.find(a).off("click",ta)}),g.on("drop",L)),A=a)}));F&&!A&&(angular.forEach(n,function(a){g.find(a).on("click",
ta)}),g.on("drop",L))}}}]);var Z=!1,F=angular.module("textAngular","ngSanitize textAngularSetup textAngular.factories textAngular.DOM textAngular.validators textAngular.taBind".split(" "));return F.config([function(){angular.forEach(v,function(e,f){delete v[f]})}]),F.directive("textAngular",["$compile","$timeout","taOptions","taSelection","taExecCommand","textAngularManager","$document","$animate","$log","$q","$parse",function(e,f,h,k,r,v,n,m,q,B,D){return{require:"?ngModel",scope:{},restrict:"EA",
priority:2,link:function(a,d,b,g){var l,z,c,x,w,y,u,C,F,A=b.serial?b.serial:Math.floor(1E16*Math.random());a._name=b.name?b.name:"textAngularEditor"+A;var G=function(a,b,c){f(function(){var d=function(){a.off(b,d);c.apply(this,arguments)};a.on(b,d)},100)};if(w=r(b.taDefaultWrap),angular.extend(a,angular.copy(h),{wrapSelection:function(b,c,d){"undo"===b.toLowerCase()?a["$undoTaBindtaTextElement"+A]():"redo"===b.toLowerCase()?a["$redoTaBindtaTextElement"+A]():(w(b,!1,c,a.defaultTagAttributes),d&&a["reApplyOnSelectorHandlerstaTextElement"+
A](),a.displayElements.text[0].focus())},showHtml:a.$eval(b.taShowHtml)||!1}),b.taFocussedClass&&(a.classes.focussed=b.taFocussedClass),b.taTextEditorClass&&(a.classes.textEditor=b.taTextEditorClass),b.taHtmlEditorClass&&(a.classes.htmlEditor=b.taHtmlEditorClass),b.taDefaultTagAttributes)try{angular.extend(a.defaultTagAttributes,angular.fromJson(b.taDefaultTagAttributes))}catch(ia){q.error(ia)}b.taTextEditorSetup&&(a.setup.textEditorSetup=a.$parent.$eval(b.taTextEditorSetup));b.taHtmlEditorSetup&&
(a.setup.htmlEditorSetup=a.$parent.$eval(b.taHtmlEditorSetup));b.taFileDrop?a.fileDropHandler=a.$parent.$eval(b.taFileDrop):a.fileDropHandler=a.defaultFileDropHandler;c=d[0].innerHTML;d[0].innerHTML="";a.displayElements={forminput:angular.element("<input type='hidden' tabindex='-1' style='display: none;'>"),html:angular.element("<textarea></textarea>"),text:angular.element("<div></div>"),scrollWindow:angular.element("<div class='ta-scroll-window'></div>"),popover:angular.element('<div class="popover fade bottom" style="max-width: none; width: 305px;"></div>'),
popoverArrow:angular.element('<div class="arrow"></div>'),popoverContainer:angular.element('<div class="popover-content"></div>'),resize:{overlay:angular.element('<div class="ta-resizer-handle-overlay"></div>'),background:angular.element('<div class="ta-resizer-handle-background"></div>'),anchors:[angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-tl"></div>'),angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-tr"></div>'),angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-bl"></div>'),
angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-br"></div>')],info:angular.element('<div class="ta-resizer-handle-info"></div>')}};a.displayElements.popover.append(a.displayElements.popoverArrow);a.displayElements.popover.append(a.displayElements.popoverContainer);a.displayElements.scrollWindow.append(a.displayElements.popover);a.displayElements.popover.on("mousedown",function(a,b){return b&&angular.extend(a,b),a.preventDefault(),!1});a.handlePopoverEvents=function(){"block"===
a.displayElements.popover.css("display")&&(C&&f.cancel(C),C=f(function(){a.reflowPopover(F);a.reflowResizeOverlay(F)},100))};angular.element(window).on("resize",function(b,c){a.handlePopoverEvents()});angular.element(window).on("scroll",function(b,c){a.handlePopoverEvents()});a.getScrollTop=function(b,c){var d=b.scrollTop;"undefined"==typeof d&&(d=0);var e;if(e=c){var f;a:{var g;e={vertical:!1,horizontal:!1};try{if(g=window.getComputedStyle(b),null===g){f=e;break a}}catch(Pa){f=e;break a}f=g["overflow-y"];
g=g["overflow-x"];f={vertical:("scroll"===f||"auto"===f)&&b.scrollHeight>b.clientHeight,horizontal:("scroll"===g||"auto"===g)&&b.scrollWidth>b.clientWidth}}e=f.vertical}return e&&(b.removeEventListener("scroll",a._scrollListener,!1),b.addEventListener("scroll",a._scrollListener,!1)),0!==d?{node:b.nodeName,top:d}:b.parentNode?a.getScrollTop(b.parentNode,c):{node:"<none>",top:0}};a.showPopover=function(b){a.getScrollTop(a.displayElements.scrollWindow[0],!0);a.displayElements.popover.css("display","block");
F=b;a.reflowPopover(b);m.addClass(a.displayElements.popover,"in");G(n.find("body"),"click keyup",function(){a.hidePopover()})};a._scrollListener=function(b,c){a.handlePopoverEvents()};a.reflowPopover=function(b){var c=a.getScrollTop(a.displayElements.scrollWindow[0],!1);51>b[0].offsetTop-c.top?(a.displayElements.popover.css("top",b[0].offsetTop+b[0].offsetHeight+a.displayElements.scrollWindow[0].scrollTop+"px"),a.displayElements.popover.removeClass("top").addClass("bottom")):(a.displayElements.popover.css("top",
b[0].offsetTop-54+a.displayElements.scrollWindow[0].scrollTop+"px"),a.displayElements.popover.removeClass("bottom").addClass("top"));var c=a.displayElements.text[0].offsetWidth-a.displayElements.popover[0].offsetWidth,d=b[0].offsetLeft+b[0].offsetWidth/2-a.displayElements.popover[0].offsetWidth/2;b=Math.max(0,Math.min(c,d));c=Math.min(d,Math.max(0,d-c))-11;b+=window.scrollX;c-=window.scrollX;a.displayElements.popover.css("left",b+"px");a.displayElements.popoverArrow.css("margin-left",c+"px")};a.hidePopover=
function(){a.displayElements.popover.css("display","none");a.displayElements.popoverContainer.attr("style","");a.displayElements.popoverContainer.attr("class","popover-content");a.displayElements.popover.removeClass("in")};a.displayElements.resize.overlay.append(a.displayElements.resize.background);angular.forEach(a.displayElements.resize.anchors,function(b){a.displayElements.resize.overlay.append(b)});a.displayElements.resize.overlay.append(a.displayElements.resize.info);a.displayElements.scrollWindow.append(a.displayElements.resize.overlay);
a.displayElements.resize.background.on("click",function(b){a.displayElements.text[0].focus()});a.reflowResizeOverlay=function(b){b=angular.element(b)[0];a.displayElements.resize.overlay.css({display:"block",left:b.offsetLeft-5+"px",top:b.offsetTop-5+"px",width:b.offsetWidth+10+"px",height:b.offsetHeight+10+"px"});a.displayElements.resize.info.text(b.offsetWidth+" x "+b.offsetHeight)};a.showResizeOverlay=function(c){var d=n.find("body");y=function(e){var f=parseInt(c.attr("width")),g=parseInt(c.attr("height")),
h=e.clientX,l=e.clientY;(void 0===f||isNaN(f))&&(f=c[0].offsetWidth);(void 0===g||isNaN(g))&&(g=c[0].offsetHeight);a.hidePopover();var k=g/f,m=function(d){var e=Math.max(0,f+(d.clientX-h)),m=Math.max(0,g+(d.clientY-l)),n=b.taResizeMaintainAspectRatio;if(void 0!==b.taResizeForceAspectRatio||n&&!d.shiftKey)d=m/e,e=k>d?e:m/k,m=k>d?e*k:m;d=angular.element(c);d.css("height",Math.round(Math.max(0,m))+"px");d.css("width",Math.round(Math.max(0,e))+"px");a.reflowResizeOverlay(c)};d.on("mousemove",m);G(d,"mouseup",
function(b){b.preventDefault();b.stopPropagation();d.off("mousemove",m);a.$apply(function(){a.hidePopover();a.updateTaBindtaTextElement()},100)});e.stopPropagation();e.preventDefault()};a.displayElements.resize.anchors[3].off("mousedown");a.displayElements.resize.anchors[3].on("mousedown",y);a.reflowResizeOverlay(c);G(d,"click",function(){a.hideResizeOverlay()})};a.hideResizeOverlay=function(){a.displayElements.resize.anchors[3].off("mousedown",y);a.displayElements.resize.overlay.css("display","none")};
a.setup.htmlEditorSetup(a.displayElements.html);a.setup.textEditorSetup(a.displayElements.text);a.displayElements.html.attr({id:"taHtmlElement"+A,"ng-show":"showHtml","ta-bind":"ta-bind","ng-model":"html","ng-model-options":d.attr("ng-model-options")});a.displayElements.text.attr({id:"taTextElement"+A,contentEditable:"true","ta-bind":"ta-bind","ng-model":"html","ng-model-options":d.attr("ng-model-options")});a.displayElements.scrollWindow.attr({"ng-hide":"showHtml"});b.taDefaultWrap&&a.displayElements.text.attr("ta-default-wrap",
b.taDefaultWrap);b.taUnsafeSanitizer&&(a.displayElements.text.attr("ta-unsafe-sanitizer",b.taUnsafeSanitizer),a.displayElements.html.attr("ta-unsafe-sanitizer",b.taUnsafeSanitizer));a.displayElements.scrollWindow.append(a.displayElements.text);d.append(a.displayElements.scrollWindow);d.append(a.displayElements.html);a.displayElements.forminput.attr("name",a._name);d.append(a.displayElements.forminput);b.tabindex&&(d.removeAttr("tabindex"),a.displayElements.text.attr("tabindex",b.tabindex),a.displayElements.html.attr("tabindex",
b.tabindex));b.placeholder&&(a.displayElements.text.attr("placeholder",b.placeholder),a.displayElements.html.attr("placeholder",b.placeholder));b.taDisabled&&(a.displayElements.text.attr("ta-readonly","disabled"),a.displayElements.html.attr("ta-readonly","disabled"),a.disabled=a.$parent.$eval(b.taDisabled),a.$parent.$watch(b.taDisabled,function(b){a.disabled=b;a.disabled?d.addClass(a.classes.disabled):d.removeClass(a.classes.disabled)}));b.taPaste&&(a._pasteHandler=function(c){return D(b.taPaste)(a.$parent,
{$html:c})},a.displayElements.text.attr("ta-paste","_pasteHandler($html)"));e(a.displayElements.scrollWindow)(a);e(a.displayElements.html)(a);a.updateTaBindtaTextElement=a["updateTaBindtaTextElement"+A];a.updateTaBindtaHtmlElement=a["updateTaBindtaHtmlElement"+A];d.addClass("ta-root");a.displayElements.scrollWindow.addClass("ta-text ta-editor "+a.classes.textEditor);a.displayElements.html.addClass("ta-html ta-editor "+a.classes.htmlEditor);var J=function(a,b){b!==n[0].queryCommandState(a)&&n[0].execCommand(a,
!1,null)},ca=a._actionRunning=!1;if(a.startAction=function(){var b=!1,c=!1,d=!1,e=!1;return a._actionRunning=!0,b=n[0].queryCommandState("bold"),c=n[0].queryCommandState("italic"),d=n[0].queryCommandState("underline"),e=n[0].queryCommandState("strikeThrough"),ca=p.saveSelection(),J("bold",b),J("italic",c),J("underline",d),J("strikeThrough",e),function(){ca&&p.restoreSelection(ca)}},a.endAction=function(){a._actionRunning=!1;ca&&(a.showHtml?a.displayElements.html[0].focus():a.displayElements.text[0].focus(),
p.removeMarkers(ca));ca=!1;a.updateSelectedStyles();a.showHtml||a["updateTaBindtaTextElement"+A]()},l=function(b){a.focussed=!0;d.addClass(a.classes.focussed);x.focus();d.triggerHandler("focus");a.updateSelectedStyles&&!a._bUpdateSelectedStyles&&f(function(){a.updateSelectedStyles()},0)},a.displayElements.html.on("focus",l),a.displayElements.text.on("focus",l),z=function(b){return a._actionRunning||n[0].activeElement===a.displayElements.html[0]||n[0].activeElement===a.displayElements.text[0]||(d.removeClass(a.classes.focussed),
x.unfocus(),f(function(){a._bUpdateSelectedStyles=!1;d.triggerHandler("blur");a.focussed=!1},0)),b.preventDefault(),!1},a.displayElements.html.on("blur",z),a.displayElements.text.on("blur",z),a.displayElements.text.on("paste",function(a){d.triggerHandler("paste",a)}),a.queryFormatBlockState=function(b){return!a.showHtml&&b.toLowerCase()===n[0].queryCommandValue("formatBlock").toLowerCase()},a.queryCommandState=function(b){return a.showHtml?"":n[0].queryCommandState(b)},a.switchView=function(){a.showHtml=
!a.showHtml;m.enabled(!1,a.displayElements.html);m.enabled(!1,a.displayElements.text);a.showHtml?f(function(){return m.enabled(!0,a.displayElements.html),m.enabled(!0,a.displayElements.text),a.displayElements.html[0].focus()},100):f(function(){return m.enabled(!0,a.displayElements.html),m.enabled(!0,a.displayElements.text),a.displayElements.text[0].focus()},100)},b.ngModel){var M=!0;g.$render=function(){if(M){M=!1;var d=a.$parent.$eval(b.ngModel);void 0!==d&&null!==d||!c||""===c||g.$setViewValue(c)}a.displayElements.forminput.val(g.$viewValue);
a.html=g.$viewValue||""};d.attr("required")&&(g.$validators.required=function(a,b){a=a||b;return!(!a||""===a.trim())})}else a.displayElements.forminput.val(c),a.html=c;(a.$watch("html",function(c,d){c!==d&&(b.ngModel&&g.$viewValue!==c&&g.$setViewValue(c),a.displayElements.forminput.val(c))}),b.taTargetToolbars)?x=v.registerEditor(a._name,a,b.taTargetToolbars.split(",")):(l=angular.element('<div text-angular-toolbar name="textAngularToolbar'+A+'">'),b.taToolbar&&l.attr("ta-toolbar",b.taToolbar),b.taToolbarClass&&
l.attr("ta-toolbar-class",b.taToolbarClass),b.taToolbarGroupClass&&l.attr("ta-toolbar-group-class",b.taToolbarGroupClass),b.taToolbarButtonClass&&l.attr("ta-toolbar-button-class",b.taToolbarButtonClass),b.taToolbarActiveButtonClass&&l.attr("ta-toolbar-active-button-class",b.taToolbarActiveButtonClass),b.taFocussedClass&&l.attr("ta-focussed-class",b.taFocussedClass),d.prepend(l),e(l)(a.$parent),x=v.registerEditor(a._name,a,["textAngularToolbar"+A]));a.$on("$destroy",function(){v.unregisterEditor(a._name);
angular.element(window).off("blur")});a.$on("ta-element-select",function(b,c){x.triggerElementSelect(b,c)&&a["reApplyOnSelectorHandlerstaTextElement"+A]()});a.$on("ta-drop-event",function(b,c,d,e){e&&e.files&&0<e.files.length?(a.displayElements.text[0].focus(),angular.forEach(e.files,function(b){try{B.when(a.fileDropHandler(b,a.wrapSelection)||a.fileDropHandler!==a.defaultFileDropHandler&&B.when(a.defaultFileDropHandler(b,a.wrapSelection))).then(function(){a["updateTaBindtaTextElement"+A]()})}catch(ka){q.error(ka)}}),
d.preventDefault(),d.stopPropagation()):f(function(){a["updateTaBindtaTextElement"+A]()},0)});a._bUpdateSelectedStyles=!1;angular.element(window).on("blur",function(){a._bUpdateSelectedStyles=!1;a.focussed=!1});a.updateSelectedStyles=function(){var b;u&&f.cancel(u);void 0!==(b=k.getSelectionElement())&&b.parentNode!==a.displayElements.text[0]?x.updateSelectedStyles(angular.element(b)):x.updateSelectedStyles();a._bUpdateSelectedStyles&&(u=f(a.updateSelectedStyles,200))};l=function(){return a.focussed?
void(a._bUpdateSelectedStyles||(a._bUpdateSelectedStyles=!0,a.$apply(function(){a.updateSelectedStyles()}))):void(a._bUpdateSelectedStyles=!1)};a.displayElements.html.on("keydown",l);a.displayElements.text.on("keydown",l);l=function(){a._bUpdateSelectedStyles=!1};a.displayElements.html.on("keyup",l);a.displayElements.text.on("keyup",l);l=function(b,c){if(k.getSelection){var d=k.getSelection();k.getSelectionElement()&&"a"===k.getSelectionElement().nodeName.toLowerCase()&&(3===d.start.element.nodeType&&
d.start.element.textContent.length===d.end.offset&&k.setSelectionAfterElement(k.getSelectionElement()),3===d.start.element.nodeType&&0===d.start.offset&&k.setSelectionBeforeElement(k.getSelectionElement()))}c&&angular.extend(b,c);a.$apply(function(){if(x.sendKeyCommand(b))return a._bUpdateSelectedStyles||a.updateSelectedStyles(),b.preventDefault(),!1})};a.displayElements.html.on("keypress",l);a.displayElements.text.on("keypress",l);l=function(){a._bUpdateSelectedStyles=!1;f(function(){a.updateSelectedStyles()},
0)};a.displayElements.html.on("mouseup",l);a.displayElements.text.on("mouseup",l)}}}]),F.service("textAngularManager",["taToolExecuteAction","taTools","taRegisterTool","$interval","$rootScope","$log",function(e,f,h,k,p,r){var n,m={},q={},v=0,y=function(a){angular.forEach(q,function(b){b.editorFunctions.updateSelectedStyles(a)})},a=function(){v=Date.now();n=k(function(){y();n=void 0},50,1)};p.$on("destroy",function(){n&&(k.cancel(n),n=void 0)});var d=function(){50<Math.abs(Date.now()-v)&&a()};return{registerEditor:function(a,
g,h){if(!a||""===a)throw"textAngular Error: An editor requires a name";if(!g)throw"textAngular Error: An editor requires a scope";if(q[a])throw'textAngular Error: An Editor with name "'+a+'" already exists';return q[a]={scope:g,toolbars:h,toolbarScopes:[],_registerToolbarScope:function(a){0<=this.toolbars.indexOf(a.name)&&this.toolbarScopes.push(a)},editorFunctions:{disable:function(){angular.forEach(q[a].toolbarScopes,function(a){a.disabled=!0})},enable:function(){angular.forEach(q[a].toolbarScopes,
function(a){a.disabled=!1})},focus:function(){angular.forEach(q[a].toolbarScopes,function(a){a._parent=g;a.disabled=!1;a.focussed=!0});g.focussed=!0},unfocus:function(){angular.forEach(q[a].toolbarScopes,function(a){a.disabled=!0;a.focussed=!1});g.focussed=!1},updateSelectedStyles:function(b){angular.forEach(q[a].toolbarScopes,function(a){angular.forEach(a.tools,function(c){c.activeState&&(a._parent=g,c.active=c.activeState(b))})})},sendKeyCommand:function(b){var c=!1;return(b.ctrlKey||b.metaKey||
b.specialKey)&&angular.forEach(f,function(d,f){if(d.commandKeyCode&&(d.commandKeyCode===b.which||d.commandKeyCode===b.specialKey))for(d=0;d<q[a].toolbarScopes.length;d++)if(void 0!==q[a].toolbarScopes[d].tools[f]){e.call(q[a].toolbarScopes[d].tools[f],g);c=!0;break}}),c},triggerElementSelect:function(b,c){var d=function(a,b){for(var c=!0,d=0;d<b.length;d++)c=c&&a.attr(b[d]);return c},e=[],h={},l=!1;c=angular.element(c);var k=!1;if(angular.forEach(f,function(a,b){a.onElementSelect&&a.onElementSelect.element&&
a.onElementSelect.element.toLowerCase()===c[0].tagName.toLowerCase()&&(!a.onElementSelect.filter||a.onElementSelect.filter(c))&&(k=k||angular.isArray(a.onElementSelect.onlyWithAttrs)&&d(c,a.onElementSelect.onlyWithAttrs),a.onElementSelect.onlyWithAttrs&&!d(c,a.onElementSelect.onlyWithAttrs)||(h[b]=a))}),k?(angular.forEach(h,function(a,b){a.onElementSelect.onlyWithAttrs&&d(c,a.onElementSelect.onlyWithAttrs)&&e.push({name:b,tool:a})}),e.sort(function(a,b){return b.tool.onElementSelect.onlyWithAttrs.length-
a.tool.onElementSelect.onlyWithAttrs.length})):angular.forEach(h,function(a,b){e.push({name:b,tool:a})}),0<e.length)for(var m=0;m<e.length;m++){for(var n=e[m].tool,p=e[m].name,r=0;r<q[a].toolbarScopes.length;r++)if(void 0!==q[a].toolbarScopes[r].tools[p]){n.onElementSelect.action.call(q[a].toolbarScopes[r].tools[p],b,c,g);l=!0;break}if(l)break}return l}}},angular.forEach(h,function(b){m[b]&&q[a].toolbarScopes.push(m[b])}),d(),q[a].editorFunctions},retrieveEditor:function(a){return q[a]},unregisterEditor:function(a){delete q[a];
d()},registerToolbar:function(a){if(!a)throw"textAngular Error: A toolbar requires a scope";if(!a.name||""===a.name)throw"textAngular Error: A toolbar requires a name";if(m[a.name])throw'textAngular Error: A toolbar with name "'+a.name+'" already exists';m[a.name]=a;angular.forEach(q,function(b){b._registerToolbarScope(a)});d()},retrieveToolbar:function(a){return m[a]},retrieveToolbarsViaEditor:function(a){var b=[],d=this;return angular.forEach(this.retrieveEditor(a).toolbars,function(a){b.push(d.retrieveToolbar(a))}),
b},unregisterToolbar:function(a){delete m[a];d()},updateToolsDisplay:function(a){var b=this;angular.forEach(a,function(a,d){b.updateToolDisplay(d,a)})},resetToolsDisplay:function(){var a=this;angular.forEach(f,function(b,d){a.resetToolDisplay(d)});d()},updateToolDisplay:function(a,e){var b=this;angular.forEach(m,function(d,c){b.updateToolbarToolDisplay(c,a,e)});d()},resetToolDisplay:function(a){var b=this;angular.forEach(m,function(d,e){b.resetToolbarToolDisplay(e,a)});d()},updateToolbarToolDisplay:function(a,
d,e){if(!m[a])throw'textAngular Error: No Toolbar with name "'+a+'" exists';m[a].updateToolDisplay(d,e)},resetToolbarToolDisplay:function(a,d){if(!m[a])throw'textAngular Error: No Toolbar with name "'+a+'" exists';m[a].updateToolDisplay(d,f[d],!0)},removeTool:function(a){delete f[a];angular.forEach(m,function(b){delete b.tools[a];for(var d=0;d<b.toolbar.length;d++){for(var e,c=0;c<b.toolbar[d].length;c++){if(b.toolbar[d][c]===a){e={group:d,index:c};break}if(void 0!==e)break}void 0!==e&&(b.toolbar[e.group].slice(e.index,
1),b._$element.children().eq(e.group).children().eq(e.index).remove())}});d()},addTool:function(a,e,f,k){h(a,e);angular.forEach(m,function(b){b.addTool(a,e,f,k)});d()},addToolToToolbar:function(a,e,f,k,c){h(a,e);m[f].addTool(a,e,k,c);d()},refreshEditor:function(a){if(!q[a])throw'textAngular Error: No Editor with name "'+a+'" exists';q[a].scope.updateTaBindtaTextElement();q[a].scope.$$phase||q[a].scope.$digest();d()},sendKeyCommand:function(a,d){var b=q[a._name];if(b&&b.editorFunctions.sendKeyCommand(d))return a._bUpdateSelectedStyles||
a.updateSelectedStyles(),d.preventDefault(),!1},updateStyles:y,getVersion:function(){return"v1.5.12"},getToolbarScopes:function(){var a=[];return angular.forEach(q,function(b){a=a.concat(b.toolbarScopes)}),a}}}]),F.directive("textAngularToolbar",["$compile","textAngularManager","taOptions","taTools","taToolExecuteAction","$window",function(e,f,h,k,p,r){return{scope:{name:"@"},restrict:"EA",link:function(n,m,q){if(!n.name||""===n.name)throw"textAngular Error: A toolbar requires a name";angular.extend(n,
angular.copy(h));q.taToolbar&&(n.toolbar=n.$parent.$eval(q.taToolbar));q.taToolbarClass&&(n.classes.toolbar=q.taToolbarClass);q.taToolbarGroupClass&&(n.classes.toolbarGroup=q.taToolbarGroupClass);q.taToolbarButtonClass&&(n.classes.toolbarButton=q.taToolbarButtonClass);q.taToolbarActiveButtonClass&&(n.classes.toolbarButtonActive=q.taToolbarActiveButtonClass);q.taFocussedClass&&(n.classes.focussed=q.taFocussedClass);n.disabled=!0;n.focussed=!1;n._$element=m;m[0].innerHTML="";m.addClass("ta-toolbar "+
n.classes.toolbar);n.$watch("focussed",function(){n.focussed?m.addClass(n.classes.focussed):m.removeClass(n.classes.focussed)});var v=function(a,d){var b;if(b=a&&a.display?angular.element(a.display):angular.element("<button type='button'>"),a&&a.class?b.addClass(a.class):b.addClass(n.classes.toolbarButton),b.attr("name",d.name),b.attr("ta-button","ta-button"),b.attr("ng-disabled","isDisabled()"),b.attr("tabindex","-1"),b.attr("ng-click","executeAction()"),b.attr("ng-class","displayActiveToolClass(active)"),
a&&a.tooltiptext&&b.attr("title",a.tooltiptext),a&&!a.display&&!d._display&&(b[0].innerHTML="",a.buttontext&&(b[0].innerHTML=a.buttontext),a.iconclass)){var f=angular.element("<i>"),h=b[0].innerHTML;f.addClass(a.iconclass);b[0].innerHTML="";b.append(f);h&&""!==h&&b.append("&nbsp;"+h)}return d._lastToolDefinition=angular.copy(a),e(b)(d)};n.tools={};n._parent={disabled:!0,showHtml:!1,queryFormatBlockState:function(){return!1},queryCommandState:function(){return!1}};var y={$window:r,$editor:function(){return n._parent},
isDisabled:function(){return("html"!==this.name||!n._parent.startAction)&&("function"!=typeof this.$eval("disabled")&&this.$eval("disabled")||this.$eval("disabled()")||"html"!==this.name&&this.$editor().showHtml||this.$parent.disabled||this.$editor().disabled)},displayActiveToolClass:function(a){return a?n.classes.toolbarButtonActive:""},executeAction:p};angular.forEach(n.toolbar,function(a){var d=angular.element("<div>");d.addClass(n.classes.toolbarGroup);angular.forEach(a,function(a){n.tools[a]=
angular.extend(n.$new(!0),k[a],y,{name:a});n.tools[a].$element=v(k[a],n.tools[a]);d.append(n.tools[a].$element)});m.append(d)});n.updateToolDisplay=function(a,d,b){var e=n.tools[a];if(e){if(e._lastToolDefinition&&!b&&(d=angular.extend({},e._lastToolDefinition,d)),null===d.buttontext&&null===d.iconclass&&null===d.display)throw'textAngular Error: Tool Definition for updating "'+a+'" does not have a valid display/iconclass/buttontext value';null===d.buttontext&&delete d.buttontext;null===d.iconclass&&
delete d.iconclass;null===d.display&&delete d.display;a=v(d,e);e.$element.replaceWith(a);e.$element=a}};n.addTool=function(a,d,b,e){n.tools[a]=angular.extend(n.$new(!0),k[a],y,{name:a});n.tools[a].$element=v(k[a],n.tools[a]);void 0===b&&(b=n.toolbar.length-1);d=angular.element(m.children()[b]);void 0===e?(d.append(n.tools[a].$element),n.toolbar[b][n.toolbar[b].length-1]=a):(d.children().eq(e).after(n.tools[a].$element),n.toolbar[b][e]=a)};f.registerToolbar(n);n.$on("$destroy",function(){f.unregisterToolbar(n.name)})}}}]),
F.directive("textAngularVersion",["textAngularManager",function(e){var f=e.getVersion();return{restrict:"EA",link:function(e,k,p){k.html(f)}}}]),F.name});